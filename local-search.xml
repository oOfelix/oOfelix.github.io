<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>Javaæ—¥å¿—ç³»ç»Ÿ</title>
    <link href="/2022/03/13/java-log/"/>
    <url>/2022/03/13/java-log/</url>
    
    <content type="html"><![CDATA[<h1 id="slf4jä¸jclã€jucã€log4j1ã€log4j2ã€logbackçš„é›†æˆ"><a href="#slf4jä¸jclã€jucã€log4j1ã€log4j2ã€logbackçš„é›†æˆ" class="headerlink" title="slf4jä¸jclã€jucã€log4j1ã€log4j2ã€logbackçš„é›†æˆ"></a>slf4jä¸jclã€jucã€log4j1ã€log4j2ã€logbackçš„é›†æˆ</h1><figure class="highlight markdown"><table><tr><td class="gutter"><div class="code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></div></td><td class="code"><pre><code class="hljs markdown">&#123;% note success %&#125;<br>å¦‚æœéœ€è¦ï¼Œå¯å…ˆäº†è§£javaæ—¥å¿—çš„å‘å±•å†å²ï¼Œè¿™å¯èƒ½æœ‰åŠ©äºä½ å¯¹æ—¥å¿—æ¡†æ¶çš„ç†è§£<br>å¯å…ˆäº†è§£è®¾è®¡æ¨¡å¼çš„ç›¸å…³çŸ¥è¯†ï¼Œjavaæ—¥å¿—ç³»ç»Ÿæ¶‰åŠåˆ°äº†è®¾è®¡æ¨¡å¼çš„çŸ¥è¯†ï¼Œå¦‚é—¨é¢æ¨¡å¼ï¼Œæ¡¥æ¥æ¨¡å¼<br>ä¸è¿‡ï¼Œä¸äº†è§£ä¹Ÿæ— å¦¨ï¼ Letâ€™s goï¼ğŸ‰ğŸ‰ğŸ‰<br>&#123;% endnote %&#125;<br></code></pre></td></tr></table></figure><h1 id="ä¸€ã€ä½¿ç”¨SLF4Jåšæ—¥å¿—é—¨é¢"><a href="#ä¸€ã€ä½¿ç”¨SLF4Jåšæ—¥å¿—é—¨é¢" class="headerlink" title="ä¸€ã€ä½¿ç”¨SLF4Jåšæ—¥å¿—é—¨é¢"></a>ä¸€ã€ä½¿ç”¨SLF4Jåšæ—¥å¿—é—¨é¢</h1><h2 id="1ã€slf4jä¸julçš„é›†æˆ"><a href="#1ã€slf4jä¸julçš„é›†æˆ" class="headerlink" title="1ã€slf4jä¸julçš„é›†æˆ"></a>1ã€slf4jä¸julçš„é›†æˆ</h2><p>jaråŒ…ä¾èµ–å…³ç³»å›¾ï¼š</p><p><img src="/java-log.assets/image-20220313111051835.png" alt="image-20220313111051835"></p><!-- java.util.logging --><p><strong>ä¾èµ–ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs maven">&lt;!--éœ€è¦çš„jaråŒ…ï¼šslf4j-api.jarã€slf4j-jdk14.jar--&gt;<br>&lt;dependency&gt;<br>    &lt;groupId&gt;org.slf4j&lt;/groupId&gt;<br>    &lt;artifactId&gt;slf4j-jdk14&lt;/artifactId&gt;<br>    &lt;version&gt;1.7.24&lt;/version&gt;<br>&lt;/dependency&gt;<br></code></pre></td></tr></table></figure><p>[^tipsï¼šå¯ä»¥ä¸å¼•å…¥slf4j-api.jarï¼Œå› ä¸ºå¼•å…¥slf4j-jdk14æ—¶ï¼Œä¼šè‡ªåŠ¨å¯¼å…¥ã€‚ä¸‹åŒç†]: </p><p><strong>æµ‹è¯•ï¼š</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.jeiker.demo.slf4j;<br><br><span class="hljs-keyword">import</span> org.slf4j.Logger;<br><span class="hljs-keyword">import</span> org.slf4j.LoggerFactory;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Slf4jJdkTest</span> &#123;<br><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Logger</span> <span class="hljs-variable">logger</span> <span class="hljs-operator">=</span> LoggerFactory.getLogger(Slf4jJdkTest.class);<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span>&#123;<br>       <span class="hljs-keyword">if</span>(logger.isDebugEnabled())&#123;<br>           logger.debug(<span class="hljs-string">&quot;slf4j-jdk debug message&quot;</span>);<br>       &#125;<br>       <span class="hljs-keyword">if</span>(logger.isInfoEnabled())&#123;<br>           logger.debug(<span class="hljs-string">&quot;slf4j-jdk info message&quot;</span>);<br>       &#125;<br>       <span class="hljs-keyword">if</span>(logger.isTraceEnabled())&#123;<br>           logger.debug(<span class="hljs-string">&quot;slf4j-jdk trace message&quot;</span>);<br>       &#125;<br>   &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="2ã€slf4jä¸log4j1çš„é›†æˆ"><a href="#2ã€slf4jä¸log4j1çš„é›†æˆ" class="headerlink" title="2ã€slf4jä¸log4j1çš„é›†æˆ"></a>2ã€slf4jä¸log4j1çš„é›†æˆ</h2><p>jaråŒ…ä¾èµ–å…³ç³»å›¾ï¼š</p><p><img src="/java-log.assets/image-20220313111029132.png" alt="image-20220313111029132"></p><!-- log4j1 --><p><strong>ä¾èµ–ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs maven">&lt;!--éœ€è¦çš„jaråŒ…ï¼šslf4j-api.jarã€slf4j-jdk14.jar--&gt;<br>&lt;dependency&gt;<br>    &lt;groupId&gt;org.slf4j&lt;/groupId&gt;<br>    &lt;artifactId&gt;slf4j-log4j12&lt;/artifactId&gt;<br>    &lt;version&gt;1.7.24&lt;/version&gt;<br>&lt;/dependency&gt;<br></code></pre></td></tr></table></figure><p><strong>æµ‹è¯•ï¼š</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> org.slf4j.Logger;<br><span class="hljs-keyword">import</span> org.slf4j.LoggerFactory;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Slf4jLog4j1Test</span> &#123;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Logger</span> <span class="hljs-variable">logger</span> <span class="hljs-operator">=</span> LoggerFactory.getLogger(Slf4jLog4j1Test.class);<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span>&#123;<br>        <span class="hljs-keyword">if</span>(logger.isDebugEnabled())&#123;<br>            logger.debug(<span class="hljs-string">&quot;slf4j-log4j1 debug message&quot;</span>);<br>        &#125;<br>        <span class="hljs-keyword">if</span>(logger.isInfoEnabled())&#123;<br>            logger.debug(<span class="hljs-string">&quot;slf4j-log4j1 info message&quot;</span>);<br>        &#125;<br>        <span class="hljs-keyword">if</span>(logger.isTraceEnabled())&#123;<br>            logger.debug(<span class="hljs-string">&quot;slf4j-log4j1 trace message&quot;</span>);<br>        &#125;<br>    &#125;<br></code></pre></td></tr></table></figure><h2 id="3ã€slf4jä¸log4j2çš„é›†æˆ"><a href="#3ã€slf4jä¸log4j2çš„é›†æˆ" class="headerlink" title="3ã€slf4jä¸log4j2çš„é›†æˆ"></a>3ã€slf4jä¸log4j2çš„é›†æˆ</h2><p>jaråŒ…ä¾èµ–å…³ç³»å›¾</p><p><img src="/java-log.assets/image-20220313111447132.png" alt="image-20220313111447132"></p><p><strong>ä¾èµ–ï¼š</strong></p><!-- log4j2 --><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.apache.logging.log4j<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>log4j-core<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.8.1<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.apache.logging.log4j<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>log4j-slf4j-impl<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.8.1<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure><p><strong>æµ‹è¯•</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> org.slf4j.Logger;<br><span class="hljs-keyword">import</span> org.slf4j.LoggerFactory;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Slf4jLog4j2Test</span> &#123;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Logger</span> <span class="hljs-variable">logger</span> <span class="hljs-operator">=</span> LoggerFactory.getLogger(Slf4jLog4j2Test.class);<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span>&#123;<br>        <span class="hljs-keyword">if</span>(logger.isDebugEnabled())&#123;<br>            logger.debug(<span class="hljs-string">&quot;slf4j-log4j2 debug message&quot;</span>);<br>        &#125;<br>        <span class="hljs-keyword">if</span>(logger.isInfoEnabled())&#123;<br>            logger.debug(<span class="hljs-string">&quot;slf4j-log4j2 info message&quot;</span>);<br>        &#125;<br>        <span class="hljs-keyword">if</span>(logger.isTraceEnabled())&#123;<br>            logger.debug(<span class="hljs-string">&quot;slf4j-log4j2 trace message&quot;</span>);<br>        &#125;<br>    &#125;<br></code></pre></td></tr></table></figure><h2 id="4ã€slf4jä¸logbackçš„é›†æˆ"><a href="#4ã€slf4jä¸logbackçš„é›†æˆ" class="headerlink" title="4ã€slf4jä¸logbackçš„é›†æˆ"></a>4ã€slf4jä¸logbackçš„é›†æˆ</h2><p>jaråŒ…ä¾èµ–å…³ç³»å›¾</p><p><img src="/java-log.assets/image-20220313111808087.png" alt="image-20220313111808087"></p><p><strong>ä¾èµ–ï¼š</strong></p><!-- logback --><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>ch.qos.logback<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>logback-classic<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.2.1<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure><p><strong>æµ‹è¯•ï¼š</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> org.slf4j.Logger;<br><span class="hljs-keyword">import</span> org.slf4j.LoggerFactory;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Slf4jLogbackTest</span> &#123;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">Logger</span> <span class="hljs-variable">logger</span> <span class="hljs-operator">=</span> LoggerFactory.getLogger(Slf4jLogbackTest.class);<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span>&#123;<br>        <span class="hljs-keyword">if</span>(logger.isDebugEnabled())&#123;<br>            logger.debug(<span class="hljs-string">&quot;slf4j-logback debug message&quot;</span>);<br>        &#125;<br>        <span class="hljs-keyword">if</span>(logger.isInfoEnabled())&#123;<br>            logger.debug(<span class="hljs-string">&quot;slf4j-logback info message&quot;</span>);<br>        &#125;<br>        <span class="hljs-keyword">if</span>(logger.isTraceEnabled())&#123;<br>            logger.debug(<span class="hljs-string">&quot;slf4j-logback trace message&quot;</span>);<br>        &#125;<br>    &#125;<br></code></pre></td></tr></table></figure><h1 id="äºŒã€ä½¿ç”¨JCLåšæ—¥å¿—é—¨é¢"><a href="#äºŒã€ä½¿ç”¨JCLåšæ—¥å¿—é—¨é¢" class="headerlink" title="äºŒã€ä½¿ç”¨JCLåšæ—¥å¿—é—¨é¢"></a>äºŒã€ä½¿ç”¨JCLåšæ—¥å¿—é—¨é¢</h1><p>å…¨ç§°ä¸ºJakarta Commons Logging,æ˜¯Apacheæä¾›çš„ä¸€ä¸ªé€šç”¨æ—¥å¿—APIã€‚å®ƒæ˜¯ä¸ºâ€æ‰€æœ‰çš„Javaæ—¥å¿—å®ç°â€ï¼Œæä¾›ä¸€ä¸ªç»Ÿä¸€çš„æ¥å£ï¼Œå®ƒè‡ªèº«ä¹Ÿæä¾›ä¸€ä¸ªæ—¥å¿—çš„å®ç°ï¼Œä½†æ˜¯åŠŸèƒ½éå¸¸å¼±ï¼ˆSimpleLogï¼‰ï¼Œæ•…è€Œä¸€èˆ¬ä¸å•ç‹¬ä½¿ç”¨å®ƒï¼ˆä½œä¸ºç»Ÿä¸€æ¥å£è°ƒç”¨ï¼Œæ¢æ—¥å¿—æ¡†æ¶ï¼Œæ¯”å¦‚æ¢æˆlog4jï¼Œåˆ‡æ¢ä¾èµ–å³å¯ï¼‰ã€‚</p><p><strong>é€šè¿‡LogFactoryåŠ¨æ€åŠ è½½Logå®ç°ç±»é¡ºåº</strong></p><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mipsasm">Log4JLogger &gt; <span class="hljs-keyword">JDK14Logger </span>&gt; <span class="hljs-keyword">Jdk13LumberjackLogger </span>&gt;  SimpleLog<br></code></pre></td></tr></table></figure><p>å¦‚æœåŒæ—¶å¼•å…¥äº†å¤šä¸ªå®ç°ç±»ï¼Œå¯ä»¥åœ¨ç±»è·¯å¾„ä¸‹ç¼–å†™commoms-logging.propertiesæ¥æŒ‡å®šå®ç°ç±»ï¼Œè‹¥ä¸æŒ‡å®šï¼Œåˆ™æŒ‰ç…§ä¸Šè¿°åŠ è½½é¡ºåºåŠ è½½å®ç°ç±»</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs properties"><span class="hljs-comment">#å®ç°ä¸ºæŒ‡å®šLog4JLoggeræ—¥å¿—</span><br><span class="hljs-attr">org.apache.commons.logging.Log</span>=<span class="hljs-string">org.apache.commons.logging.impl.JDK14Logger</span><br></code></pre></td></tr></table></figure><h2 id="1ã€jclä¸julé›†æˆ"><a href="#1ã€jclä¸julé›†æˆ" class="headerlink" title="1ã€jclä¸julé›†æˆ"></a>1ã€jclä¸julé›†æˆ</h2><p>å› ä¸ºJDKè‡ªå¸¦JDK14Loggerï¼Œæ‰€ä»¥åªå¼•å…¥JCLä¹Ÿå¯ä»¥ä½¿ç”¨æ—¥å¿—ï¼Œé»˜è®¤ä½¿ç”¨java.util.logging</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>commons-logging<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>commons-logging<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.1<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure><p>julçš„é…ç½®æ–‡ä»¶åœ¨JDK_HOME&#x2F;jre&#x2F;lib&#x2F;logging.propertiesï¼ŒJDKè‡ªå¸¦çš„æ‰€ä»¥ä¸éœ€è¦é…ç½®</p><h2 id="2ã€jclä¸log4jé›†æˆ"><a href="#2ã€jclä¸log4jé›†æˆ" class="headerlink" title="2ã€jclä¸log4jé›†æˆ"></a>2ã€jclä¸log4jé›†æˆ</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>commons-logging<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>commons-logging<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.2<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>log4j<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>log4j<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.2.17<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure><p>å¯¹äºå…·ä½“çš„log4jé…ç½®åœ¨ç±»ç›®å½•ä¸‹ç¼–å†™ log4j.properties å³å¯ï¼š</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs properties"><span class="hljs-attr">log4j.rootLogger</span>=<span class="hljs-string">INFO, stdout</span><br><br><span class="hljs-attr">log4j.appender.stdout</span>=<span class="hljs-string">org.apache.log4j.ConsoleAppender</span><br><br><span class="hljs-attr">log4j.appender.stdout.Target</span>=<span class="hljs-string">System.out</span><br><br><span class="hljs-attr">log4j.appender.stdout.layout</span>=<span class="hljs-string">org.apache.log4j.PatternLayout</span><br><br><span class="hljs-attr">log4j.appender.stdout.layout.ConversionPattern</span>=<span class="hljs-string">%d&#123;yyyy-MM-dd HH:mm:ss&#125; %-5p %c&#123;1&#125;:%L - %m%n</span><br><br></code></pre></td></tr></table></figure><h2 id="3ã€jclä¸log4j2é›†æˆ"><a href="#3ã€jclä¸log4j2é›†æˆ" class="headerlink" title="3ã€jclä¸log4j2é›†æˆ"></a>3ã€jclä¸log4j2é›†æˆ</h2><p>log4j2æ˜¯å¯¹log4jçš„é‡å†™ï¼Œæ€§èƒ½æ›´å¥½ã€‚</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.apache.logging.log4j<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>log4j-api<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.9.1<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.apache.logging.log4j<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>log4j-core<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.9.1<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure><p>å¯¹äºå…·ä½“çš„log4j2é…ç½®åœ¨ç±»ç›®å½•ä¸‹ç¼–å†™ log4j2.xmlå³å¯ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="hljs-comment">&lt;!--statusè¡¨ç¤ºlog4j2è‡ªèº«çš„æ—¥å¿—æ‰“å°çº§åˆ«ï¼Œå¦‚traceä¼šæ‰“å°å‡ºlog4j2åŠ è½½ã€è¿è¡Œç­‰ä¿¡æ¯, monitorintervalç›‘æ§é—´éš”ï¼Œå•ä½ä¸ºç§’--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">Configuration</span> <span class="hljs-attr">status</span>=<span class="hljs-string">&quot;trace&quot;</span> <span class="hljs-attr">monitorinterval</span>=<span class="hljs-string">&quot;6&quot;</span>&gt;</span><br><br>    <span class="hljs-comment">&lt;!--å®šä¹‰å˜é‡--&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">Properties</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">Property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;nowDate&quot;</span>&gt;</span>%date&#123;yyyy-MM-dd&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">Property</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">Property</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;logDir&quot;</span>&gt;</span>$&#123;sys:catalina.home&#125;/logs/<span class="hljs-tag">&lt;/<span class="hljs-name">Property</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">Properties</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">appenders</span>&gt;</span><br>        <span class="hljs-comment">&lt;!--æ—¥å¿—è¾“å‡ºåˆ°æ§åˆ¶å°--&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">Console</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;consoleAppender&quot;</span> <span class="hljs-attr">target</span>=<span class="hljs-string">&quot;SYSTEM_OUT&quot;</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">PatternLayout</span> <span class="hljs-attr">pattern</span>=<span class="hljs-string">&quot;%date %logger %processId %threadId %method %class %file %highlight&#123;%level&#125; : %green&#123;%msg&#125; %n&quot;</span> /&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">Console</span>&gt;</span><br><br>        <span class="hljs-comment">&lt;!--æ—¥å¿—å†™å…¥æ–‡ä»¶ä¸­--&gt;</span><br>        <span class="hljs-comment">&lt;!--&lt;File name=&quot;fileAppender&quot; fileName=&quot;log4j2Study_$&#123;date:yyyy-MM-dd&#125;.log&quot;&gt;--&gt;</span><br>            <span class="hljs-comment">&lt;!--&lt;PatternLayout pattern=&quot;%date %logger %level : %msg%n&quot; /&gt;--&gt;</span><br>        <span class="hljs-comment">&lt;!--&lt;/File&gt;--&gt;</span><br><br>        <span class="hljs-comment">&lt;!--æ—¥å¿—å†™å…¥æ–‡ä»¶ï¼Œæ ¹æ®è‡ªå®šä¹‰çš„æ»šåŠ¨ç­–ç•¥å½’æ¡£æ–‡ä»¶ï¼ŒfilePatternå®šä¹‰æ—¥å¿—æ–‡ä»¶å½’æ¡£æ ¼å¼--&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">RollingFile</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;rollingFileAppender&quot;</span> <span class="hljs-attr">fileName</span>=<span class="hljs-string">&quot;log4j2_rollingFileAppender.log&quot;</span></span><br><span class="hljs-tag">                <span class="hljs-attr">filePattern</span>=<span class="hljs-string">&quot;$$&#123;date:yyyy-MM&#125;/%d&#123;MM-dd-yyyy&#125;-%i.log.gz&quot;</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">PatternLayout</span> <span class="hljs-attr">pattern</span>=<span class="hljs-string">&quot;%date %logger %level : %msg%n&quot;</span> /&gt;</span><br>            <span class="hljs-comment">&lt;!--å®šä¹‰æ»šåŠ¨ç­–ç•¥--&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">Policies</span>&gt;</span><br>                <span class="hljs-comment">&lt;!--åŸºäºcronè¡¨è¾¾å¼è§¦å‘å½’æ¡£--&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">CronTriggeringPolicy</span> <span class="hljs-attr">schedule</span>=<span class="hljs-string">&quot;0 0 * * * ?&quot;</span>/&gt;</span><br>                <span class="hljs-comment">&lt;!--åŸºäºæ—¶é—´è§¦å‘å½’æ¡£,ä¸ä¸Šæ–‡filePatterné…åˆä½¿ç”¨ï¼Œå½“filePatternä¸ç¬¦åˆæ—¶ï¼Œå°±å½’æ¡£--&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">TimeBasedTriggeringPolicy</span> /&gt;</span><br>                <span class="hljs-comment">&lt;!--åŸºäºæ–‡ä»¶å¤§å°è§¦å‘å½’æ¡£--&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">SizeBasedTriggeringPolicy</span> <span class="hljs-attr">size</span>=<span class="hljs-string">&quot;100 MB&quot;</span> /&gt;</span><br>            <span class="hljs-tag">&lt;/<span class="hljs-name">Policies</span>&gt;</span><br><br>            <span class="hljs-comment">&lt;!--é»˜è®¤æ—¥å¿—ä¿ç•™7å¤©--&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">DefaultRolloverStrategy</span> <span class="hljs-attr">max</span>=<span class="hljs-string">&quot;7&quot;</span> /&gt;</span><br><br>            <span class="hljs-comment">&lt;!--log4j 2.5å¼•å…¥ï¼Œå¯æ›´ç²¾ç»†åœ°æ§åˆ¶åˆ é™¤æ—¥å¿—ç­–ç•¥--&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">DefaultRolloverStrategy</span>&gt;</span><br>                <span class="hljs-comment">&lt;!--åŒæ—¶æ»¡è¶³ä¸‹è¿°æ¡ä»¶ï¼Œè¿›è¡Œåˆ é™¤--&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">Delete</span>&gt;</span><br>                    <span class="hljs-comment">&lt;!--æ–‡ä»¶åç¬¦åˆ.log.gzåç¼€--&gt;</span><br>                    <span class="hljs-tag">&lt;<span class="hljs-name">IfFileName</span> <span class="hljs-attr">glob</span>=<span class="hljs-string">&quot;*.log.gz&quot;</span> /&gt;</span><br>                    <span class="hljs-comment">&lt;!--è¶…è¿‡60å¤©--&gt;</span><br>                    <span class="hljs-tag">&lt;<span class="hljs-name">IfLastModified</span> <span class="hljs-attr">age</span>=<span class="hljs-string">&quot;60d&quot;</span> /&gt;</span><br>                <span class="hljs-tag">&lt;/<span class="hljs-name">Delete</span>&gt;</span><br>            <span class="hljs-tag">&lt;/<span class="hljs-name">DefaultRolloverStrategy</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">RollingFile</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">appenders</span>&gt;</span><br><br>    <span class="hljs-comment">&lt;!--å®šä¹‰æ—¥å¿—è¾“å‡ºé…ç½®--&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">Loggers</span>&gt;</span><br>        <span class="hljs-comment">&lt;!--æ§åˆ¶æŒ‡å®šåŒ…æˆ–ç±»çš„æ—¥å¿—è¾“å‡ºï¼ˆåŒ…æ‹¬ç­‰çº§å’Œç›®çš„åœ°ï¼‰, additivityè¡¨ç¤ºæ—¥å¿—ä¿¡æ¯æ˜¯å¦å‘ä¸Šä¼ é€’ï¼Œfalseä¸ºä¸ä¼ é€’ï¼ˆå³ä¸é‡å¤æ‰“å°ï¼‰--&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">Logger</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;com.dragon.study.log.test&quot;</span>  <span class="hljs-attr">level</span>=<span class="hljs-string">&quot;false&quot;</span> <span class="hljs-attr">additivity</span>=<span class="hljs-string">&quot;false&quot;</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">AppenderRef</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">&quot;consoleAppender&quot;</span> /&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">Logger</span>&gt;</span><br><br>        <span class="hljs-comment">&lt;!--å…¨å±€æ—¥å¿—çº§åˆ«ä¸ºinfo--&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">Root</span> <span class="hljs-attr">level</span>=<span class="hljs-string">&quot;info&quot;</span>&gt;</span><br>            <span class="hljs-comment">&lt;!--æ—¥å¿—è¾“å‡ºåˆ°æ§åˆ¶å°å’Œæ–‡ä»¶ä¸­--&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">AppenderRef</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">&quot;consoleAppender&quot;</span> /&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">AppenderRef</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">&quot;fileAppender&quot;</span> /&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">Root</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">Loggers</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">Configuration</span>&gt;</span><br></code></pre></td></tr></table></figure><h2 id="4ã€spring-jclä¸log4j2é›†æˆ"><a href="#4ã€spring-jclä¸log4j2é›†æˆ" class="headerlink" title="4ã€spring-jclä¸log4j2é›†æˆ"></a>4ã€spring-jclä¸log4j2é›†æˆ</h2><p>ç”±äºapacheä¸å†ç»´æŠ¤jclï¼Œå› æ­¤springå°†jclé‡å†™å¹¶å¼•å…¥æ¡†æ¶ä¸­ï¼Œä¸ºspring-jclã€‚</p><p>å€¼å¾—æ³¨æ„çš„æ˜¯spring-jclä¸æ”¯æŒlog4j1ã€‚</p><p>spring-jclçš„åŠ è½½é¡ºåºä¸º**<code>Log4j 2.x</code>**ï¼Œ <strong><code>Try SLF4J 1.7 SPI</code><strong>ï¼Œ</strong><code>SLF4J 1.7 API</code><strong>ï¼Œ</strong>jul</strong></p><p><img src="/java-log.assets/image-20220313124441148.png" alt="image-20220313124441148"></p><p><strong>ä¾èµ–ï¼š</strong></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.apache.logging.log4j<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>log4j-api<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.17.1<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.apache.logging.log4j<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>log4j-core<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.17.1<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure><p>å¦‚æœä½ æƒ³åœ¨springä¸­ä½¿ç”¨log4jï¼Œé‚£ä¹ˆéœ€è¦å°†spring-jclæ’é™¤ï¼Œç„¶åä½¿ç”¨apacheçš„jcl</p><p><img src="/java-log.assets/image-20220313125217953.png" alt="image-20220313125217953"></p><p>å¦‚æœä½ æƒ³ä½¿ç”¨slf4jï¼Œé‚£ä¹ˆæ ¹æ®ç¬¬ä¸€éƒ¨åˆ†æ‰€è¯´çš„æ–¹æ³•å¼•å…¥ä¾èµ–å°±å¯ä»¥äº†ï¼Œspring-jclå·²ç»åšå¥½äº†åˆ°slf4jçš„æ¡¥æ¥</p><h1 id="ä¸‰ã€ä½¿ç”¨slf4jç»Ÿä¸€å„ç§æ—¥å¿—"><a href="#ä¸‰ã€ä½¿ç”¨slf4jç»Ÿä¸€å„ç§æ—¥å¿—" class="headerlink" title="ä¸‰ã€ä½¿ç”¨slf4jç»Ÿä¸€å„ç§æ—¥å¿—"></a>ä¸‰ã€ä½¿ç”¨slf4jç»Ÿä¸€å„ç§æ—¥å¿—</h1><p>å½“é¡¹ç›®æ˜¯ä½¿ç”¨å¤šç§æ—¥å¿—APIæ—¶ï¼Œå¯ä»¥ç»Ÿä¸€é€‚é…åˆ°slf4jï¼Œç„¶åé€šè¿‡slf4jé€‚é…åº•å±‚å®ç°ã€‚</p><p>ä¸­é—´ä½¿ç”¨slf4jè¿›è¡Œç»Ÿä¸€é¡¹ç›®ä¸­ä½¿ç”¨çš„å¤šç§æ—¥å¿—æ¡†æ¶çš„APIï¼Œç„¶åè½¬å‘åˆ°slf4j,slf4jå†åº•å±‚ç”¨å¼€å‘è€…æƒ³ç”¨çš„ä¸€ä¸ªæ—¥å¿—æ¡†æ¶æ¥è¿›è¡Œæ—¥å¿—ç³»ç»Ÿçš„å®ç°ã€‚ä»è€Œè¾¾åˆ°äº†å¤šç§æ—¥å¿—çš„ç»Ÿä¸€å®ç°ã€‚</p><p>slf4jåœ¨è¿™ä¸­é—´å……å½“äº†ä¸­é—´äººï¼Œå……å½“ç¿»è¯‘çš„æ„Ÿè§‰ã€‚</p><p>slf4jå®˜ç½‘æ¡¥æ¥è¯´æ˜ï¼š<a href="https://www.slf4j.org/legacy.html">https://www.slf4j.org/legacy.html</a></p><h2 id="ä¸¾ä¾‹"><a href="#ä¸¾ä¾‹" class="headerlink" title="ä¸¾ä¾‹"></a>ä¸¾ä¾‹</h2><p><img src="/java-log.assets/image-20220313115305496.png" alt="image-20220313115305496"></p><p>ä¾‹å­ï¼šç›®å‰çš„åº”ç”¨ç¨‹åºï¼ˆapplicationï¼‰ä¸­å·²ç»ä½¿ç”¨äº†ä»¥ä¸‹çš„å‡ ç§APIæ¥è¿›è¡Œæ—¥å¿—çš„ç¼–ç¨‹ï¼š</p><p>commons-logging + log4j<br>ç°åœ¨æƒ³ç»Ÿä¸€å°†æ—¥å¿—çš„è¾“å‡ºäº¤ç»™jdk-loggingã€‚</p><p>è§£å†³æ–¹æ¡ˆï¼š</p><p>å°†ä¸Šé¢çš„æ—¥å¿—ç³»ç»Ÿå…¨éƒ¨è½¬æ¢åˆ°slf4j</p><p>ä½¿ç”¨jcl-over-slf4j(æ¡¥æ¥)å°†commons-loggingçš„åº•å±‚æ—¥å¿—è¾“å‡ºåˆ‡æ¢åˆ°sl4jï¼Œæˆ–è€…ç§»é™¤log4j1(å¿…é¡»ç§»é™¤)ï¼Œä½¿ç”¨log4j-over-slf4j(æ¡¥æ¥)ï¼Œå°†log4j1çš„æ—¥å¿—è¾“å‡ºåˆ‡æ¢åˆ°slf4jï¼Œè®©slf4jé€‰æ‹©jdk-loggingä½œä¸ºåº•å±‚æ—¥å¿—è¾“å‡º</p><p>é—®é¢˜ï¼šç›®å‰çš„åº”ç”¨ç¨‹åºï¼ˆapplicationï¼‰ä¸­å·²ç»ä½¿ç”¨äº†ä»¥ä¸‹çš„å‡ ç§APIæ¥è¿›è¡Œæ—¥å¿—çš„ç¼–ç¨‹ï¼š</p><p>commons-logging<br>jdk-loging<br>ç°åœ¨æƒ³ç»Ÿä¸€å°†æ—¥å¿—çš„è¾“å‡ºäº¤ç»™log4j1ã€‚</p><p>è§£å†³æ–¹æ³•ï¼š</p><p>å°†ä¸Šé¢çš„æ—¥å¿—ç³»ç»Ÿå…¨éƒ¨è½¬æ¢åˆ°slf4j</p><p>ç§»é™¤commons-logging(å¯ä»¥ä¸ç§»é™¤)ï¼Œä½¿ç”¨jcl-over-slf4j(æ¡¥æ¥)å°†commons-loggingçš„åº•å±‚æ—¥å¿—è¾“å‡ºåˆ‡æ¢åˆ°sl4jï¼Œä½¿ç”¨jul-to-slf4j(æ¡¥æ¥)ï¼Œå°†julçš„æ—¥å¿—è¾“å‡ºåˆ‡æ¢åˆ°slf4jï¼Œè®©slf4jé€‰æ‹©log4j1ä½œä¸ºåº•å±‚æ—¥å¿—è¾“å‡º</p><p>é—®é¢˜ï¼šç›®å‰çš„åº”ç”¨ç¨‹åºï¼ˆapplicationï¼‰ä¸­å·²ç»ä½¿ç”¨äº†ä»¥ä¸‹çš„å‡ ç§APIæ¥è¿›è¡Œæ—¥å¿—çš„ç¼–ç¨‹ï¼š</p><p>commons-logging<br>log4j1<br>jdk-loging<br>ç°åœ¨æƒ³ç»Ÿä¸€å°†æ—¥å¿—çš„åº•å±‚å¤„ç†äº¤ç»™logbackï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œç”¨å¤šç§APIç¼–ç¨‹ï¼Œç”¨logbackå®ç°æ—¥å¿—è¾“å‡ºã€‚</p><p>è§£å†³æ–¹æ³•ï¼š</p><p>å°†ä¸Šé¢çš„æ—¥å¿—ç³»ç»Ÿå…¨éƒ¨è½¬æ¢åˆ°slf4j</p><p>ç§»é™¤commons-logging(å¯ä»¥ä¸ç§»é™¤)ï¼Œä½¿ç”¨jcl-over-slf4j(æ¡¥æ¥)å°†commons-loggingçš„åº•å±‚æ—¥å¿—è¾“å‡ºåˆ‡æ¢åˆ°sl4jï¼Œç§»é™¤log4j1å®ç°ï¼ˆå¿…é¡»ç§»é™¤ï¼‰ï¼Œä½¿ç”¨log4j-over-slf4j(æ¡¥æ¥)å°†log4j1çš„æ—¥å¿—è¾“å‡ºåˆ‡æ¢åˆ°sl4jï¼Œä½¿ç”¨jul-to-slf4j(æ¡¥æ¥)ï¼Œå°†julçš„æ—¥å¿—è¾“å‡ºåˆ‡æ¢åˆ°slf4jï¼Œè®©slf4jé€‰æ‹©logbackä½œä¸ºåº•å±‚æ—¥å¿—è¾“å‡º</p><h2 id="æ—§æ—¥å¿—APIåˆ°slf4jçš„é€‚é…å™¨"><a href="#æ—§æ—¥å¿—APIåˆ°slf4jçš„é€‚é…å™¨" class="headerlink" title="æ—§æ—¥å¿—APIåˆ°slf4jçš„é€‚é…å™¨"></a>æ—§æ—¥å¿—APIåˆ°slf4jçš„é€‚é…å™¨</h2><p>ä»‹ç»ä¹‹å‰å…ˆè¯´æ˜ä¸‹æ—¥å¿—ç®€ç§°ï¼š</p><p>jdkè‡ªå¸¦çš„loggingï¼Œç®€ç§° jul (java-util-logging)<br>apache commons-loggingï¼Œç®€ç§° jcl (java-commons-logging)<br>æ—¥å¿—é€‚é…å™¨ï¼š<br>jcl-over-slf4j    java-commons-logging APIåˆ°slf4jçš„é€‚é…<br>jul-to-slf4j    java-util-logging APIåˆ°slf4jçš„é€‚é…<br>log4j-over-slf4j    log4j 1 APIåˆ°slf4jçš„é€‚é…<br>log4j-to-slf4j    log4j 2 APIåˆ°slf4jçš„é€‚é…</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!-- JCL 1.2 implemented over SLF4J --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.slf4j<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>jcl-over-slf4j<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.7.24<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><br><span class="hljs-comment">&lt;!-- JUL to SLF4J bridge --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.slf4j<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>jul-to-slf4j<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.7.24<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><br><span class="hljs-comment">&lt;!-- Log4j implemented over SLF4J --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.slf4j<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>log4j-over-slf4j<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.7.24<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><br><span class="hljs-comment">&lt;!-- Log4j 2 to SLF4J Adapter --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.apache.logging.log4j<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>log4j-to-slf4j<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.8.1<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure><h2 id="slf4jåˆ°æ–°æ—¥å¿—å®ç°çš„é€‚é…å™¨"><a href="#slf4jåˆ°æ–°æ—¥å¿—å®ç°çš„é€‚é…å™¨" class="headerlink" title="slf4jåˆ°æ–°æ—¥å¿—å®ç°çš„é€‚é…å™¨"></a>slf4jåˆ°æ–°æ—¥å¿—å®ç°çš„é€‚é…å™¨</h2><p>æ—¥å¿—é€‚é…å™¨ï¼š<br>slf4j-jcl    slf4jåˆ°java-commons-loggingçš„é€‚é…<br>slf4j-jdk14    slf4jåˆ°java-util-loggingå®ç°çš„é€‚é…<br>slf4j-log4j12    slf4jåˆ°log4j 1å®ç°çš„é€‚é…<br>log4j-slf4j-impl    slf4jåˆ°log4j 2å®ç°çš„é€‚é…</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!-- SLF4J JCL Binding --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.slf4j<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>slf4j-jcl<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.7.24<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><br><span class="hljs-comment">&lt;!-- SLF4J JDK14 Binding --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.slf4j<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>slf4j-jdk14<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.7.24<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><br><span class="hljs-comment">&lt;!-- SLF4J LOG4J-12 Binding --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.slf4j<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>slf4j-log4j12<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.7.24<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><br><span class="hljs-comment">&lt;!-- SLF4J Log4j 2 Binding --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.apache.logging.log4j<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>log4j-slf4j-impl<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.8.1<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure><h2 id="slf4jå†²çªè¯´æ˜"><a href="#slf4jå†²çªè¯´æ˜" class="headerlink" title="slf4jå†²çªè¯´æ˜"></a>slf4jå†²çªè¯´æ˜</h2><p>å…¶å®æ˜ç™½ä¸Šé¢ä»‹ç»çš„å„jaråŒ…çš„ä½œç”¨ï¼Œå°±å¾ˆå®¹æ˜“ç†è§£ä¸ºä»€ä¹ˆä¼šå‡ºç°å†²çªäº†ã€‚</p><p>å†²çªçš„å‡ºç°ä¸»è¦æ˜¯å½¢æˆäº†æ—¥å¿—çš„äº‹ä»¶é—­ç¯ã€‚å°±ç›¸å½“äºä¸¤ä¸ªäººåœ¨äº’ç›¸æ¨å¸è´£ä»»ã€‚</p><ol><li>jcl-over-slf4j ä¸ slf4j-jcl å†²çª<br>jcl-over-slf4j : commons-loggingåˆ‡æ¢åˆ°slf4j<br>slf4j-jcl : slf4jåˆ‡æ¢åˆ°commons-logging<br>jclæŠŠæ—¥å¿—è¾“å‡ºäº‹ä»¶äº¤ç»™slf4jï¼Œslf4jåˆè¿˜ç»™äº†jclã€‚</li></ol><p>å¦‚æœè¿™ä¸¤è€…å…±å­˜çš„è¯ï¼Œå¿…ç„¶é€ æˆç›¸äº’å§”æ‰˜ï¼Œé€ æˆå†…å­˜æº¢å‡ºã€‚</p><ol start="2"><li>log4j-over-slf4j ä¸ slf4j-log4j12 å†²çª<br>log4j-over-slf4j ï¼š log4j1åˆ‡æ¢åˆ°slf4j<br>slf4j-log4j12 : slf4jåˆ‡æ¢åˆ°log4j1<br>log4j1æŠŠæ—¥å¿—è¾“å‡ºäº‹ä»¶äº¤ç»™slf4jï¼Œslf4jåˆè¿˜ç»™äº†log4j1ã€‚</li></ol><p>å¦‚æœè¿™ä¸¤è€…å…±å­˜çš„è¯ï¼Œå¿…ç„¶é€ æˆç›¸äº’å§”æ‰˜ï¼Œé€ æˆå†…å­˜æº¢å‡ºã€‚</p><ol start="3"><li>jul-to-slf4j ä¸ slf4j-jdk14 å†²çª<br>jul-to-slf4j : jdk-loggingåˆ‡æ¢åˆ°slf4j<br>slf4j-jdk14 : slf4jåˆ‡æ¢åˆ°jdk-logging<br>julæŠŠæ—¥å¿—è¾“å‡ºäº‹ä»¶äº¤ç»™slf4jï¼Œslf4jåˆè¿˜ç»™äº†julã€‚</li></ol><p>å¦‚æœè¿™ä¸¤è€…å…±å­˜çš„è¯ï¼Œå¿…ç„¶é€ æˆç›¸äº’å§”æ‰˜ï¼Œé€ æˆå†…å­˜æº¢å‡ºã€‚</p><h1 id="å››ã€é…ç½®é—®é¢˜"><a href="#å››ã€é…ç½®é—®é¢˜" class="headerlink" title="å››ã€é…ç½®é—®é¢˜"></a>å››ã€é…ç½®é—®é¢˜</h1><p>ä¸ç®¡ä½¿ç”¨é‚£ç§æ—¥å¿—å®ç°ç±»ï¼Œéƒ½å¯ä»¥è‡ªå®šä¹‰é…ç½®çš„ï¼Œæ ¹æ®é¡¹ç›®æ‰€ä½¿ç”¨çš„æ—¥å¿—ç³»ç»Ÿï¼Œç¼–å†™æ—¥å¿—é…ç½®å³å¯ï¼Œå½¢å¼ä¸ºxxx.xmlæˆ–è€…xxx.propertiesã€‚</p><p>ç¼–å†™çš„é…ç½®æ–‡ä»¶æ”¾åœ¨ç±»è·¯å¾„ä¸‹ï¼Œå¦‚æœä½¿ç”¨çš„æ˜¯springåˆ™æ”¾åœ¨resourcesæ–‡ä»¶å¤¹ä¸‹ã€‚</p><p>commoms-logging.propertiesï¼šåœ¨å¼•å…¥å¤šä¸ªæ—¥å¿—å®ç°ç±»æ—¶ï¼Œå¯ä»¥æ‰‹åŠ¨é€‰æ‹©åŠ è½½å“ªä¸€ä¸ª</p><p>log4j.propertiesï¼šå…·ä½“é…ç½®å‚è§<a href="https://logging.apache.org/log4j/2.x/">https://logging.apache.org/log4j/2.x/</a></p><p>log4j2.xmlï¼šå…·ä½“é…ç½®å‚è§<a href="https://logging.apache.org/log4j/2.x/">https://logging.apache.org/log4j/2.x/</a></p><p>logback.xmlï¼šå…·ä½“é…ç½®å‚è§<a href="https://logback.qos.ch/">Logback Home (qos.ch)</a></p><p>ç”±äºæœ¬ç¯‡æ–‡ç« ï¼Œåªåšå„ç§æ—¥å¿—å…³ç³»çš„æ¢³ç†ä»¥åŠç®€å•ä½¿ç”¨ï¼Œæ‰€ä»¥å…·ä½“å„ç§æ—¥å¿—çš„å…·ä½“é…ç½®ï¼Œæš‚ä¸ä½œè®²è§£ï¼Œè‹¥éœ€è¦è¯·è‡ªè¡Œåˆ°ç›¸åº”å®˜ç½‘äº†è§£ï¼Œæˆ–è€…æŸ¥çœ‹å…¶ä»–åšå®¢å¯¹é…ç½®æ–‡ä»¶çš„è®²è§£ã€‚</p><p>ğŸ¤­ğŸ¤­ğŸ¤­è‹¥ç²¾åŠ›æœ‰é™ï¼Œå®šä¼šè¡¥ä¸Š</p>]]></content>
    
    
    
    <tags>
      
      <tag>log</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Mysqlé«˜çº§</title>
    <link href="/2022/03/13/mysql2/"/>
    <url>/2022/03/13/mysql2/</url>
    
    <content type="html"><![CDATA[<h1 id="ä¸€ã€Mysqlé€»è¾‘æ¶æ„"><a href="#ä¸€ã€Mysqlé€»è¾‘æ¶æ„" class="headerlink" title="ä¸€ã€Mysqlé€»è¾‘æ¶æ„"></a>ä¸€ã€Mysqlé€»è¾‘æ¶æ„</h1><h2 id="1ã€æ•´ä½“æ¶æ„"><a href="#1ã€æ•´ä½“æ¶æ„" class="headerlink" title="1ã€æ•´ä½“æ¶æ„"></a>1ã€æ•´ä½“æ¶æ„</h2><p><a href="https://nyimapicture.oss-cn-beijing.aliyuncs.com/img/20200813170808.png"><img src="/mysql2.assets/20200813170808.png" alt="img"></a></p><h3 id="è¿æ¥å±‚"><a href="#è¿æ¥å±‚" class="headerlink" title="è¿æ¥å±‚"></a>è¿æ¥å±‚</h3><p>æœ€ä¸Šå±‚æ˜¯ä¸€äº›å®¢æœç«¯å’Œè¿æ¥æœåŠ¡ï¼ŒåŒ…æ‹¬socketé€šä¿¡å’Œå¤§å¤šæ•°åŸºäºå®¢æœç«¯&#x2F;æœåŠ¡ç«¯å·¥å…·å®ç°çš„ç±»ä¼¼äºtcp&#x2F;ipçš„é€šä¿¡ï¼Œä¸»è¦å®Œæˆä¸€äº›ç±»ä¼¼äºè¿æ¥å¤„ç†ã€æˆæƒè®¤è¯åŠç›¸å…³å®‰å…¨çš„æ–¹æ¡ˆï¼Œåœ¨è¯¥å±‚ä¸Šå¼•å…¥äº†çº¿ç¨‹æ± çš„æ¦‚å¿µï¼Œä¸ºé€šè¿‡è®¤è¯å®‰å…¨æ¥å…¥çš„å®¢æœç«¯æä¾›çº¿ç¨‹ï¼ŒåŒæ ·åœ¨è¯¥å±‚ä¸Šå¯ä»¥å®ç°åŸºäºSSLçš„å®‰å…¨çš„è¿æ¥ï¼ŒæœåŠ¡å™¨ä¹Ÿä¼šä¸ºå®‰å…¨æ¥å…¥çš„æ¯ä¸ªå®¢æˆ·ç«¯éªŒè¯å®ƒæ‰€å…·æœ‰çš„æ“ä½œæƒé™</p><h3 id="æœåŠ¡å±‚"><a href="#æœåŠ¡å±‚" class="headerlink" title="æœåŠ¡å±‚"></a>æœåŠ¡å±‚</h3><p>ç¬¬äºŒå±‚æ¶æ„ä¸»è¦å®Œæˆå¤§å¤šæ•°çš„æ ¸å¿ƒæœåŠ¡åŠŸèƒ½ï¼Œå¦‚SQLæ¥å£ï¼Œå¹¶å®Œæˆç¼“å­˜çš„æŸ¥è¯¢ï¼ŒSQLçš„åˆ†æä»¥åŠä¼˜åŒ–éƒ¨åˆ†å†…ç½®å‡½æ•°çš„æ‰§è¡Œï¼Œæ‰€æœ‰è·¨å­˜å‚¨å¼•æ“çš„åŠŸèƒ½ä¹Ÿåœ¨è¿™ä¸€å±‚å®ç°ï¼Œå¦‚è¿‡ç¨‹ã€å‡½æ•°ç­‰ï¼ŒæœåŠ¡å™¨ä¼šè§£ææŸ¥è¯¢å¹¶åˆ›å»ºç›¸åº”çš„å†…éƒ¨è§£ææ ‘ï¼Œå¹¶å¯¹å…¶å®Œæˆç›¸åº”çš„ä¼˜åŒ–å¦‚ç¡®å®šæŸ¥è¯¢çš„é¡ºåºæ˜¯å¦åˆ©ç”¨ç´¢å¼•ï¼Œæœ€åç”Ÿæˆç›¸åº”çš„æ‰§è¡Œæ“ä½œ</p><table><thead><tr><th>Management Serveices &amp; Utilities</th><th>ç³»ç»Ÿç®¡ç†å’Œæ§åˆ¶å·¥å…·</th></tr></thead><tbody><tr><td>SQL Interface</td><td>SQL æ¥å£ã€‚æ¥å—ç”¨æˆ·çš„ SQL å‘½ä»¤ï¼Œå¹¶ä¸”è¿”å›ç”¨æˆ·éœ€è¦æŸ¥è¯¢çš„ç»“æœã€‚æ¯”å¦‚ select from å°±æ˜¯è°ƒç”¨ SQL Interface</td></tr><tr><td>Parser</td><td>è§£æå™¨ã€‚ SQL å‘½ä»¤ä¼ é€’åˆ°è§£æå™¨çš„æ—¶å€™ä¼šè¢«è§£æå™¨éªŒè¯å’Œè§£æ</td></tr><tr><td>Optimizer</td><td>æŸ¥è¯¢ä¼˜åŒ–å™¨ã€‚ SQL è¯­å¥åœ¨æŸ¥è¯¢ä¹‹å‰ä¼šä½¿ç”¨æŸ¥è¯¢ä¼˜åŒ–å™¨å¯¹æŸ¥è¯¢è¿›è¡Œä¼˜åŒ–ï¼Œæ¯”å¦‚æœ‰ where æ¡ä»¶æ—¶ï¼Œä¼˜åŒ–å™¨æ¥å†³å®šå…ˆæŠ•å½±è¿˜æ˜¯å…ˆè¿‡æ»¤ã€‚</td></tr><tr><td>Cache å’Œ Buffer</td><td>æŸ¥è¯¢ç¼“å­˜ã€‚å¦‚æœæŸ¥è¯¢ç¼“å­˜æœ‰å‘½ä¸­çš„æŸ¥è¯¢ç»“æœï¼ŒæŸ¥è¯¢è¯­å¥å°±å¯ä»¥ç›´æ¥å»æŸ¥è¯¢ç¼“å­˜ä¸­å–æ•°æ®ã€‚è¿™ä¸ªç¼“å­˜æœºåˆ¶æ˜¯ç”±ä¸€ç³»åˆ—å°ç¼“å­˜ç»„æˆçš„ã€‚æ¯”å¦‚è¡¨ç¼“å­˜ï¼Œè®°å½•ç¼“å­˜ï¼Œkey ç¼“å­˜ï¼Œ æƒé™ç¼“å­˜ç­‰</td></tr></tbody></table><h3 id="å¼•æ“å±‚"><a href="#å¼•æ“å±‚" class="headerlink" title="å¼•æ“å±‚"></a>å¼•æ“å±‚</h3><p>å­˜å‚¨å¼•æ“å±‚ï¼Œå­˜å‚¨å¼•æ“çœŸæ­£çš„è´Ÿè´£äº†MySQLä¸­æ•°æ®çš„å­˜å‚¨å’Œæå–ï¼ŒæœåŠ¡å™¨é€šè¿‡APIä¸å­˜å‚¨å¼•æ“è¿›è¡Œé€šä¿¡ï¼Œä¸åŒçš„å­˜å‚¨å¼•æ“å…·æœ‰åŠŸèƒ½ä¸åŒ</p><table><thead><tr><th>å¯¹æ¯”é¡¹</th><th>MylSAM</th><th>InnoDB</th></tr></thead><tbody><tr><td>ä¸»å¤–é”®</td><td>ä¸æ”¯æŒ</td><td>æ”¯æŒ</td></tr><tr><td>äº‹åŠ¡</td><td>ä¸æ”¯æŒ</td><td>æ”¯æŒ</td></tr><tr><td>è¡Œè¡¨é”</td><td>è¡¨é”ï¼ˆä¸é€‚åˆé«˜å¹¶å‘ï¼‰</td><td>è¡Œé”ï¼ˆé€‚åˆé«˜å¹¶å‘æ“ä½œï¼‰</td></tr><tr><td>ç¼“å­˜</td><td>åªç¼“å­˜ç´¢å¼•ï¼Œä¸ç¼“å­˜çœŸå®æ•°æ®</td><td>ä¸ä»…ç¼“å­˜ç´¢å¼•ï¼Œè¿˜ç¼“å­˜çœŸå®æ•°æ®ã€‚å¯¹å†…å­˜è¦æ±‚è¾ƒé«˜</td></tr><tr><td>è¡¨ç©ºé—´</td><td>å°</td><td>å¤§</td></tr><tr><td>å…³æ³¨ç‚¹</td><td>æ€§èƒ½</td><td>äº‹åŠ¡</td></tr><tr><td>é»˜è®¤å®‰è£…</td><td>æ˜¯</td><td>æ˜¯</td></tr></tbody></table><h3 id="å­˜å‚¨å±‚"><a href="#å­˜å‚¨å±‚" class="headerlink" title="å­˜å‚¨å±‚"></a>å­˜å‚¨å±‚</h3><p>æ•°æ®å­˜å‚¨å±‚ï¼Œä¸»è¦æ˜¯å°†æ•°æ®å­˜å‚¨åœ¨è¿è¡Œäºè£¸è®¾å¤‡çš„æ–‡ä»¶ç³»ç»Ÿä¹‹ä¸Šï¼Œå¹¶å®Œæˆä¸å­˜å‚¨å¼•æ“çš„äº¤äº’</p><h1 id="äºŒã€æ€§èƒ½ä¸JOIN"><a href="#äºŒã€æ€§èƒ½ä¸JOIN" class="headerlink" title="äºŒã€æ€§èƒ½ä¸JOIN"></a>äºŒã€æ€§èƒ½ä¸JOIN</h1><h2 id="1ã€æ€§èƒ½ä¸‹é™åŸå› "><a href="#1ã€æ€§èƒ½ä¸‹é™åŸå› " class="headerlink" title="1ã€æ€§èƒ½ä¸‹é™åŸå› "></a>1ã€æ€§èƒ½ä¸‹é™åŸå› </h2><h3 id="ç´¢å¼•å¤±æ•ˆ"><a href="#ç´¢å¼•å¤±æ•ˆ" class="headerlink" title="ç´¢å¼•å¤±æ•ˆ"></a>ç´¢å¼•å¤±æ•ˆ</h3><p><strong>å•å€¼ç´¢å¼•</strong></p><p>åˆ›å»ºè¯­å¥</p><figure class="highlight oxygene"><table><tr><td class="gutter"><div class="code-wrapper"><pre><span class="line">1</span><br></pre></div></td><td class="code"><pre><code class="hljs oxygene"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">INDEX</span> idx_è¡¨å_å­—æ®µå <span class="hljs-keyword">ON</span> è¡¨å(å­—æ®µå)<span class="hljs-punctuation">;</span><span class="hljs-keyword">Copy</span><br></code></pre></td></tr></table></figure><p><strong>å¤åˆç´¢å¼•</strong></p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">CREATE</span> INDEX idx_è¡¨å_å­—æ®µå<span class="hljs-number">1</span>å­—æ®µå<span class="hljs-number">2</span>... <span class="hljs-literal">ON</span> è¡¨å(å­—æ®µå<span class="hljs-number">1</span>, å­—æ®µå<span class="hljs-number">2</span> ...);Copy<br></code></pre></td></tr></table></figure><h3 id="å…³è”å¤ªå¤šJOIN"><a href="#å…³è”å¤ªå¤šJOIN" class="headerlink" title="å…³è”å¤ªå¤šJOIN"></a>å…³è”å¤ªå¤šJOIN</h3><p>å†…è¿æ¥ã€å¤–è¿æ¥çš„è¡¨ä¸è¦è¿‡å¤š</p><h3 id="æœåŠ¡å™¨è°ƒä¼˜åŠå‚æ•°è®¾ç½®"><a href="#æœåŠ¡å™¨è°ƒä¼˜åŠå‚æ•°è®¾ç½®" class="headerlink" title="æœåŠ¡å™¨è°ƒä¼˜åŠå‚æ•°è®¾ç½®"></a>æœåŠ¡å™¨è°ƒä¼˜åŠå‚æ•°è®¾ç½®</h3><h2 id="2ã€SQLæ‰§è¡ŒåŠ è½½é¡ºåº"><a href="#2ã€SQLæ‰§è¡ŒåŠ è½½é¡ºåº" class="headerlink" title="2ã€SQLæ‰§è¡ŒåŠ è½½é¡ºåº"></a>2ã€SQLæ‰§è¡ŒåŠ è½½é¡ºåº</h2><h3 id="æ‰‹å†™é¡ºåº"><a href="#æ‰‹å†™é¡ºåº" class="headerlink" title="æ‰‹å†™é¡ºåº"></a>æ‰‹å†™é¡ºåº</h3><p><a href="https://nyimapicture.oss-cn-beijing.aliyuncs.com/img/20200814112248.png"><img src="/mysql2.assets/20200814112248.png" alt="img"></a></p><p>éšç€ Mysql ç‰ˆæœ¬çš„æ›´æ–°æ¢ä»£ï¼Œå…¶ä¼˜åŒ–å™¨ä¹Ÿåœ¨ä¸æ–­çš„å‡çº§ï¼Œä¼˜åŒ–å™¨ä¼šåˆ†æä¸åŒæ‰§è¡Œé¡ºåºäº§ç”Ÿçš„æ€§èƒ½æ¶ˆè€—ä¸åŒè€Œ<strong>åŠ¨æ€è°ƒæ•´æ‰§è¡Œé¡ºåº</strong></p><p>ä¸‹é¢æ˜¯ç»å¸¸å‡ºç°çš„æŸ¥è¯¢é¡ºåºï¼š</p><p><a href="https://nyimapicture.oss-cn-beijing.aliyuncs.com/img/20200814112330.png"><img src="/mysql2.assets/20200814112330.png" alt="img"></a></p><p><a href="https://nyimapicture.oss-cn-beijing.aliyuncs.com/img/20200814112343.png"><img src="/mysql2.assets/20200814112343.png" alt="img"></a></p><p><a href="https://nyimapicture.oss-cn-beijing.aliyuncs.com/img/20200814191644.png"><img src="/mysql2.assets/20200814191644.png" alt="img"></a></p><h2 id="3ã€7ç§JOIN"><a href="#3ã€7ç§JOIN" class="headerlink" title="3ã€7ç§JOIN"></a>3ã€7ç§JOIN</h2><p><a href="https://nyimapicture.oss-cn-beijing.aliyuncs.com/img/20200814150926.png"><img src="/mysql2.assets/20200814150926.png" alt="img"></a></p><h3 id="å»ºè¡¨è¯­å¥"><a href="#å»ºè¡¨è¯­å¥" class="headerlink" title="å»ºè¡¨è¯­å¥"></a><strong>å»ºè¡¨è¯­å¥</strong></h3><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> `t_dept` (<br>`id` <span class="hljs-type">INT</span>(<span class="hljs-number">11</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> AUTO_INCREMENT, `deptName` <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">30</span>) <span class="hljs-keyword">DEFAULT</span> <span class="hljs-keyword">NULL</span>, `address` <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">40</span>) <span class="hljs-keyword">DEFAULT</span> <span class="hljs-keyword">NULL</span>, <span class="hljs-keyword">PRIMARY KEY</span> (`id`)<br>) ENGINE=INNODB AUTO_INCREMENT=<span class="hljs-number">1</span> <span class="hljs-keyword">DEFAULT</span> CHARSET=utf8;<br><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> `t_emp` (<br>`id` <span class="hljs-type">INT</span>(<span class="hljs-number">11</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> AUTO_INCREMENT, `<span class="hljs-type">name</span>` <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">20</span>) <span class="hljs-keyword">DEFAULT</span> <span class="hljs-keyword">NULL</span>, `age` <span class="hljs-type">INT</span>(<span class="hljs-number">3</span>) <span class="hljs-keyword">DEFAULT</span> <span class="hljs-keyword">NULL</span>, `deptId` <span class="hljs-type">INT</span>(<span class="hljs-number">11</span>) <span class="hljs-keyword">DEFAULT</span> <span class="hljs-keyword">NULL</span>, empno <span class="hljs-type">INT</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>, <span class="hljs-keyword">PRIMARY KEY</span> (`id`), KEY `idx_dept_id` (`deptId`)<br><span class="hljs-meta">#CONSTRAINT `fk_dept_id` FOREIGN KEY (`deptId`) REFERENCES `t_dept` (`id`)</span><br>) ENGINE=INNODB AUTO_INCREMENT=<span class="hljs-number">1</span> <span class="hljs-keyword">DEFAULT</span> CHARSET=utf8;<br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> t_dept(deptName,address) <span class="hljs-keyword">VALUES</span>(<span class="hljs-string">&#x27;åå±±&#x27;</span>,<span class="hljs-string">&#x27;åå±±&#x27;</span>);<br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> t_dept(deptName,address) <span class="hljs-keyword">VALUES</span>(<span class="hljs-string">&#x27;ä¸å¸®&#x27;</span>,<span class="hljs-string">&#x27;æ´›é˜³&#x27;</span>);<br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> t_dept(deptName,address) <span class="hljs-keyword">VALUES</span>(<span class="hljs-string">&#x27;å³¨çœ‰&#x27;</span>,<span class="hljs-string">&#x27;å³¨çœ‰å±±&#x27;</span>);<br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> t_dept(deptName,address) <span class="hljs-keyword">VALUES</span>(<span class="hljs-string">&#x27;æ­¦å½“&#x27;</span>,<span class="hljs-string">&#x27;æ­¦å½“å±±&#x27;</span>);<br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> t_dept(deptName,address) <span class="hljs-keyword">VALUES</span>(<span class="hljs-string">&#x27;æ˜æ•™&#x27;</span>,<span class="hljs-string">&#x27;å…‰æ˜é¡¶&#x27;</span>);<br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> t_dept(deptName,address) <span class="hljs-keyword">VALUES</span>(<span class="hljs-string">&#x27;å°‘æ—&#x27;</span>,<span class="hljs-string">&#x27;å°‘æ—å¯º&#x27;</span>);<br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> t_emp(<span class="hljs-type">NAME</span>,age,deptId,empno) <span class="hljs-keyword">VALUES</span>(<span class="hljs-string">&#x27;é£æ¸…æ‰¬&#x27;</span>,<span class="hljs-number">90</span>,<span class="hljs-number">1</span>,<span class="hljs-number">100001</span>);<br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> t_emp(<span class="hljs-type">NAME</span>,age,deptId,empno) <span class="hljs-keyword">VALUES</span>(<span class="hljs-string">&#x27;å²³ä¸ç¾¤&#x27;</span>,<span class="hljs-number">50</span>,<span class="hljs-number">1</span>,<span class="hljs-number">100002</span>);<br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> t_emp(<span class="hljs-type">NAME</span>,age,deptId,empno) <span class="hljs-keyword">VALUES</span>(<span class="hljs-string">&#x27;ä»¤ç‹å†²&#x27;</span>,<span class="hljs-number">24</span>,<span class="hljs-number">1</span>,<span class="hljs-number">100003</span>);<br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> t_emp(<span class="hljs-type">NAME</span>,age,deptId,empno) <span class="hljs-keyword">VALUES</span>(<span class="hljs-string">&#x27;æ´ªä¸ƒå…¬&#x27;</span>,<span class="hljs-number">70</span>,<span class="hljs-number">2</span>,<span class="hljs-number">100004</span>);<br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> t_emp(<span class="hljs-type">NAME</span>,age,deptId,empno) <span class="hljs-keyword">VALUES</span>(<span class="hljs-string">&#x27;ä¹”å³°&#x27;</span>,<span class="hljs-number">35</span>,<span class="hljs-number">2</span>,<span class="hljs-number">100005</span>);<br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> t_emp(<span class="hljs-type">NAME</span>,age,deptId,empno) <span class="hljs-keyword">VALUES</span>(<span class="hljs-string">&#x27;ç­ç»å¸ˆå¤ª&#x27;</span>,<span class="hljs-number">70</span>,<span class="hljs-number">3</span>,<span class="hljs-number">100006</span>);<br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> t_emp(<span class="hljs-type">NAME</span>,age,deptId,empno) <span class="hljs-keyword">VALUES</span>(<span class="hljs-string">&#x27;å‘¨èŠ·è‹¥&#x27;</span>,<span class="hljs-number">20</span>,<span class="hljs-number">3</span>,<span class="hljs-number">100007</span>);<br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> t_emp(<span class="hljs-type">NAME</span>,age,deptId,empno) <span class="hljs-keyword">VALUES</span>(<span class="hljs-string">&#x27;å¼ ä¸‰ä¸°&#x27;</span>,<span class="hljs-number">100</span>,<span class="hljs-number">4</span>,<span class="hljs-number">100008</span>);<br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> t_emp(<span class="hljs-type">NAME</span>,age,deptId,empno) <span class="hljs-keyword">VALUES</span>(<span class="hljs-string">&#x27;å¼ æ— å¿Œ&#x27;</span>,<span class="hljs-number">25</span>,<span class="hljs-number">5</span>,<span class="hljs-number">100009</span>);<br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> t_emp(<span class="hljs-type">NAME</span>,age,deptId,empno) <span class="hljs-keyword">VALUES</span>(<span class="hljs-string">&#x27;éŸ¦å°å®&#x27;</span>,<span class="hljs-number">18</span>,<span class="hljs-keyword">NULL</span>,<span class="hljs-number">100010</span>);<span class="hljs-keyword">Copy</span><br></code></pre></td></tr></table></figure><h3 id="JOINæŸ¥è¯¢"><a href="#JOINæŸ¥è¯¢" class="headerlink" title="JOINæŸ¥è¯¢"></a>JOINæŸ¥è¯¢</h3><ul><li>ç¬›å¡å°”ç§¯</li></ul><figure class="highlight oxygene"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs oxygene"><span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> t_dept, t_emp<span class="hljs-punctuation">;</span><span class="hljs-keyword">Copy</span><br></code></pre></td></tr></table></figure><p>t_deptå…±20æ¡è®°å½•ï¼Œt_empå…±6æ¡è®°å½•ã€‚ä¸¤è¡¨å…±åŒæŸ¥è¯¢åå…±120æ¡è®°å½•</p><ul><li>å†…è¿æ¥</li></ul><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> t_emp a <span class="hljs-keyword">INNER</span> <span class="hljs-keyword">JOIN</span> t_dept b <span class="hljs-keyword">ON</span>  a.deptId = b.id;<span class="hljs-keyword">Copy</span><br></code></pre></td></tr></table></figure><p><a href="https://nyimapicture.oss-cn-beijing.aliyuncs.com/img/20200814153140.png"><img src="/mysql2.assets/20200814153140.png" alt="img"></a></p><ul><li>å·¦å¤–è¿æ¥</li></ul><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs n1ql"><span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> t_emp a <span class="hljs-keyword">LEFT</span> <span class="hljs-keyword">JOIN</span> t_dept b <span class="hljs-keyword">ON</span>  a.deptId = b.id;Copy<br></code></pre></td></tr></table></figure><p><a href="https://nyimapicture.oss-cn-beijing.aliyuncs.com/img/20200814153254.png"><img src="/mysql2.assets/20200814153254.png" alt="img"></a></p><ul><li>å³å¤–è¿æ¥</li></ul><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs n1ql"><span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> t_emp a <span class="hljs-keyword">RIGHT</span> <span class="hljs-keyword">JOIN</span> t_dept b <span class="hljs-keyword">ON</span>  a.deptId = b.id;Copy<br></code></pre></td></tr></table></figure><p><a href="https://nyimapicture.oss-cn-beijing.aliyuncs.com/img/20200814153413.png"><img src="/mysql2.assets/20200814153413.png" alt="img"></a></p><ul><li>å·¦å¤–è¿æ¥<strong>å–å·¦è¡¨çš„ç‹¬æœ‰éƒ¨åˆ†</strong></li></ul><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs n1ql"><span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> t_emp a <span class="hljs-keyword">LEFT</span> <span class="hljs-keyword">JOIN</span> t_dept b <span class="hljs-keyword">ON</span>  a.deptId = b.id <span class="hljs-keyword">WHERE</span> a.deptId <span class="hljs-keyword">IS</span> <span class="hljs-literal">NULL</span>;Copy<br></code></pre></td></tr></table></figure><p><a href="https://nyimapicture.oss-cn-beijing.aliyuncs.com/img/20200814153909.png"><img src="/mysql2.assets/20200814153909.png" alt="img"></a></p><ul><li>å³å¤–è¿æ¥<strong>å–å³è¡¨çš„ç‹¬æœ‰éƒ¨åˆ†</strong></li></ul><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs n1ql"><span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> t_emp a <span class="hljs-keyword">RIGHT</span> <span class="hljs-keyword">JOIN</span> t_dept b <span class="hljs-keyword">ON</span> a.deptId = b.id <span class="hljs-keyword">WHERE</span> a.deptId <span class="hljs-keyword">IS</span> <span class="hljs-literal">NULL</span>;Copy<br></code></pre></td></tr></table></figure><p><a href="https://nyimapicture.oss-cn-beijing.aliyuncs.com/img/20200814153844.png"><img src="/mysql2.assets/20200814153844.png" alt="img"></a></p><p><strong>æ³¨æ„</strong>ï¼šåˆ¤æ–­å­—æ®µæ˜¯å¦ä¸ºNULLæ—¶ï¼Œ<strong>ä¸èƒ½ä½¿ç”¨â€™&#x3D;â€™</strong></p><p>å› ä¸º</p><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs asciidoc"><span class="hljs-section">= NULLCopy</span><br></code></pre></td></tr></table></figure><p>çš„ç»“æœä¸ä¼šæŠ¥é”™ï¼Œä½†æ˜¯<strong>ç»“æœæ°¸è¿œä¸ºfalse</strong>ã€‚æ‰€ä»¥å¿…é¡»ä½¿ç”¨</p><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ada"><span class="hljs-keyword">IS</span> NULLCopy<br></code></pre></td></tr></table></figure><p>æ¥è¿›è¡Œåˆ¤ç©º</p><ul><li>å…¨å¤–è¿æ¥</li></ul><p>MySQLä¸æ”¯æŒå…¨å¤–è¿æ¥ï¼Œè¦æŸ¥è¯¢ä¸¤ä¸ªè¡¨çš„å…¨é›†ï¼Œéœ€è¦åˆå¹¶ä¸¤ä¸ªæŸ¥è¯¢ç»“æœï¼Œæ‰€ä»¥è¦ä½¿ç”¨ <strong>UNION</strong> å…³é”®å­—</p><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs n1ql"><span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> t_emp a <span class="hljs-keyword">LEFT</span> <span class="hljs-keyword">JOIN</span> t_dept b <span class="hljs-keyword">ON</span> a.deptId = b.id<br><span class="hljs-keyword">UNION</span><br><span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> t_emp a <span class="hljs-keyword">RIGHT</span> <span class="hljs-keyword">JOIN</span> t_dept b <span class="hljs-keyword">ON</span> a.deptId = b.id;Copy<br></code></pre></td></tr></table></figure><p><a href="https://nyimapicture.oss-cn-beijing.aliyuncs.com/img/20200814154554.png"><img src="/mysql2.assets/20200814154554.png" alt="img"></a></p><ul><li>æŸ¥è¯¢ä¸¤è¡¨ç‹¬æœ‰å†…å®¹</li></ul><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs n1ql"><span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> t_emp a <span class="hljs-keyword">LEFT</span> <span class="hljs-keyword">JOIN</span> t_dept b <span class="hljs-keyword">ON</span> a.deptId = b.id <span class="hljs-keyword">WHERE</span> b.id <span class="hljs-keyword">IS</span> <span class="hljs-literal">NULL</span><br><span class="hljs-keyword">UNION</span><br><span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> t_emp a <span class="hljs-keyword">RIGHT</span> <span class="hljs-keyword">JOIN</span> t_dept b <span class="hljs-keyword">ON</span> a.deptId = b.id <span class="hljs-keyword">WHERE</span> a.deptId <span class="hljs-keyword">IS</span> <span class="hljs-literal">NULL</span>;Copy<br></code></pre></td></tr></table></figure><p><a href="https://nyimapicture.oss-cn-beijing.aliyuncs.com/img/20200814155138.png"><img src="/mysql2.assets/20200814155138.png" alt="img"></a></p><h1 id="ä¸‰ã€ç´¢å¼•ä¼˜åŒ–"><a href="#ä¸‰ã€ç´¢å¼•ä¼˜åŒ–" class="headerlink" title="ä¸‰ã€ç´¢å¼•ä¼˜åŒ–"></a>ä¸‰ã€ç´¢å¼•ä¼˜åŒ–</h1><h2 id="1ã€ä»€ä¹ˆæ˜¯ç´¢å¼•"><a href="#1ã€ä»€ä¹ˆæ˜¯ç´¢å¼•" class="headerlink" title="1ã€ä»€ä¹ˆæ˜¯ç´¢å¼•"></a>1ã€ä»€ä¹ˆæ˜¯ç´¢å¼•</h2><ul><li><p>MySQL å®˜æ–¹å¯¹ç´¢å¼•çš„å®šä¹‰ä¸ºï¼š<strong>ç´¢å¼•ï¼ˆIndexï¼‰æ˜¯å¸®åŠ© MySQL é«˜æ•ˆè·å–æ•°æ®çš„æ•°æ®ç»“æ„</strong>ã€‚å¯ä»¥å¾—åˆ°ç´¢å¼•çš„æœ¬è´¨ï¼š <strong>ç´¢å¼•æ˜¯æ•°æ®ç»“æ„</strong>ã€‚</p><p>å¯ä»¥ç®€å•ç†è§£ä¸ºï¼š<strong>æ’å¥½åºçš„å¿«é€ŸæŸ¥æ‰¾æ•°æ®ç»“æ„</strong></p></li><li><p>åœ¨æ•°æ®ä¹‹å¤–ï¼Œæ•°æ®åº“ç³»ç»Ÿè¿˜ç»´æŠ¤ç€æ»¡è¶³ç‰¹å®šæŸ¥æ‰¾ç®—æ³•çš„æ•°æ®ç»“æ„ï¼Œè¿™äº›æ•°æ®ç»“æ„ä»¥æŸç§æ–¹å¼å¼•ç”¨ï¼ˆæŒ‡å‘ï¼‰æ•°æ®ï¼Œ è¿™æ ·å°±å¯ä»¥åœ¨è¿™äº›æ•°æ®ç»“æ„ä¸Šå®ç°é«˜çº§æŸ¥æ‰¾ç®—æ³•ã€‚è¿™ç§æ•°æ®ç»“æ„ï¼Œå°±æ˜¯ç´¢å¼•ã€‚ä¸‹å›¾å°±æ˜¯ä¸€ç§å¯èƒ½çš„ç´¢å¼•æ–¹å¼ç¤ºä¾‹ï¼š</p></li></ul><p><a href="https://nyimapicture.oss-cn-beijing.aliyuncs.com/img/20200814173647.png"><img src="/mysql2.assets/20200814173647.png" alt="img"></a></p><ul><li>å·¦è¾¹æ˜¯æ•°æ®è¡¨ï¼Œä¸€å…±æœ‰ä¸¤åˆ—ä¸ƒæ¡è®°å½•ï¼Œæœ€å·¦è¾¹çš„æ˜¯æ•°æ®è®°å½•çš„ç‰©ç†åœ°å€ã€‚ä¸ºäº†åŠ å¿« Col2 çš„æŸ¥æ‰¾ï¼Œå¯ä»¥ç»´æŠ¤ä¸€ä¸ªå³è¾¹æ‰€ç¤ºçš„äºŒå‰æŸ¥æ‰¾æ ‘ï¼Œæ¯ä¸ªèŠ‚ç‚¹åˆ†åˆ«åŒ…å«ç´¢å¼•é”®å€¼å’Œä¸€ä¸ªæŒ‡å‘å¯¹åº”æ•°æ®è®°å½•ç‰©ç†åœ°å€çš„æŒ‡é’ˆï¼Œè¿™æ ·å°±å¯ä»¥è¿ç”¨ äºŒå‰æŸ¥æ‰¾åœ¨ä¸€å®šçš„å¤æ‚åº¦å†…è·å–åˆ°ç›¸åº”æ•°æ®ï¼Œä»è€Œå¿«é€Ÿçš„æ£€ç´¢å‡ºç¬¦åˆæ¡ä»¶çš„è®°å½•</li><li>ä¸€èˆ¬æ¥è¯´ç´¢å¼•æœ¬èº«ä¹Ÿå¾ˆå¤§ï¼Œä¸å¯èƒ½å…¨éƒ¨å­˜å‚¨åœ¨å†…å­˜ä¸­ï¼Œå› æ­¤ç´¢å¼•å¾€å¾€ä»¥ç´¢å¼•æ–‡ä»¶çš„å½¢å¼å­˜å‚¨çš„ç£ç›˜ä¸Š</li></ul><h2 id="2ã€ç´¢å¼•çš„ä¼˜ç¼ºç‚¹"><a href="#2ã€ç´¢å¼•çš„ä¼˜ç¼ºç‚¹" class="headerlink" title="2ã€ç´¢å¼•çš„ä¼˜ç¼ºç‚¹"></a>2ã€ç´¢å¼•çš„ä¼˜ç¼ºç‚¹</h2><h3 id="ä¼˜ç‚¹"><a href="#ä¼˜ç‚¹" class="headerlink" title="ä¼˜ç‚¹"></a>ä¼˜ç‚¹</h3><ul><li><strong>æé«˜æ•°æ®æ£€ç´¢çš„æ•ˆç‡</strong>ï¼Œé™ä½æ•°æ®åº“çš„IOæˆæœ¬</li><li>é€šè¿‡ç´¢å¼•åˆ—å¯¹æ•°æ®è¿›è¡Œæ’åºï¼Œ<strong>é™ä½æ•°æ®æ’åºçš„æˆæœ¬</strong>ï¼Œé™ä½äº†CPUçš„æ¶ˆè€—</li></ul><h3 id="ç¼ºç‚¹"><a href="#ç¼ºç‚¹" class="headerlink" title="ç¼ºç‚¹"></a>ç¼ºç‚¹</h3><ul><li>è™½ç„¶ç´¢å¼•å¤§å¤§æé«˜äº†æŸ¥è¯¢é€Ÿåº¦ï¼ŒåŒæ—¶å´<strong>ä¼šé™ä½æ›´æ–°è¡¨çš„é€Ÿåº¦</strong>ï¼Œå¦‚å¯¹è¡¨è¿›è¡ŒINSERTã€UPDATEå’ŒDELETEã€‚å› ä¸ºæ›´æ–°è¡¨æ—¶ï¼ŒMySQLä¸ä»…è¦ä¿å­˜æ•°æ®ï¼Œè¿˜è¦ä¿å­˜ä¸€ä¸‹ç´¢å¼•æ–‡ä»¶æ¯æ¬¡æ›´æ–°æ·»åŠ äº†ç´¢å¼•åˆ—çš„å­—æ®µï¼Œéƒ½ä¼šè°ƒæ•´å› ä¸ºæ›´æ–°æ‰€å¸¦æ¥çš„é”®å€¼å˜åŒ–åçš„ç´¢å¼•ä¿¡æ¯</li><li>å®é™…ä¸Šç´¢å¼•ä¹Ÿæ˜¯ä¸€å¼ è¡¨ï¼Œè¯¥è¡¨ä¿å­˜äº†ä¸»é”®ä¸ç´¢å¼•å­—æ®µï¼Œå¹¶æŒ‡å‘å®ä½“è¡¨çš„è®°å½•ï¼Œæ‰€ä»¥<strong>ç´¢å¼•åˆ—ä¹Ÿæ˜¯è¦å ç”¨ç©ºé—´çš„</strong></li></ul><h2 id="3ã€ç´¢å¼•çš„åˆ†ç±»"><a href="#3ã€ç´¢å¼•çš„åˆ†ç±»" class="headerlink" title="3ã€ç´¢å¼•çš„åˆ†ç±»"></a>3ã€ç´¢å¼•çš„åˆ†ç±»</h2><h3 id="åŸºæœ¬è¯­æ³•"><a href="#åŸºæœ¬è¯­æ³•" class="headerlink" title="åŸºæœ¬è¯­æ³•"></a>åŸºæœ¬è¯­æ³•</h3><ul><li><p>åˆ›å»º</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-keyword">CREATE</span> [<span class="hljs-keyword">UNIQUE</span>] <span class="hljs-keyword">INDEX</span> [indexName] <span class="hljs-keyword">ON</span> <span class="hljs-built_in">table_name</span>(<span class="hljs-keyword">column</span>);<span class="hljs-keyword">Copy</span><br></code></pre></td></tr></table></figure></li><li><p>åˆ é™¤</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-keyword">DROP</span> <span class="hljs-keyword">INDEX</span> [indexName] <span class="hljs-keyword">ON</span> <span class="hljs-built_in">table_name</span>;<span class="hljs-keyword">Copy</span><br></code></pre></td></tr></table></figure></li><li><p>æŸ¥çœ‹</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-keyword">SHOW</span> <span class="hljs-keyword">INDEX</span> <span class="hljs-keyword">FROM</span> <span class="hljs-built_in">table_name</span>;<span class="hljs-keyword">Copy</span><br></code></pre></td></tr></table></figure></li></ul><h3 id="åˆ†ç±»"><a href="#åˆ†ç±»" class="headerlink" title="åˆ†ç±»"></a>åˆ†ç±»</h3><ul><li><p>å•å€¼ç´¢å¼•</p><ul><li><p>å®šä¹‰ï¼šå³ä¸€ä¸ªç´¢å¼•åªåŒ…å«å•ä¸ªåˆ—ï¼Œä¸€ä¸ªè¡¨å¯ä»¥æœ‰å¤šä¸ªå•åˆ—ç´¢å¼•</p></li><li><p>è¯­æ³•ï¼š</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-comment">--å’Œè¡¨ä¸€èµ·åˆ›å»º</span><br><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> customer (<br>id <span class="hljs-type">INT</span>(<span class="hljs-number">10</span>) UNSIGNED AUTO_INCREMENT,<br>customer_no <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">200</span>),<br>customer_name <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">200</span>), <br><span class="hljs-keyword">PRIMARY KEY</span>(id), <br>KEY (customer_name) <span class="hljs-comment">--å•å€¼ç´¢å¼•</span><br>);<br><br><span class="hljs-comment">--å•ç‹¬åˆ›å»ºå•å€¼ç´¢å¼•</span><br><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">INDEX</span> idx_customer_name <span class="hljs-keyword">ON</span> customer(customer_name);<span class="hljs-keyword">Copy</span><br></code></pre></td></tr></table></figure></li></ul></li><li><p>å”¯ä¸€ç´¢å¼•</p><ul><li><p>å®šä¹‰ï¼šç´¢å¼•åˆ—çš„å€¼å¿…é¡»å”¯ä¸€ï¼Œä½†å…è®¸æœ‰ç©ºå€¼</p></li><li><p>è¯­æ³•ï¼š</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-comment">--å’Œè¡¨ä¸€èµ·åˆ›å»º</span><br><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> customer (<br>id <span class="hljs-type">INT</span>(<span class="hljs-number">10</span>) UNSIGNED AUTO_INCREMENT,<br>customer_no <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">200</span>),<br>customer_name <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">200</span>), <br><span class="hljs-keyword">PRIMARY KEY</span>(id), <br>KEY (customer_name), <span class="hljs-comment">--å•å€¼ç´¢å¼•</span><br><span class="hljs-keyword">UNIQUE</span> (customer_no) <span class="hljs-comment">--å”¯ä¸€ç´¢å¼•</span><br>);<br><br><span class="hljs-comment">--å•ç‹¬åˆ›å»ºå”¯ä¸€ç´¢å¼•</span><br><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">UNIQUE</span> <span class="hljs-keyword">INDEX</span> idx_customer_no <span class="hljs-keyword">ON</span> customer(customer_no);<span class="hljs-keyword">Copy</span><br></code></pre></td></tr></table></figure></li></ul></li><li><p>ä¸»é”®ç´¢å¼•</p><ul><li><p>å®šä¹‰ï¼šè®¾å®šä¸ºä¸»é”®åæ•°æ®åº“ä¼š<strong>è‡ªåŠ¨å»ºç«‹ç´¢å¼•</strong>ï¼Œinnodbä¸ºèšç°‡ç´¢å¼•</p></li><li><p>è¯­æ³•ï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">--å’Œè¡¨ä¸€èµ·åˆ›å»º</span><br><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> customer (<br>id <span class="hljs-type">INT</span>(<span class="hljs-number">10</span>) UNSIGNED AUTO_INCREMENT,<br>customer_no <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">200</span>),<br>customer_name <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">200</span>), <br><span class="hljs-keyword">PRIMARY</span> KEY(id) <span class="hljs-comment">--ä¸»é”®ç´¢å¼•</span><br>);<br><br><span class="hljs-comment">--å•ç‹¬åˆ›å»ºä¸»é”®ç´¢å¼•</span><br><span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">TABLE</span> customer <span class="hljs-keyword">ADD</span> <span class="hljs-keyword">PRIMARY</span> KEY customer(customer_no);<br><br><span class="hljs-comment">--åˆ é™¤ä¸»é”®ç´¢å¼•</span><br><span class="hljs-keyword">ALTER</span> <span class="hljs-keyword">TABLE</span> customer <span class="hljs-keyword">DROP</span> <span class="hljs-keyword">PRIMARY</span> KEY;<br><br><span class="hljs-comment">--ä¿®æ”¹å»ºä¸»é”®ç´¢å¼•</span><br>å¿…é¡»å…ˆåˆ é™¤æ‰(<span class="hljs-keyword">drop</span>)åŸç´¢å¼•ï¼Œå†æ–°å»º(<span class="hljs-keyword">add</span>)ç´¢å¼•<span class="hljs-keyword">Copy</span><br></code></pre></td></tr></table></figure></li></ul></li><li><p>å¤åˆç´¢å¼•</p><ul><li><p>å®šä¹‰ï¼šå³ä¸€ä¸ªç´¢å¼•åŒ…å«å¤šä¸ªåˆ—</p></li><li><p>è¯­æ³•ï¼š</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-comment">--å’Œè¡¨ä¸€èµ·åˆ›å»º</span><br><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> customer (<br>id <span class="hljs-type">INT</span>(<span class="hljs-number">10</span>) UNSIGNED AUTO_INCREMENT,<br>customer_no <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">200</span>),<br>customer_name <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">200</span>), <br><span class="hljs-keyword">PRIMARY KEY</span>(id), <br>KEY (customer_name), <span class="hljs-comment">--å•å€¼ç´¢å¼•</span><br><span class="hljs-keyword">UNIQUE</span> (customer_no), <span class="hljs-comment">--å”¯ä¸€ç´¢å¼•</span><br>KEY (customer_no,customer_name) <span class="hljs-comment">--å¤åˆç´¢å¼•</span><br>);<br><br><span class="hljs-comment">--å•ç‹¬åˆ›å»ºå¤åˆç´¢å¼•</span><br><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">INDEX</span> idx_no_name <span class="hljs-keyword">ON</span> customer(customer_no,customer_name);<span class="hljs-keyword">Copy</span><br></code></pre></td></tr></table></figure></li></ul></li></ul><h2 id="4ã€MySQLçš„ç´¢å¼•"><a href="#4ã€MySQLçš„ç´¢å¼•" class="headerlink" title="4ã€MySQLçš„ç´¢å¼•"></a>4ã€MySQLçš„ç´¢å¼•</h2><h3 id="Bæ ‘ä¸B-æ ‘"><a href="#Bæ ‘ä¸B-æ ‘" class="headerlink" title="Bæ ‘ä¸B+æ ‘"></a>Bæ ‘ä¸B+æ ‘</h3><p><a href="https://www.jianshu.com/p/ace3cd6526c4">æ ‘çš„å†…å®¹å‚ç…§</a></p><p><a href="https://nyimapicture.oss-cn-beijing.aliyuncs.com/img/20200815153029.png"><img src="/mysql2.assets/20200815153029.png" alt="img"></a></p><p><a href="https://nyimapicture.oss-cn-beijing.aliyuncs.com/img/20200815153043.png"><img src="/mysql2.assets/20200815153043.png" alt="img"></a></p><h4 id="åŒºåˆ«"><a href="#åŒºåˆ«" class="headerlink" title="åŒºåˆ«"></a>åŒºåˆ«</h4><ul><li>Bæ ‘çš„<strong>å…³é”®å­—å’Œè®°å½•æ˜¯æ”¾åœ¨ä¸€èµ·çš„</strong>ï¼Œå¶å­èŠ‚ç‚¹å¯ä»¥çœ‹ä½œå¤–éƒ¨èŠ‚ç‚¹ï¼Œä¸åŒ…å«ä»»ä½•ä¿¡æ¯ï¼›B+æ ‘çš„éå¶å­èŠ‚ç‚¹ä¸­åªæœ‰å…³é”®å­—å’ŒæŒ‡å‘ä¸‹ä¸€ä¸ªèŠ‚ç‚¹çš„ç´¢å¼•ï¼Œ<strong>è®°å½•åªæ”¾åœ¨å¶å­èŠ‚ç‚¹ä¸­</strong></li><li>åœ¨ Bæ ‘ä¸­ï¼Œè¶Šé è¿‘æ ¹èŠ‚ç‚¹çš„è®°å½•æŸ¥æ‰¾æ—¶é—´è¶Šå¿«ï¼Œåªè¦æ‰¾åˆ°å…³é”®å­—å³å¯ç¡®å®šè®°å½•çš„å­˜åœ¨ï¼›è€Œ B+æ ‘ä¸­æ¯ä¸ªè®°å½• çš„æŸ¥æ‰¾æ—¶é—´åŸºæœ¬æ˜¯ä¸€æ ·çš„ï¼Œéƒ½éœ€è¦ä»æ ¹èŠ‚ç‚¹èµ°åˆ°å¶å­èŠ‚ç‚¹ï¼Œè€Œä¸”åœ¨å¶å­èŠ‚ç‚¹ä¸­è¿˜è¦å†æ¯”è¾ƒå…³é”®å­—ã€‚ä»è¿™ä¸ªè§’åº¦çœ‹ Bæ ‘çš„æ€§èƒ½å¥½åƒè¦æ¯” B+æ ‘å¥½ï¼Œè€Œåœ¨å®é™…åº”ç”¨ä¸­å´æ˜¯ B+æ ‘çš„æ€§èƒ½è¦å¥½äº›ã€‚å› ä¸º B+æ ‘çš„éå¶å­èŠ‚ç‚¹ä¸å­˜æ”¾å®é™…çš„æ•°æ®ï¼Œ è¿™æ ·æ¯ä¸ªèŠ‚ç‚¹å¯å®¹çº³çš„å…ƒç´ ä¸ªæ•°æ¯” Bæ ‘å¤šï¼Œæ ‘é«˜æ¯” Bæ ‘å°ï¼Œè¿™æ ·å¸¦æ¥çš„å¥½å¤„æ˜¯å‡å°‘ç£ç›˜è®¿é—®æ¬¡æ•°ã€‚å°½ç®¡ B+æ ‘æ‰¾åˆ° ä¸€ä¸ªè®°å½•æ‰€éœ€çš„æ¯”è¾ƒæ¬¡æ•°è¦æ¯” Bæ ‘å¤šï¼Œä½†æ˜¯ä¸€æ¬¡ç£ç›˜è®¿é—®çš„æ—¶é—´ç›¸å½“äºæˆç™¾ä¸Šåƒæ¬¡å†…å­˜æ¯”è¾ƒçš„æ—¶é—´ï¼Œå› æ­¤å®é™…ä¸­ B+æ ‘çš„æ€§èƒ½å¯èƒ½è¿˜ä¼šå¥½äº›ï¼Œè€Œä¸” B+æ ‘çš„å¶å­èŠ‚ç‚¹ä½¿ç”¨æŒ‡é’ˆè¿æ¥åœ¨ä¸€èµ·ï¼Œæ–¹ä¾¿é¡ºåºéå†ï¼ˆä¾‹å¦‚æŸ¥çœ‹ä¸€ä¸ªç›®å½•ä¸‹çš„æ‰€æœ‰ æ–‡ä»¶ï¼Œä¸€ä¸ªè¡¨ä¸­çš„æ‰€æœ‰è®°å½•ç­‰ï¼‰ï¼Œè¿™ä¹Ÿæ˜¯å¾ˆå¤šæ•°æ®åº“å’Œæ–‡ä»¶ç³»ç»Ÿä½¿ç”¨ B+æ ‘çš„ç¼˜æ•…</li></ul><p><strong>ä¸ºä»€ä¹ˆè¯´ B+æ ‘æ¯” B-æ ‘æ›´é€‚åˆå®é™…åº”ç”¨ä¸­æ“ä½œç³»ç»Ÿçš„æ–‡ä»¶ç´¢å¼•å’Œæ•°æ®åº“ç´¢å¼•ï¼Ÿ</strong></p><ul><li>B+æ ‘çš„ç£ç›˜è¯»å†™ä»£ä»·æ›´ä½<ul><li>B+æ ‘çš„å†…éƒ¨ç»“ç‚¹å¹¶æ²¡æœ‰æŒ‡å‘å…³é”®å­—å…·ä½“ä¿¡æ¯çš„æŒ‡é’ˆã€‚å› æ­¤å…¶å†…éƒ¨ç»“ç‚¹ç›¸å¯¹ B æ ‘æ›´å°ã€‚å¦‚æœæŠŠæ‰€æœ‰åŒä¸€å†…éƒ¨ç»“ç‚¹ çš„å…³é”®å­—å­˜æ”¾åœ¨åŒä¸€ç›˜å—ä¸­ï¼Œé‚£ä¹ˆç›˜å—æ‰€èƒ½å®¹çº³çš„å…³é”®å­—æ•°é‡ä¹Ÿè¶Šå¤šã€‚ä¸€æ¬¡æ€§è¯»å…¥å†…å­˜ä¸­çš„éœ€è¦æŸ¥æ‰¾çš„å…³é”®å­—ä¹Ÿå°±è¶Šå¤šã€‚ç›¸å¯¹æ¥è¯´ IO è¯»å†™æ¬¡æ•°ä¹Ÿå°±é™ä½äº†</li></ul></li><li>B+æ ‘çš„æŸ¥è¯¢æ•ˆç‡æ›´åŠ ç¨³å®š<ul><li>ç”±äºéç»ˆç»“ç‚¹å¹¶ä¸æ˜¯æœ€ç»ˆæŒ‡å‘æ–‡ä»¶å†…å®¹çš„ç»“ç‚¹ï¼Œè€Œåªæ˜¯å¶å­ç»“ç‚¹ä¸­å…³é”®å­—çš„ç´¢å¼•ã€‚æ‰€ä»¥ä»»ä½•å…³é”®å­—çš„æŸ¥æ‰¾å¿…é¡»èµ°ä¸€æ¡ä»æ ¹ç»“ç‚¹åˆ°å¶å­ç»“ç‚¹çš„è·¯ã€‚æ‰€æœ‰å…³é”®å­—æŸ¥è¯¢çš„è·¯å¾„é•¿åº¦ç›¸åŒï¼Œå¯¼è‡´æ¯ä¸€ä¸ªæ•°æ®çš„æŸ¥è¯¢æ•ˆç‡ç›¸å½“</li></ul></li></ul><h3 id="MySQLä¸­çš„B-æ ‘"><a href="#MySQLä¸­çš„B-æ ‘" class="headerlink" title="MySQLä¸­çš„B+æ ‘"></a>MySQLä¸­çš„B+æ ‘</h3><h4 id="ä¸»é”®ç´¢å¼•"><a href="#ä¸»é”®ç´¢å¼•" class="headerlink" title="ä¸»é”®ç´¢å¼•"></a>ä¸»é”®ç´¢å¼•</h4><p><a href="https://nyimapicture.oss-cn-beijing.aliyuncs.com/img/20200822173605.png"><img src="/mysql2.assets/20200822173605.png" alt="img"></a></p><p>MySQLåœ¨åˆ›å»ºè¡¨æ—¶ï¼Œä¼šæ ¹æ®ä¸»é”®æ¥åˆ›å»ºä¸»é”®ç´¢å¼•ï¼ˆå¦‚æœæ²¡æœ‰ä¸»é”®ï¼Œä¼šç”¨ä¸€ä¸ªéšè—å€¼æ¥ä½œä¸ºä¸»é”®ï¼‰ã€‚ä¸»é”®ç´¢å¼•æ‰€æ„å»ºçš„B+æ ‘ï¼Œè¡¨ä¸­æ‰€æœ‰çš„è®°å½•éƒ½å­˜æ”¾åœ¨äº†æ ‘çš„æœ€åä¸€å±‚ã€‚<strong>ä¸”ä¸ä¸€èˆ¬çš„B+æ ‘ä¸åŒçš„æ˜¯ï¼šå¶å­èŠ‚ç‚¹é—´çš„æŒ‡é’ˆæ˜¯åŒå‘çš„</strong></p><h4 id="å¤åˆç´¢å¼•"><a href="#å¤åˆç´¢å¼•" class="headerlink" title="å¤åˆç´¢å¼•"></a>å¤åˆç´¢å¼•</h4><p><a href="https://nyimapicture.oss-cn-beijing.aliyuncs.com/img/20200822185520.png"><img src="/mysql2.assets/20200822185520.png" alt="img"></a></p><p>åˆ›å»ºå¤åˆç´¢å¼•æ—¶ï¼Œä¼šå°†ä½œä¸º<strong>å¤åˆç´¢å¼•å­—æ®µçš„å€¼</strong>è¿›è¡Œæ’åºå¹¶æ”¾åœ¨B+æ ‘çš„æœ€åä¸€å±‚ä¸­ï¼ŒåŒæ—¶è¿˜ä¼šå°†å…¶<strong>å¯¹åº”çš„ä¸»é”®å€¼</strong>æ”¾åœ¨å…¶åã€‚å¦‚ï¼š</p><table><thead><tr><th>aï¼ˆä¸»é”®ï¼‰</th><th>b</th><th>c</th><th>d</th><th>e</th></tr></thead><tbody><tr><td>2</td><td>1</td><td>1</td><td>1</td><td>a</td></tr></tbody></table><p>å…¶ä¸­å­—æ®µaä¸ºä¸»é”®ï¼Œå­—æ®µbcdå…±åŒä½œä¸ºå¤åˆç´¢å¼•ï¼Œæ­¤æ—¶å­˜æ”¾åœ¨æœ€åä¸€å±‚çš„æ•°æ®å°±æ˜¯ï¼š111ï¼ˆå¤åˆç´¢å¼•ï¼‰ 2ï¼ˆä¸»é”®ç´¢å¼•ï¼‰</p><p>æ ¹æ®è¿™ä¸ªç‰¹ç‚¹ï¼Œå¯ä»¥çœ‹å‡ºå¤åˆç´¢å¼•å…·æœ‰ä»¥ä¸‹ä½¿ç”¨æ–¹æ³•</p><ul><li><p>æœ€ä½³å·¦å‰ç¼€ï¼šä½¿ç”¨å¤åˆç´¢å¼•çš„é¡ºåºå¿…é¡»å’Œåˆ›å»ºçš„<strong>é¡ºåºä¸€è‡´</strong></p></li><li><p>è¦†ç›–ç´¢å¼•çš„åŒæ—¶ï¼Œå¯ä»¥å¸¦ä¸Šä¸»é”®å­—æ®µï¼Œå¦‚</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css">SELECT <span class="hljs-selector-tag">a</span>, <span class="hljs-selector-tag">b</span>, c, d <span class="hljs-selector-tag">FROM</span> t_emp;Copy<br></code></pre></td></tr></table></figure><p>å› ä¸º<strong>ä¸»é”®å­—æ®µå’Œå¤åˆç´¢å¼•ä¸€èµ·å­˜æ”¾åœ¨äº†å¤åˆç´¢å¼•è¯´äº§ç”Ÿçš„B+æ ‘çš„æœ€åä¸€å±‚</strong>ã€‚å¦‚æœéœ€è¦aå­—æ®µï¼Œæ— éœ€è¿›è¡Œå…¨è¡¨æ‰«æ</p></li><li><p>å¦‚æœè¿›è¡ŒèŒƒå›´æŸ¥æ‰¾ï¼Œå¯èƒ½ä¼šè¿›è¡Œå…¨è¡¨æ‰«æï¼Œè¿™å–å†³äºå¤„åœ¨èŒƒå›´å†…è®°å½•çš„å¤šå°‘</p><ul><li><p><strong>è®°å½•å¤š</strong>ï¼Œä»å¤åˆç´¢å¼•æ˜ å°„åˆ°ä¸»é”®ç´¢å¼•çš„æ¬¡æ•°è¿‡å¤šï¼Œæˆæœ¬è¿‡é«˜ï¼Œ<strong>ä¼šç›´æ¥è¿›è¡Œå…¨è¡¨æ‰«æ</strong></p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-keyword">EXPLAIN</span> <span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> t_emp <span class="hljs-keyword">WHERE</span> age &gt; <span class="hljs-number">1</span>;<span class="hljs-keyword">Copy</span><br></code></pre></td></tr></table></figure><p><a href="https://nyimapicture.oss-cn-beijing.aliyuncs.com/img/20200822175336.png"><img src="/mysql2.assets/20200822175336.png" alt="img"></a></p></li><li><p><strong>è®°å½•å°‘</strong>ï¼Œå…ˆ<strong>ä½¿ç”¨å¤åˆç´¢å¼•</strong>ï¼Œç„¶åæ˜ å°„åˆ°å…¨è¡¨ä¸­çš„å¯¹åº”è®°å½•ä¸Š</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-keyword">EXPLAIN</span> <span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> t_emp <span class="hljs-keyword">WHERE</span> age &gt; <span class="hljs-number">80</span>;<span class="hljs-keyword">Copy</span><br></code></pre></td></tr></table></figure><p><a href="https://nyimapicture.oss-cn-beijing.aliyuncs.com/img/20200822175403.png"><img src="/mysql2.assets/20200822175403.png" alt="img"></a></p></li><li><p>ä½†æ˜¯ä½¿ç”¨<strong>è¦†ç›–ç´¢å¼•</strong>ï¼Œæ— è®ºè®°å½•å¤šå°‘ï¼Œéƒ½ä¼šç”¨åˆ°ç´¢å¼•</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-keyword">EXPLAIN</span> <span class="hljs-keyword">SELECT</span> age, <span class="hljs-type">name</span> <span class="hljs-keyword">FROM</span> t_emp <span class="hljs-keyword">WHERE</span> age &gt; <span class="hljs-number">1</span>;<span class="hljs-keyword">Copy</span><br></code></pre></td></tr></table></figure><p><a href="https://nyimapicture.oss-cn-beijing.aliyuncs.com/img/20200822175611.png"><img src="/mysql2.assets/20200822175611.png" alt="img"></a></p></li></ul></li><li><p>ä¸å¸¦WHEREä¹Ÿå¯ä»¥é€šè¿‡å¤åˆç´¢å¼•æŸ¥æ‰¾åˆ°ä¸»é”®+å¤åˆç´¢å¼•çš„è®°å½•</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-keyword">EXPLAIN</span> <span class="hljs-keyword">SELECT</span> id, age, <span class="hljs-type">name</span>, deptId <span class="hljs-keyword">FROM</span> t_emp ;<span class="hljs-keyword">Copy</span><br></code></pre></td></tr></table></figure><p><a href="https://nyimapicture.oss-cn-beijing.aliyuncs.com/img/20200822175746.png"><img src="/mysql2.assets/20200822175746.png" alt="img"></a></p></li></ul><h2 id="5ã€ç´¢å¼•çš„ä½¿ç”¨åœºæ™¯"><a href="#5ã€ç´¢å¼•çš„ä½¿ç”¨åœºæ™¯" class="headerlink" title="5ã€ç´¢å¼•çš„ä½¿ç”¨åœºæ™¯"></a>5ã€ç´¢å¼•çš„ä½¿ç”¨åœºæ™¯</h2><h3 id="é€‚åˆç´¢å¼•çš„åœºæ™¯"><a href="#é€‚åˆç´¢å¼•çš„åœºæ™¯" class="headerlink" title="é€‚åˆç´¢å¼•çš„åœºæ™¯"></a>é€‚åˆç´¢å¼•çš„åœºæ™¯</h3><ul><li>ä¸»é”®è‡ªåŠ¨å»ºç«‹å”¯ä¸€ç´¢å¼•</li><li>é¢‘ç¹ä½œä¸º<strong>æŸ¥è¯¢æ¡ä»¶</strong>çš„å­—æ®µåº”è¯¥åˆ›å»ºç´¢å¼•</li><li>æŸ¥è¯¢ä¸­ä¸å…¶å®ƒè¡¨å…³è”çš„å­—æ®µï¼Œ<strong>å¤–é”®å…³ç³»</strong>å»ºç«‹ç´¢å¼•</li><li>å•é”®&#x2F;ç»„åˆç´¢å¼•çš„é€‰æ‹©é—®é¢˜ï¼Œ<strong>ç»„åˆç´¢å¼•æ€§ä»·æ¯”æ›´é«˜</strong></li><li>æŸ¥è¯¢ä¸­<strong>æ’åºçš„å­—æ®µ</strong>ï¼Œæ’åºå­—æ®µè‹¥é€šè¿‡ç´¢å¼•å»è®¿é—®å°†å¤§å¤§æé«˜æ’åºé€Ÿåº¦</li><li>æŸ¥è¯¢ä¸­<strong>ç»Ÿè®¡</strong>æˆ–è€…<strong>åˆ†ç»„</strong>å­—æ®µ</li></ul><h3 id="ä¸é€‚åˆç´¢å¼•çš„åœºæ™¯"><a href="#ä¸é€‚åˆç´¢å¼•çš„åœºæ™¯" class="headerlink" title="ä¸é€‚åˆç´¢å¼•çš„åœºæ™¯"></a>ä¸é€‚åˆç´¢å¼•çš„åœºæ™¯</h3><ul><li>è¡¨<strong>è®°å½•å¤ªå°‘</strong>ï¼ˆæœ‰æ— ç´¢å¼•å·®åˆ«ä¸å¤§ï¼‰</li><li>ç»å¸¸<strong>å¢åˆ æ”¹</strong>çš„è¡¨æˆ–è€…å­—æ®µ</li><li>Where æ¡ä»¶é‡Œç”¨ä¸åˆ°çš„å­—æ®µä¸åˆ›å»ºç´¢å¼•</li><li><strong>è¿‡æ»¤æ€§ä¸å¥½</strong>çš„ä¸é€‚åˆå»ºç´¢å¼•ï¼ˆé‡å¤æ€§è¾ƒé«˜ï¼Œæ¯”å¦‚å›½ç±ã€æ€§åˆ«ä¹‹ç±»çš„å­—æ®µï¼‰</li></ul><h1 id="å››ã€Explain-æ€§èƒ½åˆ†æ"><a href="#å››ã€Explain-æ€§èƒ½åˆ†æ" class="headerlink" title="å››ã€Explain æ€§èƒ½åˆ†æ"></a>å››ã€Explain æ€§èƒ½åˆ†æ</h1><h2 id="1ã€æ¦‚å¿µ"><a href="#1ã€æ¦‚å¿µ" class="headerlink" title="1ã€æ¦‚å¿µ"></a>1ã€æ¦‚å¿µ</h2><p>ä½¿ç”¨ <strong>EXPLAIN</strong> å…³é”®å­—å¯ä»¥æ¨¡æ‹Ÿä¼˜åŒ–å™¨æ‰§è¡Œ SQL æŸ¥è¯¢è¯­å¥ï¼Œä»è€ŒçŸ¥é“ MySQL æ˜¯å¦‚ä½•å¤„ç†ä½ çš„ SQL è¯­å¥çš„ã€‚<strong>åˆ†æ</strong>ä½ çš„æŸ¥è¯¢è¯­å¥æˆ–æ˜¯è¡¨ç»“æ„çš„<strong>æ€§èƒ½ç“¶é¢ˆ</strong></p><h2 id="2ã€ç”¨æ³•"><a href="#2ã€ç”¨æ³•" class="headerlink" title="2ã€ç”¨æ³•"></a>2ã€ç”¨æ³•</h2><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-comment">--EXPLAIN + SQLè¯­å¥ï¼Œå¦‚ï¼š</span><br><span class="hljs-keyword">EXPLAIN</span> <span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> person;<span class="hljs-keyword">Copy</span><br></code></pre></td></tr></table></figure><p><strong>Explain æ‰§è¡Œåè¿”å›çš„ä¿¡æ¯ï¼š</strong></p><p><a href="https://nyimapicture.oss-cn-beijing.aliyuncs.com/img/20200815171636.png"><img src="/mysql2.assets/20200815171636.png" alt="img"></a></p><h2 id="3ã€è¡¨å¤´å­—æ®µä»‹ç»"><a href="#3ã€è¡¨å¤´å­—æ®µä»‹ç»" class="headerlink" title="3ã€è¡¨å¤´å­—æ®µä»‹ç»"></a>3ã€è¡¨å¤´å­—æ®µä»‹ç»</h2><h3 id="å‡†å¤‡å·¥ä½œ"><a href="#å‡†å¤‡å·¥ä½œ" class="headerlink" title="å‡†å¤‡å·¥ä½œ"></a>å‡†å¤‡å·¥ä½œ</h3><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> t1(id <span class="hljs-type">INT</span>(<span class="hljs-number">10</span>) AUTO_INCREMENT,content <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">100</span>) <span class="hljs-keyword">NULL</span> , <span class="hljs-keyword">PRIMARY KEY</span> (id));<br><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> t2(id <span class="hljs-type">INT</span>(<span class="hljs-number">10</span>) AUTO_INCREMENT,content <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">100</span>) <span class="hljs-keyword">NULL</span> , <span class="hljs-keyword">PRIMARY KEY</span> (id));<br><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> t3(id <span class="hljs-type">INT</span>(<span class="hljs-number">10</span>) AUTO_INCREMENT,content <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">100</span>) <span class="hljs-keyword">NULL</span> , <span class="hljs-keyword">PRIMARY KEY</span> (id));<br><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> t4(id <span class="hljs-type">INT</span>(<span class="hljs-number">10</span>) AUTO_INCREMENT,content <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">100</span>) <span class="hljs-keyword">NULL</span> , <span class="hljs-keyword">PRIMARY KEY</span> (id));<br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> t1(content) <span class="hljs-keyword">VALUES</span>(CONCAT(<span class="hljs-string">&#x27;t1_&#x27;</span>,FLOOR(<span class="hljs-number">1</span>+RAND()*<span class="hljs-number">1000</span>)));<br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> t2(content) <span class="hljs-keyword">VALUES</span>(CONCAT(<span class="hljs-string">&#x27;t2_&#x27;</span>,FLOOR(<span class="hljs-number">1</span>+RAND()*<span class="hljs-number">1000</span>)));<br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> t3(content) <span class="hljs-keyword">VALUES</span>(CONCAT(<span class="hljs-string">&#x27;t3_&#x27;</span>,FLOOR(<span class="hljs-number">1</span>+RAND()*<span class="hljs-number">1000</span>)));<br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> t4(content) <span class="hljs-keyword">VALUES</span>(CONCAT(<span class="hljs-string">&#x27;t4_&#x27;</span>,FLOOR(<span class="hljs-number">1</span>+RAND()*<span class="hljs-number">1000</span>)));<span class="hljs-keyword">Copy</span><br></code></pre></td></tr></table></figure><h3 id="idï¼šè¡¨çš„è¯»å–é¡ºåº"><a href="#idï¼šè¡¨çš„è¯»å–é¡ºåº" class="headerlink" title="idï¼šè¡¨çš„è¯»å–é¡ºåº"></a>idï¼šè¡¨çš„è¯»å–é¡ºåº</h3><p>idæ˜¯selectæŸ¥è¯¢çš„åºåˆ—å·ï¼ŒåŒ…å«ä¸€ç»„æ•°å­—ï¼Œè¡¨ç¤ºæŸ¥è¯¢ä¸­æ‰§è¡Œselectå­å¥æˆ–æ“ä½œè¡¨çš„é¡ºåº</p><ul><li><p><strong>idç›¸åŒ</strong>ï¼šæ‰§è¡Œé¡ºåºä¸º <strong>ä»ä¸Šè‡³ä¸‹æ‰§è¡Œ</strong></p><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mipsasm">EXPLAIN SELECT * FROM <span class="hljs-built_in">t1</span>, <span class="hljs-built_in">t2</span>, <span class="hljs-built_in">t3</span> WHERE <span class="hljs-built_in">t1</span>.id = <span class="hljs-built_in">t2</span>.id <span class="hljs-keyword">AND </span><span class="hljs-built_in">t2</span>.id = <span class="hljs-built_in">t3</span>.id<span class="hljs-comment">;Copy</span><br></code></pre></td></tr></table></figure><p><a href="https://nyimapicture.oss-cn-beijing.aliyuncs.com/img/20200815173157.png"><img src="/mysql2.assets/20200815173157.png" alt="img"></a></p><p>æŸ¥è¯¢æ—¶ï¼Œè¡¨çš„åŠ è½½<strong>é¡ºåºä¸ºt1, t2, t3</strong></p></li><li><p><strong>idä¸åŒ</strong>ï¼šæ‰§è¡Œé¡ºåºä¸º <strong>idå¤§çš„å…ˆæ‰§è¡Œ</strong></p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-keyword">EXPLAIN</span> <span class="hljs-keyword">SELECT</span> t2.id <span class="hljs-keyword">FROM</span> t2 <span class="hljs-keyword">WHERE</span> t2.id = <br>(<span class="hljs-keyword">SELECT</span> t1.id <span class="hljs-keyword">FROM</span> t1 <span class="hljs-keyword">WHERE</span> t1.id = <br>(<span class="hljs-keyword">SELECT</span> t3.id <span class="hljs-keyword">FROM</span> t3)<br>);<span class="hljs-keyword">Copy</span><br></code></pre></td></tr></table></figure><p><a href="https://nyimapicture.oss-cn-beijing.aliyuncs.com/img/20200815174216.png"><img src="/mysql2.assets/20200815174216.png" alt="img"></a></p><p>æŸ¥è¯¢æ—¶ï¼Œè¡¨çš„åŠ è½½<strong>é¡ºåºä¸ºt3, t1, t2</strong></p></li><li><p><strong>idç›¸åŒåˆä¸åŒ</strong>ï¼š æ‰§è¡Œé¡ºåºä¸º</p><ul><li>idä¸åŒæ—¶ï¼Œå€¼è¾ƒå¤§çš„å…ˆæ‰§è¡Œ</li><li>idç›¸åŒæ—¶ï¼Œä»ä¸Šè‡³ä¸‹æ‰§è¡Œ</li></ul><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mipsasm">EXPLAIN SELECT * FROM (SELECT <span class="hljs-built_in">t3</span>.id FROM <span class="hljs-built_in">t3</span>) <span class="hljs-built_in">s1</span>, <span class="hljs-built_in">t2</span> WHERE <span class="hljs-built_in">s1</span>.id = <span class="hljs-built_in">t2</span>.id<span class="hljs-comment">;Copy</span><br></code></pre></td></tr></table></figure><p><a href="https://nyimapicture.oss-cn-beijing.aliyuncs.com/img/20200815174740.png"><img src="/mysql2.assets/20200815174740.png" alt="img"></a></p><p>æŸ¥è¯¢æ—¶ï¼Œè¡¨çš„<strong>åŠ è½½é¡ºåºä¸ºt3, t2, è™šè¡¨dervied2</strong></p><ul><li>å…¶ä¸­dervied<strong>2</strong> çš„ 2ï¼Œä¸º id &#x3D; 2</li></ul></li></ul><h3 id="select-typeï¼šæŸ¥è¯¢æ“ä½œç±»å‹"><a href="#select-typeï¼šæŸ¥è¯¢æ“ä½œç±»å‹" class="headerlink" title="select_typeï¼šæŸ¥è¯¢æ“ä½œç±»å‹"></a>select_typeï¼šæŸ¥è¯¢æ“ä½œç±»å‹</h3><p>select_typeä»£è¡¨<strong>æŸ¥è¯¢çš„ç±»å‹</strong>ï¼Œä¸»è¦æ˜¯ç”¨äºåŒºåˆ«<strong>æ™®é€šæŸ¥è¯¢ã€è”åˆæŸ¥è¯¢ã€å­æŸ¥è¯¢ç­‰</strong>çš„å¤æ‚æŸ¥è¯¢</p><table><thead><tr><th>select_type å±æ€§</th><th>å«ä¹‰</th></tr></thead><tbody><tr><td>SIMPLE</td><td>ç®€å•çš„ select æŸ¥è¯¢,æŸ¥è¯¢ä¸­<strong>ä¸åŒ…å«å­æŸ¥è¯¢æˆ–è€… UNION</strong></td></tr><tr><td>PRIMARY</td><td>æŸ¥è¯¢ä¸­è‹¥åŒ…å«ä»»ä½•å¤æ‚çš„å­éƒ¨åˆ†ï¼Œ<strong>æœ€å¤–å±‚</strong>æŸ¥è¯¢åˆ™è¢«æ ‡è®°ä¸º Primary</td></tr><tr><td>DERIVED</td><td>åœ¨ FROM åˆ—è¡¨ä¸­åŒ…å«çš„å­æŸ¥è¯¢è¢«æ ‡è®°ä¸º DERIVED(è¡ç”Ÿ) MySQL ä¼šé€’å½’æ‰§è¡Œè¿™äº›å­æŸ¥è¯¢, æŠŠç»“æœæ”¾åœ¨ä¸´æ—¶è¡¨é‡Œ</td></tr><tr><td>SUBQUERY</td><td>åœ¨SELECTæˆ–WHEREåˆ—è¡¨ä¸­åŒ…å«äº†<strong>å­æŸ¥è¯¢</strong></td></tr><tr><td>DEPEDENT SUBQUERY</td><td>åœ¨SELECTæˆ–WHEREåˆ—è¡¨ä¸­åŒ…å«äº†å­æŸ¥è¯¢,<strong>å­æŸ¥è¯¢åŸºäºå¤–å±‚</strong></td></tr><tr><td>UNCACHEABLE SUBQUERY</td><td><strong>æ— æ³•ä½¿ç”¨ç¼“å­˜</strong>çš„å­æŸ¥è¯¢</td></tr><tr><td>UNION</td><td>è‹¥ç¬¬äºŒä¸ªSELECTå‡ºç°åœ¨UNIONä¹‹åï¼Œåˆ™è¢«æ ‡è®°ä¸ºUNIONï¼› è‹¥UNIONåŒ…å«åœ¨FROMå­å¥çš„å­æŸ¥è¯¢ä¸­,å¤–å±‚SELECTå°†è¢«æ ‡è®°ä¸ºï¼šDERIVED</td></tr><tr><td>UNION RESULT</td><td>ä»UNIONè¡¨<strong>è·å–ç»“æœ</strong>çš„SELECT</td></tr></tbody></table><ul><li><p>SUBQUERY å’Œ DEPEDENT SUBQUERY</p></li><li><p>éƒ½æ˜¯ WHERE åé¢çš„æ¡ä»¶ï¼ŒSUBQUERY æ˜¯å•ä¸ªå€¼ï¼ˆ&#x3D;ï¼‰ï¼ŒDEPEDENT SUBQUERY æ˜¯ä¸€ç»„å€¼ï¼ˆINï¼‰</p></li><li><p>UNCACHEABLE SUBQUERY</p></li><li><p>å½“ä½¿ç”¨äº†**@@æ¥å¼•ç”¨ç³»ç»Ÿå˜é‡**çš„æ—¶å€™ï¼Œä¸ä¼šä½¿ç”¨ç¼“å­˜</p></li><li><p>UNION å’Œ UNION RESULT</p><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs n1ql"><span class="hljs-keyword">EXPLAIN</span> <span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> t_emp a <span class="hljs-keyword">LEFT</span> <span class="hljs-keyword">JOIN</span>  t_dept b <span class="hljs-keyword">ON</span> a.deptId = b.id <span class="hljs-keyword">WHERE</span> b.id <span class="hljs-keyword">IS</span> <span class="hljs-literal">NULL</span><br><span class="hljs-keyword">UNION</span><br><span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> t_emp a <span class="hljs-keyword">RIGHT</span> <span class="hljs-keyword">JOIN</span>  t_dept b <span class="hljs-keyword">ON</span> a.deptId = b.id <span class="hljs-keyword">WHERE</span> a.deptId <span class="hljs-keyword">IS</span> <span class="hljs-literal">NULL</span>;Copy<br></code></pre></td></tr></table></figure><p><a href="https://nyimapicture.oss-cn-beijing.aliyuncs.com/img/20200816135453.png"><img src="/mysql2.assets/20200816135453.png" alt="img"></a></p></li></ul><h3 id="tableï¼šè¡¨çš„æ¥æº"><a href="#tableï¼šè¡¨çš„æ¥æº" class="headerlink" title="tableï¼šè¡¨çš„æ¥æº"></a>tableï¼šè¡¨çš„æ¥æº</h3><p>tableè¡¨ç¤ºè¿™ä¸ªæ•°æ®æ˜¯åŸºäºå“ªå¼ è¡¨çš„</p><h3 id="typeï¼šè®¿é—®ç±»å‹"><a href="#typeï¼šè®¿é—®ç±»å‹" class="headerlink" title="typeï¼šè®¿é—®ç±»å‹"></a>typeï¼šè®¿é—®ç±»å‹</h3><p>type æ˜¯æŸ¥è¯¢çš„è®¿é—®ç±»å‹ã€‚<strong>æ˜¯è¾ƒä¸ºé‡è¦çš„ä¸€ä¸ªæŒ‡æ ‡</strong>ï¼Œç»“æœå€¼ä»æœ€å¥½åˆ°æœ€åä¾æ¬¡æ˜¯ï¼š</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-keyword">system</span> &gt; const &gt; eq_ref &gt; <span class="hljs-keyword">ref</span> &gt; fulltext &gt; ref_or_null &gt; index_merge &gt; unique_subquery &gt; index_subquery &gt; range &gt; <span class="hljs-keyword">index</span> &gt; <span class="hljs-keyword">all</span><br><br><span class="hljs-comment">--å¸¸è§çš„é¡ºåºä¸º</span><br><span class="hljs-keyword">system</span> &gt; const &gt; eq_ref &gt; <span class="hljs-keyword">ref</span> &gt; range &gt; <span class="hljs-keyword">index</span> &gt; allCopy<br></code></pre></td></tr></table></figure><p>ä¸€èˆ¬æ¥è¯´ï¼Œå¾—ä¿è¯æŸ¥è¯¢<strong>è‡³å°‘è¾¾åˆ° range çº§åˆ«</strong>ï¼Œæœ€å¥½èƒ½è¾¾åˆ° ref</p><table><thead><tr><th>ç±»å‹å</th><th>å«ä¹‰</th></tr></thead><tbody><tr><td>SYSTEM</td><td>è¡¨åªæœ‰ä¸€è¡Œè®°å½•ï¼ˆç­‰äºç³»ç»Ÿè¡¨ï¼‰ï¼Œè¿™æ˜¯ const ç±»å‹çš„ç‰¹åˆ—ï¼Œå¹³æ—¶ä¸ä¼šå‡ºç°ï¼Œè¿™ä¸ªä¹Ÿ<strong>å¯ä»¥å¿½ç•¥ä¸è®¡</strong></td></tr><tr><td>CONST</td><td>è¡¨ç¤º<strong>é€šè¿‡ç´¢å¼•ä¸€æ¬¡å°±æ‰¾åˆ°äº†</strong>,const ç”¨äºæ¯”è¾ƒ primary key æˆ–è€… unique ç´¢å¼•ã€‚å› ä¸ºåªåŒ¹é…ä¸€è¡Œæ•°æ®ï¼Œæ‰€ä»¥å¾ˆå¿«ã€‚å¦‚å°†ä¸»é”®ç½®äº where åˆ—è¡¨ä¸­ï¼ŒMySQL å°±èƒ½å°†è¯¥æŸ¥è¯¢è½¬æ¢ä¸ºä¸€ä¸ªå¸¸é‡</td></tr><tr><td>EQ_REF</td><td>å”¯ä¸€æ€§ç´¢å¼•æ‰«æï¼Œå¯¹äºæ¯ä¸ªç´¢å¼•é”®ï¼Œ<strong>è¡¨ä¸­åªæœ‰ä¸€æ¡è®°å½•ä¸ä¹‹åŒ¹é…</strong>ã€‚å¸¸è§äºä¸»é”®æˆ–å”¯ä¸€ç´¢å¼•æ‰«æ</td></tr><tr><td>REF</td><td>éå”¯ä¸€æ€§ç´¢å¼•æ‰«æï¼Œè¿”å›åŒ¹é…æŸä¸ªå•ç‹¬å€¼çš„æ‰€æœ‰è¡Œã€‚æœ¬è´¨ä¸Šä¹Ÿæ˜¯ä¸€ç§ç´¢å¼•è®¿é—®ï¼Œå®ƒè¿”å›æ‰€æœ‰åŒ¹é…æŸä¸ªå•ç‹¬å€¼çš„è¡Œï¼Œ ç„¶è€Œï¼Œå®ƒ<strong>å¯èƒ½ä¼šæ‰¾åˆ°å¤šä¸ªç¬¦åˆæ¡ä»¶çš„è¡Œ</strong>ï¼Œæ‰€ä»¥ä»–åº”è¯¥å±äºæŸ¥æ‰¾å’Œæ‰«æçš„æ··åˆä½“</td></tr><tr><td>RANGE</td><td>åªæ£€ç´¢ç»™å®š<strong>èŒƒå›´</strong>çš„è¡Œ,ä½¿ç”¨ä¸€ä¸ªç´¢å¼•æ¥é€‰æ‹©è¡Œã€‚key åˆ—æ˜¾ç¤ºä½¿ç”¨äº†å“ªä¸ªç´¢å¼•ä¸€èˆ¬å°±æ˜¯åœ¨ä½ çš„ where è¯­å¥ä¸­å‡ºç° äº† betweenã€&lt;ã€&gt;ã€in ç­‰çš„æŸ¥è¯¢è¿™ç§èŒƒå›´æ‰«æç´¢å¼•æ‰«ææ¯”å…¨è¡¨æ‰«æè¦å¥½ï¼Œå› ä¸ºå®ƒåªéœ€è¦å¼€å§‹äºç´¢å¼•çš„æŸä¸€ç‚¹ï¼Œè€Œ ç»“æŸè¯­å¦ä¸€ç‚¹ï¼Œä¸ç”¨æ‰«æå…¨éƒ¨ç´¢å¼•</td></tr><tr><td>INDEX</td><td>å‡ºç°indexæ˜¯sqlä½¿ç”¨äº†ç´¢å¼•ä½†æ˜¯æ²¡ç”¨é€šè¿‡ç´¢å¼•è¿›è¡Œè¿‡æ»¤ï¼Œä¸€èˆ¬æ˜¯ä½¿ç”¨äº†è¦†ç›–ç´¢å¼•æˆ–è€…æ˜¯åˆ©ç”¨ç´¢å¼•è¿›è¡Œäº†æ’åºåˆ†ç»„</td></tr><tr><td>ALL</td><td>Full Table Scanï¼Œå°†éå†å…¨è¡¨ä»¥æ‰¾åˆ°åŒ¹é…çš„è¡Œ</td></tr></tbody></table><ul><li><p>REF</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-comment">--å…¶ä¸­deptIdä¸ºç´¢å¼•ï¼Œä¸”ç”¨åˆ°äº†&#x27; = &#x27;</span><br><span class="hljs-keyword">EXPLAIN</span> <span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> t_emp <span class="hljs-keyword">WHERE</span> deptId = <span class="hljs-number">3</span>;<span class="hljs-keyword">Copy</span><br></code></pre></td></tr></table></figure><p><a href="https://nyimapicture.oss-cn-beijing.aliyuncs.com/img/20200816165420.png"><img src="/mysql2.assets/20200816165420.png" alt="img"></a></p></li><li><p>RANGE</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-comment">--å…¶ä¸­deptIdä¸ºç´¢å¼•ï¼Œç”¨åˆ°äº† BETWEEN...AND... , IN , &gt; , &lt; ç­‰èŒƒå›´æŸ¥è¯¢</span><br><span class="hljs-keyword">EXPLAIN</span> <span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> t_emp <span class="hljs-keyword">WHERE</span> deptId &gt; <span class="hljs-number">3</span>;<span class="hljs-keyword">Copy</span><br></code></pre></td></tr></table></figure><p><a href="https://nyimapicture.oss-cn-beijing.aliyuncs.com/img/20200816213631.png"><img src="/mysql2.assets/20200816213631.png" alt="img"></a></p></li><li><p>INDEX</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-comment">--å…¶ä¸­deptIdä¸ºç´¢å¼•ï¼ŒæŸ¥æ‰¾äº†æ•´å¼ è¡¨æ—¶ï¼Œç”¨åˆ°äº†ç´¢å¼•</span><br><span class="hljs-keyword">EXPLAIN</span> <span class="hljs-keyword">SELECT</span> deptId <span class="hljs-keyword">FROM</span> t_emp;<span class="hljs-keyword">Copy</span><br></code></pre></td></tr></table></figure><p><a href="https://nyimapicture.oss-cn-beijing.aliyuncs.com/img/20200816165651.png"><img src="/mysql2.assets/20200816165651.png" alt="img"></a></p></li><li><p>ALL</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-comment">--å…¶ä¸­nameä¸ºéç´¢å¼•</span><br><span class="hljs-keyword">EXPLAIN</span> <span class="hljs-keyword">SELECT</span> <span class="hljs-type">name</span> <span class="hljs-keyword">FROM</span> t_emp;<span class="hljs-keyword">Copy</span><br></code></pre></td></tr></table></figure><p><a href="https://nyimapicture.oss-cn-beijing.aliyuncs.com/img/20200816165722.png"><img src="/mysql2.assets/20200816165722.png" alt="img"></a></p></li></ul><h3 id="possible-keyï¼šå¯èƒ½ç”¨åˆ°çš„ç´¢å¼•"><a href="#possible-keyï¼šå¯èƒ½ç”¨åˆ°çš„ç´¢å¼•" class="headerlink" title="possible_keyï¼šå¯èƒ½ç”¨åˆ°çš„ç´¢å¼•"></a>possible_keyï¼šå¯èƒ½ç”¨åˆ°çš„ç´¢å¼•</h3><p>æ˜¾ç¤º<strong>å¯èƒ½</strong>åº”ç”¨åœ¨è¿™å¼ è¡¨ä¸­çš„ç´¢å¼•ï¼Œä¸€ä¸ªæˆ–å¤šä¸ªã€‚æŸ¥è¯¢æ¶‰åŠåˆ°çš„å­—æ®µä¸Šè‹¥å­˜åœ¨ç´¢å¼•ï¼Œåˆ™è¯¥ç´¢å¼•å°†è¢«åˆ—å‡ºï¼Œä½†<strong>ä¸ä¸€ å®šè¢«æŸ¥è¯¢å®é™…ä½¿ç”¨</strong></p><h3 id="keyï¼šå®é™…ä½¿ç”¨çš„ç´¢å¼•"><a href="#keyï¼šå®é™…ä½¿ç”¨çš„ç´¢å¼•" class="headerlink" title="keyï¼šå®é™…ä½¿ç”¨çš„ç´¢å¼•"></a>keyï¼šå®é™…ä½¿ç”¨çš„ç´¢å¼•</h3><p><strong>å®é™…ä½¿ç”¨çš„ç´¢å¼•</strong>ã€‚å¦‚æœä¸ºNULLï¼Œåˆ™æ²¡æœ‰ä½¿ç”¨ç´¢å¼•</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-keyword">EXPLAIN</span> <span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> t_emp <span class="hljs-keyword">WHERE</span> id = <span class="hljs-number">1</span> <span class="hljs-keyword">AND</span> deptId = <span class="hljs-number">1</span>;<span class="hljs-keyword">Copy</span><br></code></pre></td></tr></table></figure><p><a href="https://nyimapicture.oss-cn-beijing.aliyuncs.com/img/20200816172950.png"><img src="/mysql2.assets/20200816172950.png" alt="img"></a></p><p>MySQLæ¨æµ‹å¯èƒ½ç”¨åˆ°ä¸»é”®ç´¢å¼•å’Œidx_dept_idç´¢å¼•ï¼Œå®é™…ä¸Šç”¨åˆ°çš„æ˜¯ä¸»é”®ç´¢å¼•</p><h4 id="è¦†ç›–ç´¢å¼•"><a href="#è¦†ç›–ç´¢å¼•" class="headerlink" title="è¦†ç›–ç´¢å¼•"></a><strong>è¦†ç›–ç´¢å¼•</strong></h4><p>å½“æŸ¥æ‰¾çš„å­—æ®µä¸å»ºç«‹çš„ç´¢å¼•çš„åŒ¹é…ï¼ˆæŸ¥è¯¢çš„å­—æ®µéƒ½æ˜¯ç´¢å¼•ï¼Œä½†ä¸éœ€è¦å…¨æ˜¯ç´¢å¼•ï¼‰æ—¶ï¼Œä¼šå‘ç”Ÿè¦†ç›–ç´¢å¼•ã€‚MySQLæ¨æµ‹ä½¿ç”¨çš„ç´¢å¼•ä¸ºNULLï¼Œè€Œå®é™…ä¸Šä¼šä½¿ç”¨ç´¢å¼•</p><p>æœ‰ä»¥ä¸‹ä¸¤ç§è§£é‡Š</p><ul><li>selectçš„æ•°æ®åˆ—<strong>åªç”¨ä»ç´¢å¼•ä¸­å°±èƒ½å¤Ÿå–å¾—</strong>ï¼Œä¸å¿…ä»æ•°æ®è¡¨ä¸­è¯»å–ï¼Œæ¢å¥è¯è¯´<strong>æŸ¥è¯¢åˆ—è¦è¢«æ‰€ä½¿ç”¨çš„ç´¢å¼•è¦†ç›–</strong></li><li>ç´¢å¼•æ˜¯é«˜æ•ˆæ‰¾åˆ°è¡Œçš„ä¸€ä¸ªæ–¹æ³•ï¼Œå½“èƒ½é€šè¿‡æ£€ç´¢ç´¢å¼•å°±å¯ä»¥è¯»å–æƒ³è¦çš„æ•°æ®ï¼Œé‚£å°±ä¸éœ€è¦å†åˆ°æ•°æ®è¡¨ä¸­è¯»å–è¡Œäº†ã€‚å¦‚æœä¸€ä¸ªç´¢å¼•åŒ…å«äº†ï¼ˆæˆ–è¦†ç›–äº†ï¼‰æ»¡è¶³æŸ¥è¯¢è¯­å¥ä¸­å­—æ®µä¸æ¡ä»¶çš„æ•°æ®å°±å«åšè¦†ç›–ç´¢å¼•</li></ul><p>æ³¨æ„ï¼šè¦ä½¿ç”¨è¦†ç›–ç´¢å¼•ï¼Œåˆ™<strong>åªå–å‡ºéœ€è¦çš„åˆ—</strong>ï¼ˆè¢«ä»¤ä¸ºç´¢å¼•ï¼‰ï¼Œ<strong>ä¸è¦</strong>ä½¿ç”¨ SELECT *</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-comment">--å…¶ä¸­idå’ŒdeptIdéƒ½ä¸ºç´¢å¼•</span><br><span class="hljs-keyword">EXPLAIN</span> <span class="hljs-keyword">SELECT</span> id, deptId <span class="hljs-keyword">FROM</span> t_emp;<span class="hljs-keyword">Copy</span><br></code></pre></td></tr></table></figure><p><a href="https://nyimapicture.oss-cn-beijing.aliyuncs.com/img/20200816173253.png"><img src="/mysql2.assets/20200816173253.png" alt="img"></a></p><p><a href="https://nyimapicture.oss-cn-beijing.aliyuncs.com/img/20200816173228.png"><img src="/mysql2.assets/20200816173228.png" alt="img"></a></p><h3 id="key-lenï¼šç´¢å¼•ä½¿ç”¨å­—èŠ‚æ•°"><a href="#key-lenï¼šç´¢å¼•ä½¿ç”¨å­—èŠ‚æ•°" class="headerlink" title="key_lenï¼šç´¢å¼•ä½¿ç”¨å­—èŠ‚æ•°"></a>key_lenï¼šç´¢å¼•ä½¿ç”¨å­—èŠ‚æ•°</h3><p>è¡¨ç¤ºç´¢å¼•ä¸­ä½¿ç”¨çš„å­—èŠ‚æ•°ï¼Œå¯é€šè¿‡è¯¥åˆ—è®¡ç®—æŸ¥è¯¢ä¸­ä½¿ç”¨çš„ç´¢å¼•çš„é•¿åº¦ã€‚ key_len å­—æ®µèƒ½å¤Ÿå¸®ä½ æ£€æŸ¥æ˜¯å¦å……åˆ†çš„åˆ©ç”¨ä¸Šäº†ç´¢å¼•</p><p><strong>ken_len è¶Šé•¿ï¼Œè¯´æ˜ç´¢å¼•ä½¿ç”¨çš„è¶Šå……åˆ†</strong></p><h3 id="refï¼šæ˜¾ç¤ºè¢«ä½¿ç”¨çš„ç´¢å¼•çš„å…·ä½“ä¿¡æ¯"><a href="#refï¼šæ˜¾ç¤ºè¢«ä½¿ç”¨çš„ç´¢å¼•çš„å…·ä½“ä¿¡æ¯" class="headerlink" title="refï¼šæ˜¾ç¤ºè¢«ä½¿ç”¨çš„ç´¢å¼•çš„å…·ä½“ä¿¡æ¯"></a>refï¼šæ˜¾ç¤ºè¢«ä½¿ç”¨çš„ç´¢å¼•çš„å…·ä½“ä¿¡æ¯</h3><p>refæ˜¾ç¤ºç´¢å¼•çš„å“ªä¸€åˆ—è¢«ä½¿ç”¨äº†ï¼Œå¦‚æœå¯èƒ½çš„è¯ï¼Œå¯ä»¥æ˜¯ä¸€ä¸ªå¸¸æ•°ã€‚å“ªäº›åˆ—æˆ–å¸¸é‡è¢«ç”¨äºæŸ¥æ‰¾ç´¢å¼•åˆ—ä¸Šçš„å€¼</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-keyword">EXPLAIN</span> <span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> t_dept, t_emp <span class="hljs-keyword">WHERE</span> t_emp.deptId = t_dept.id;<span class="hljs-keyword">Copy</span><br></code></pre></td></tr></table></figure><p><a href="https://nyimapicture.oss-cn-beijing.aliyuncs.com/img/20200816194305.png"><img src="/mysql2.assets/20200816194305.png" alt="img"></a></p><h3 id="rowsï¼šè¢«æŸ¥è¯¢çš„è¡Œæ•°"><a href="#rowsï¼šè¢«æŸ¥è¯¢çš„è¡Œæ•°" class="headerlink" title="rowsï¼šè¢«æŸ¥è¯¢çš„è¡Œæ•°"></a>rowsï¼šè¢«æŸ¥è¯¢çš„è¡Œæ•°</h3><p>rows åˆ—æ˜¾ç¤º MySQL è®¤ä¸ºå®ƒæ‰§è¡ŒæŸ¥è¯¢æ—¶å¿…é¡»æ£€æŸ¥çš„è¡Œæ•°ã€‚<strong>è¶Šå°‘è¶Šå¥½ï¼</strong></p><p><strong>éªŒè¯</strong></p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-comment">--å…ˆåˆ é™¤ç´¢å¼•</span><br><span class="hljs-keyword">DROP</span> <span class="hljs-keyword">INDEX</span> idx_dept_id <span class="hljs-keyword">ON</span> t_emp;<br><br><span class="hljs-comment">--æŸ¥æ‰¾</span><br><span class="hljs-keyword">EXPLAIN</span> <span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> t_dept, t_emp <span class="hljs-keyword">WHERE</span> t_emp.deptId = t_dept.id;<br><br><span class="hljs-comment">--å†åˆ›å»ºç´¢å¼•</span><br><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">INDEX</span> idx_dept_id <span class="hljs-keyword">ON</span> t_emp(deptId);<br><br><span class="hljs-comment">--æŸ¥æ‰¾</span><br><span class="hljs-keyword">EXPLAIN</span> <span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> t_dept, t_emp <span class="hljs-keyword">WHERE</span> t_emp.deptId = t_dept.id;<span class="hljs-keyword">Copy</span><br></code></pre></td></tr></table></figure><p><strong>ç»“æœå¦‚ä¸‹</strong></p><ul><li><p>æœªä½¿ç”¨ç´¢å¼•æ—¶ï¼Œä¸€å…±éœ€è¦æŸ¥è¯¢26è¡Œ</p><p><a href="https://nyimapicture.oss-cn-beijing.aliyuncs.com/img/20200816195241.png"><img src="/mysql2.assets/20200816195241.png" alt="img"></a></p></li><li><p>ä½¿ç”¨ç´¢å¼•åï¼Œä¸€å…±éœ€è¦æŸ¥è¯¢6è¡Œ</p><p><a href="https://nyimapicture.oss-cn-beijing.aliyuncs.com/img/20200816195401.png"><img src="/mysql2.assets/20200816195401.png" alt="img"></a></p></li></ul><h3 id="Extraï¼šé¢å¤–é‡è¦ä¿¡æ¯"><a href="#Extraï¼šé¢å¤–é‡è¦ä¿¡æ¯" class="headerlink" title="Extraï¼šé¢å¤–é‡è¦ä¿¡æ¯"></a>Extraï¼šé¢å¤–é‡è¦ä¿¡æ¯</h3><p>å…¶ä»–çš„é¢å¤–<strong>é‡è¦</strong>çš„ä¿¡æ¯</p><ul><li><p><strong>Using filesort</strong>ï¼šä½¿ç”¨å¤–éƒ¨ç´¢å¼•æ’åºï¼ˆæœªä½¿ç”¨ç”¨æˆ·åˆ›å»ºçš„ç´¢å¼•ï¼‰</p><ul><li>è¯´æ˜ mysql ä¼šå¯¹æ•°æ®ä½¿ç”¨ä¸€ä¸ªå¤–éƒ¨çš„ç´¢å¼•æ’åºï¼Œè€Œä¸æ˜¯æŒ‰ç…§è¡¨å†…çš„ç´¢å¼•é¡ºåºè¿›è¡Œè¯»å–ã€‚MySQL ä¸­æ— æ³•åˆ©ç”¨ç´¢å¼• å®Œæˆçš„æ’åºæ“ä½œç§°ä¸ºâ€œæ–‡ä»¶æ’åºâ€</li><li>å‡ºç° Using filesort <strong>è¯´æ˜SQLè¯­å¥è®¾è®¡çš„ä¸å¥½</strong>ï¼Œ<strong>æ²¡æœ‰æŒ‰ç…§åˆ›å»ºçš„ç´¢å¼•è¿›è¡Œæ’åº</strong>ï¼Œæˆ–è€…<strong>æœªæŒ‰ç…§ç´¢å¼•æŒ‡å®šçš„é¡ºåºè¿›è¡Œæ’åº</strong></li></ul><p><strong>æ¼”ç¤º</strong></p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-comment">--åˆ›å»ºç¬¦åˆç´¢å¼•</span><br><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">INDEX</span> idx_emp_empno_age <span class="hljs-keyword">ON</span> t_emp(empno, age);<br><br><span class="hljs-comment">--è¿›è¡ŒæŸ¥è¯¢æ“ä½œï¼Œé€šè¿‡ age å­—æ®µè¿›è¡Œæ’åºï¼ˆæœªæŒ‰ç…§å¤åˆç´¢å¼•é¡ºåºè¿›è¡Œæ’åºæŸ¥è¯¢ï¼‰</span><br><span class="hljs-keyword">EXPLAIN</span> <span class="hljs-keyword">SELECT</span> empno <span class="hljs-keyword">FROM</span> t_emp <span class="hljs-keyword">WHERE</span> empno &gt;<span class="hljs-number">100002</span> <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> age;<br><br><span class="hljs-comment">--è¿›è¡ŒæŸ¥è¯¢æ“ä½œï¼Œé€šè¿‡ empno æˆ–è€… empno + age å­—æ®µè¿›è¡Œæ’åºï¼ˆæŒ‰ç…§å¤åˆç´¢å¼•é¡ºåºè¿›è¡Œæ’åºæŸ¥è¯¢ï¼‰</span><br><span class="hljs-keyword">EXPLAIN</span> <span class="hljs-keyword">SELECT</span> empno <span class="hljs-keyword">FROM</span> t_emp <span class="hljs-keyword">WHERE</span> empno &gt;<span class="hljs-number">100002</span> <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> empno;<br><span class="hljs-keyword">EXPLAIN</span> <span class="hljs-keyword">SELECT</span> empno <span class="hljs-keyword">FROM</span> t_emp <span class="hljs-keyword">WHERE</span> empno &gt;<span class="hljs-number">100002</span> <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> empno, age;<span class="hljs-keyword">Copy</span><br></code></pre></td></tr></table></figure><p><strong>ç»“æœ</strong></p><p><a href="https://nyimapicture.oss-cn-beijing.aliyuncs.com/img/20200816205145.png"><img src="/mysql2.assets/20200816205145.png" alt="img"></a></p><p><a href="https://nyimapicture.oss-cn-beijing.aliyuncs.com/img/20200816205226.png"><img src="/mysql2.assets/20200816205226.png" alt="img"></a></p><p><a href="https://nyimapicture.oss-cn-beijing.aliyuncs.com/img/20200816205112.png"><img src="/mysql2.assets/20200816205112.png" alt="img"></a></p></li><li><p><strong>Using temporary</strong></p><ul><li>ä½¿äº†ç”¨ä¸´æ—¶è¡¨ä¿å­˜ä¸­é—´ç»“æœ,MySQL åœ¨å¯¹æŸ¥è¯¢ç»“æœæ’åºæ—¶ä½¿ç”¨ä¸´æ—¶è¡¨ã€‚<strong>å¸¸è§äºæ’åº order by å’Œåˆ†ç»„æŸ¥è¯¢ group by</strong></li><li>å‡ºç° Using temporary <strong>è¯´æ˜SQLè¯­å¥è®¾è®¡çš„éå¸¸ä¸å¥½</strong>ï¼Œå¯èƒ½æ˜¯å› ä¸ºæ²¡æœ‰æŒ‰ç…§é¡ºåºä½¿ç”¨å¤åˆç´¢å¼•</li></ul><p><strong>æ¼”ç¤º</strong></p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-comment">--è¿›è¡ŒæŸ¥è¯¢æ“ä½œï¼Œ é€šè¿‡ age å­—æ®µè¿›è¡Œåˆ†ç»„ï¼ˆæœªæŒ‰ç…§å¤åˆç´¢å¼•é¡ºåºè¿›è¡Œæ’åºæŸ¥è¯¢ï¼‰</span><br><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">INDEX</span> idx_emp_empno_age <span class="hljs-keyword">ON</span> t_emp(empno, age);<br><br><span class="hljs-comment">----è¿›è¡ŒæŸ¥è¯¢æ“ä½œï¼Œé€šè¿‡ empno æˆ–è€… empno + age å­—æ®µè¿›è¡Œåˆ†ç»„ï¼ˆæŒ‰ç…§å¤åˆç´¢å¼•é¡ºåºè¿›è¡Œæ’åºæŸ¥è¯¢ï¼‰</span><br><span class="hljs-keyword">EXPLAIN</span> <span class="hljs-keyword">SELECT</span> empno <span class="hljs-keyword">FROM</span> t_emp <span class="hljs-keyword">WHERE</span> empno &gt;<span class="hljs-number">100002</span> <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> empno;<br><span class="hljs-keyword">EXPLAIN</span> <span class="hljs-keyword">SELECT</span> empno <span class="hljs-keyword">FROM</span> t_emp <span class="hljs-keyword">WHERE</span> empno &gt;<span class="hljs-number">100002</span> <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> empno, age;<span class="hljs-keyword">Copy</span><br></code></pre></td></tr></table></figure><p><strong>ç»“æœ</strong></p><p><a href="https://nyimapicture.oss-cn-beijing.aliyuncs.com/img/20200816210843.png"><img src="/mysql2.assets/20200816210843.png" alt="img"></a></p><p><a href="https://nyimapicture.oss-cn-beijing.aliyuncs.com/img/20200816210908.png"><img src="/mysql2.assets/20200816210908.png" alt="img"></a></p></li></ul><p><strong>é‡è¦ç»“è®º</strong></p><p>å¦‚æœåˆ›å»ºäº†<strong>å¤åˆç´¢å¼•</strong>ï¼Œä¸€å®šè¦<strong>æŒ‰ç…§å¤åˆç´¢å¼•çš„é¡ºåºæ¥ä½¿ç”¨</strong>ï¼Œå¦åˆ™ä¼šä½¿å¾—æ€§èƒ½å¤§å¹…ä¸‹é™</p><ul><li><p><strong>Using index</strong></p><ul><li>Using index ä»£è¡¨è¡¨ç¤ºç›¸åº”çš„ select æ“ä½œä¸­ä½¿ç”¨äº†<strong>è¦†ç›–ç´¢å¼•</strong>(Covering Index)ï¼Œè¯¦è§<a href="https://nyimac.gitee.io/2020/08/16/MySQL%E9%AB%98%E7%BA%A7/#%E8%A6%86%E7%9B%96%E7%B4%A2%E5%BC%95">keyï¼šå®é™…ç”¨åˆ°çš„ç´¢å¼•â€”â€”è¦†ç›–ç´¢å¼•</a>ï¼Œé¿å…è®¿é—®äº†è¡¨çš„æ•°æ®è¡Œï¼Œ<strong>æ•ˆç‡ä¸é”™</strong>ï¼</li><li>å¦‚æœåŒæ—¶å‡ºç° using whereï¼Œè¡¨æ˜<strong>ç´¢å¼•è¢«ç”¨æ¥æ‰§è¡Œç´¢å¼•é”®å€¼çš„æŸ¥æ‰¾</strong></li><li>å¦‚æœæ²¡æœ‰åŒæ—¶å‡ºç° using whereï¼Œè¡¨æ˜<strong>ç´¢å¼•åªæ˜¯ç”¨æ¥è¯»å–æ•°æ®</strong>è€Œéåˆ©ç”¨ç´¢å¼•æ‰§è¡ŒæŸ¥æ‰¾ã€‚</li></ul><p><strong>æ¼”ç¤º</strong></p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-comment">--æŸ¥è¯¢ age å­—æ®µï¼Œä½¿ç”¨äº†WHERE</span><br><span class="hljs-keyword">EXPLAIN</span> <span class="hljs-keyword">SELECT</span> age <span class="hljs-keyword">FROM</span> t_emp <span class="hljs-keyword">WHERE</span> age &gt;<span class="hljs-number">100000</span>;<br><br><span class="hljs-comment">--æŸ¥è¯¢ empno å’Œ age å­—æ®µï¼Œæœªä½¿ç”¨WHERE</span><br><span class="hljs-keyword">EXPLAIN</span> <span class="hljs-keyword">SELECT</span> empno, age <span class="hljs-keyword">FROM</span> t_emp;<br><br><span class="hljs-comment">--æŸ¥è¯¢ empno å’Œ name å­—æ®µ ï¼ˆnameå­—æ®µä¸æ˜¯ç´¢å¼•ï¼‰</span><br><span class="hljs-keyword">EXPLAIN</span> <span class="hljs-keyword">SELECT</span> empno, <span class="hljs-type">name</span> <span class="hljs-keyword">FROM</span> t_emp;<span class="hljs-keyword">Copy</span><br></code></pre></td></tr></table></figure><p><strong>ç»“æœ</strong></p><p><a href="https://nyimapicture.oss-cn-beijing.aliyuncs.com/img/20200816212055.png"><img src="/mysql2.assets/20200816212055.png" alt="img"></a></p><p><a href="https://nyimapicture.oss-cn-beijing.aliyuncs.com/img/20200816212129.png"><img src="/mysql2.assets/20200816212129.png" alt="img"></a></p><p><a href="https://nyimapicture.oss-cn-beijing.aliyuncs.com/img/20200816212243.png"><img src="/mysql2.assets/20200816212243.png" alt="img"></a></p></li><li><p>Using where</p><ul><li>è¡¨æ˜ä½¿ç”¨äº† where è¿‡æ»¤</li></ul></li><li><p>Using join buffer</p><ul><li>ä½¿ç”¨äº†è¿æ¥ç¼“å­˜</li></ul></li><li><p>impossible where</p><ul><li>where å­å¥çš„å€¼æ€»æ˜¯ falseï¼Œä¸èƒ½ç”¨æ¥è·å–ä»»ä½•å…ƒç»„</li></ul></li><li><p>select tables optimized away</p><ul><li>åœ¨æ²¡æœ‰ GROUP BY å­å¥çš„æƒ…å†µä¸‹ï¼ŒåŸºäºç´¢å¼•ä¼˜åŒ– MIN&#x2F;MAX æ“ä½œæˆ–è€…å¯¹äº MyISAM å­˜å‚¨å¼•æ“ä¼˜åŒ– COUNT(*)æ“ ä½œï¼Œä¸å¿…ç­‰åˆ°æ‰§è¡Œé˜¶æ®µå†è¿›è¡Œè®¡ç®—ï¼ŒæŸ¥è¯¢æ‰§è¡Œè®¡åˆ’ç”Ÿæˆçš„é˜¶æ®µå³å®Œæˆä¼˜åŒ–</li></ul></li></ul><h1 id="äº”ã€å•è¡¨æŸ¥è¯¢ä¼˜åŒ–"><a href="#äº”ã€å•è¡¨æŸ¥è¯¢ä¼˜åŒ–" class="headerlink" title="äº”ã€å•è¡¨æŸ¥è¯¢ä¼˜åŒ–"></a>äº”ã€å•è¡¨æŸ¥è¯¢ä¼˜åŒ–</h1><h2 id="1ã€å…¨å€¼åŒ¹é…å¾ˆå¿«æ·"><a href="#1ã€å…¨å€¼åŒ¹é…å¾ˆå¿«æ·" class="headerlink" title="1ã€å…¨å€¼åŒ¹é…å¾ˆå¿«æ·"></a>1ã€å…¨å€¼åŒ¹é…å¾ˆå¿«æ·</h2><p><strong>SQLè¯­å¥</strong></p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-comment">--å»ºç«‹ç¬¦åˆç´¢å¼•ï¼ˆage, deptId, nameï¼‰</span><br><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">INDEX</span> idx_emp_ade <span class="hljs-keyword">ON</span> t_emp(age, deptId, <span class="hljs-type">NAME</span>);<br><br><span class="hljs-comment">--æŸ¥æ‰¾</span><br><span class="hljs-keyword">EXPLAIN</span> <span class="hljs-keyword">SELECT</span> empno <span class="hljs-keyword">FROM</span> t_emp <span class="hljs-keyword">WHERE</span> age = <span class="hljs-number">90</span>;<br><span class="hljs-keyword">EXPLAIN</span> <span class="hljs-keyword">SELECT</span> empno <span class="hljs-keyword">FROM</span> t_emp <span class="hljs-keyword">WHERE</span> age = <span class="hljs-number">90</span> <span class="hljs-keyword">AND</span> deptId = <span class="hljs-number">1</span>;<br><span class="hljs-keyword">EXPLAIN</span> <span class="hljs-keyword">SELECT</span> empno <span class="hljs-keyword">FROM</span> t_emp <span class="hljs-keyword">WHERE</span> age = <span class="hljs-number">90</span> <span class="hljs-keyword">AND</span> deptId = <span class="hljs-number">1</span> <span class="hljs-keyword">AND</span> <span class="hljs-type">name</span> = <span class="hljs-string">&#x27;é£æ¸…æ‰¬&#x27;</span>;<br><br><span class="hljs-comment">--å’Œä¸Šä¸€æ¡SQLè¯­å¥ä¸­WHEREåå­—æ®µçš„é¡ºåºä¸åŒï¼Œä½†æ˜¯ä¸å½±å“æŸ¥è¯¢ç»“æœ</span><br><span class="hljs-keyword">EXPLAIN</span> <span class="hljs-keyword">SELECT</span> empno <span class="hljs-keyword">FROM</span> t_emp <span class="hljs-keyword">WHERE</span> deptId = <span class="hljs-number">1</span> <span class="hljs-keyword">AND</span> <span class="hljs-type">name</span> = <span class="hljs-string">&#x27;é£æ¸…æ‰¬&#x27;</span> <span class="hljs-keyword">AND</span> age = <span class="hljs-number">90</span>;<span class="hljs-keyword">Copy</span><br></code></pre></td></tr></table></figure><p><strong>å¯¹åº”ç»“æœ</strong></p><p><a href="https://nyimapicture.oss-cn-beijing.aliyuncs.com/img/20200817164200.png"><img src="/mysql2.assets/20200817164200.png" alt="img"></a></p><p><a href="https://nyimapicture.oss-cn-beijing.aliyuncs.com/img/20200817164226.png"><img src="/mysql2.assets/20200817164226.png" alt="img"></a></p><p><a href="https://nyimapicture.oss-cn-beijing.aliyuncs.com/img/20200817164241.png"><img src="/mysql2.assets/20200817164241.png" alt="img"></a></p><p><a href="https://nyimapicture.oss-cn-beijing.aliyuncs.com/img/20200817164506.png"><img src="/mysql2.assets/20200817164506.png" alt="img"></a></p><p>å¯ä»¥çœ‹åˆ°ï¼Œ<strong>å¤åˆç´¢å¼•éƒ½è¢«ç”¨åˆ°äº†ï¼Œå¹¶ä¸”SQLä¸­æŸ¥è¯¢å­—æ®µçš„é¡ºåºï¼Œè·Ÿä½¿ç”¨ç´¢å¼•ä¸­å­—æ®µçš„é¡ºåºï¼Œæ²¡æœ‰å…³ç³»</strong>ã€‚ä¼˜åŒ–å™¨ä¼šåœ¨ä¸å½±å“ SQL æ‰§è¡Œç»“æœçš„å‰æä¸‹ï¼Œè‡ªåŠ¨åœ°ä¼˜åŒ–</p><p><strong>ç»“è®ºï¼šå…¨èŒåŒ¹é…æˆ‘æœ€çˆ±æŒ‡çš„æ˜¯ï¼ŒæŸ¥è¯¢çš„å­—æ®µæŒ‰ç…§é¡ºåºåœ¨ç´¢å¼•ä¸­éƒ½å¯ä»¥åŒ¹é…åˆ°</strong></p><h2 id="2ã€æœ€ä½³å·¦å‰ç¼€æ³•åˆ™"><a href="#2ã€æœ€ä½³å·¦å‰ç¼€æ³•åˆ™" class="headerlink" title="2ã€æœ€ä½³å·¦å‰ç¼€æ³•åˆ™"></a>2ã€æœ€ä½³å·¦å‰ç¼€æ³•åˆ™</h2><p><strong>SQLè¯­å¥</strong></p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-comment">--å…ˆåˆ é™¤ä¹‹å‰åˆ›å»ºçš„å•å€¼ç´¢å¼•</span><br><span class="hljs-keyword">DROP</span> <span class="hljs-keyword">INDEX</span> idx_dept_id <span class="hljs-keyword">ON</span> t_emp; <br><br><span class="hljs-comment">--æŸ¥è¯¢ï¼ŒæœªæŒ‰ç…§æœ€ä½³å·¦å‰ç¼€æ³•åˆ™</span><br><span class="hljs-keyword">EXPLAIN</span> <span class="hljs-keyword">SELECT</span> empno <span class="hljs-keyword">FROM</span> t_emp <span class="hljs-keyword">WHERE</span> deptId = <span class="hljs-number">1</span>;<br><span class="hljs-keyword">EXPLAIN</span> <span class="hljs-keyword">SELECT</span> empno <span class="hljs-keyword">FROM</span> t_emp <span class="hljs-keyword">WHERE</span> deptId = <span class="hljs-number">1</span> <span class="hljs-keyword">AND</span> <span class="hljs-type">name</span> = <span class="hljs-string">&#x27;é£æ¸…æ‰¬&#x27;</span>;<br><br><span class="hljs-comment">--æŸ¥è¯¢ï¼Œéƒ¨åˆ†æŒ‰ç…§æœ€ä½³å·¦å‰ç¼€æ³•åˆ™ï¼ˆageå­—æ®µå’Œå¤åˆç´¢å¼•åŒ¹é…ï¼Œä½†nameæ²¡æœ‰ï¼‰</span><br><span class="hljs-keyword">EXPLAIN</span> <span class="hljs-keyword">SELECT</span> empno <span class="hljs-keyword">FROM</span> t_emp <span class="hljs-keyword">WHERE</span>  age = <span class="hljs-number">90</span> <span class="hljs-keyword">AND</span> <span class="hljs-type">name</span> = <span class="hljs-string">&#x27;é£æ¸…æ‰¬&#x27;</span>;<br><br><span class="hljs-comment">--æŸ¥è¯¢ï¼Œå®Œå…¨æŒ‰ç…§æœ€ä½³å·¦å‰ç¼€æ³•åˆ™</span><br><span class="hljs-keyword">EXPLAIN</span> <span class="hljs-keyword">SELECT</span> empno <span class="hljs-keyword">FROM</span> t_emp <span class="hljs-keyword">WHERE</span> age = <span class="hljs-number">90</span> <span class="hljs-keyword">AND</span> deptId = <span class="hljs-number">1</span>;<br><span class="hljs-keyword">EXPLAIN</span> <span class="hljs-keyword">SELECT</span> empno <span class="hljs-keyword">FROM</span> t_emp <span class="hljs-keyword">WHERE</span> age = <span class="hljs-number">90</span> <span class="hljs-keyword">AND</span> deptId = <span class="hljs-number">1</span> <span class="hljs-keyword">AND</span> <span class="hljs-type">name</span> = <span class="hljs-string">&#x27;é£æ¸…æ‰¬&#x27;</span>;<span class="hljs-keyword">Copy</span><br></code></pre></td></tr></table></figure><p><strong>å¯¹åº”ç»“æœ</strong></p><p><a href="https://nyimapicture.oss-cn-beijing.aliyuncs.com/img/20200817164932.png"><img src="/mysql2.assets/20200817164932.png" alt="img"></a></p><p><a href="https://nyimapicture.oss-cn-beijing.aliyuncs.com/img/20200817164948.png"><img src="/mysql2.assets/20200817164948.png" alt="img"></a></p><p><a href="https://nyimapicture.oss-cn-beijing.aliyuncs.com/img/20200817165100.png"><img src="/mysql2.assets/20200817165100.png" alt="img"></a></p><p><a href="https://nyimapicture.oss-cn-beijing.aliyuncs.com/img/20200817164226.png"><img src="/mysql2.assets/20200817164226.png" alt="img"></a></p><p><a href="https://nyimapicture.oss-cn-beijing.aliyuncs.com/img/20200817164506.png"><img src="/mysql2.assets/20200817164506.png" alt="img"></a></p><p>å¯ä»¥çœ‹åˆ°ï¼ŒæŸ¥è¯¢<strong>å­—æ®µä¸ç´¢å¼•å­—æ®µé¡ºåºçš„ä¸åŒä¼šå¯¼è‡´ï¼Œç´¢å¼•æ— æ³•å……åˆ†ä½¿ç”¨ï¼Œç”šè‡³ç´¢å¼•å¤±æ•ˆ</strong></p><p><strong>åŸå› </strong>ï¼šä½¿ç”¨å¤åˆç´¢å¼•ï¼Œéœ€è¦<strong>éµå¾ªæœ€ä½³å·¦å‰ç¼€æ³•åˆ™</strong>ï¼Œå³å¦‚æœç´¢å¼•äº†å¤šåˆ—ï¼Œè¦éµå®ˆæœ€å·¦å‰ç¼€æ³•åˆ™ã€‚æŒ‡çš„æ˜¯æŸ¥è¯¢ä»ç´¢å¼•çš„<strong>æœ€å·¦å‰åˆ—å¼€å§‹å¹¶ä¸”ä¸è·³è¿‡ç´¢å¼•ä¸­çš„åˆ—</strong></p><p><strong>ç»“è®ºï¼šè¿‡æ»¤æ¡ä»¶è¦ä½¿ç”¨ç´¢å¼•å¿…é¡»æŒ‰ç…§ç´¢å¼•å»ºç«‹æ—¶çš„é¡ºåºï¼Œä¾æ¬¡æ»¡è¶³ï¼Œä¸€æ—¦è·³è¿‡æŸä¸ªå­—æ®µï¼Œç´¢å¼•åé¢çš„å­—æ®µéƒ½æ— æ³•è¢«ä½¿ç”¨</strong></p><h2 id="3ã€ç´¢å¼•åˆ—ä¸Šä¸è®¡ç®—"><a href="#3ã€ç´¢å¼•åˆ—ä¸Šä¸è®¡ç®—" class="headerlink" title="3ã€ç´¢å¼•åˆ—ä¸Šä¸è®¡ç®—"></a>3ã€ç´¢å¼•åˆ—ä¸Šä¸è®¡ç®—</h2><p>ä¸åœ¨ç´¢å¼•åˆ—ä¸Šåšä»»ä½•æ“ä½œï¼ˆè®¡ç®—ã€å‡½æ•°ã€(è‡ªåŠ¨ or æ‰‹åŠ¨)ç±»å‹è½¬æ¢ï¼‰ï¼Œ<strong>å¯èƒ½ä¼šå¯¼è‡´ç´¢å¼•å¤±æ•ˆè€Œè½¬å‘å…¨è¡¨æ‰«æ</strong></p><p><strong>SQLè¯­å¥</strong></p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-comment">--ç›´æ¥æŸ¥è¯¢</span><br><span class="hljs-keyword">EXPLAIN</span> <span class="hljs-keyword">SELECT</span> empno <span class="hljs-keyword">FROM</span> t_emp <span class="hljs-keyword">WHERE</span> age = <span class="hljs-number">90</span> <span class="hljs-keyword">AND</span> deptId = <span class="hljs-number">1</span> <span class="hljs-keyword">AND</span> <span class="hljs-type">NAME</span> = <span class="hljs-string">&#x27;é£æ¸…æ‰¬&#x27;</span>;<br><br><span class="hljs-comment">--ä½¿ç”¨MySQLå‡½æ•°æŸ¥è¯¢</span><br><span class="hljs-keyword">EXPLAIN</span> <span class="hljs-keyword">SELECT</span> empno <span class="hljs-keyword">FROM</span> t_emp <span class="hljs-keyword">WHERE</span> LEFT(age,<span class="hljs-number">2</span>) = <span class="hljs-number">90</span> <span class="hljs-keyword">AND</span> deptId = <span class="hljs-number">1</span> <span class="hljs-keyword">AND</span> <span class="hljs-type">name</span> = <span class="hljs-string">&#x27;é£æ¸…æ‰¬&#x27;</span>;<span class="hljs-keyword">Copy</span><br></code></pre></td></tr></table></figure><p><strong>å¯¹åº”ç»“æœ</strong></p><p><a href="https://nyimapicture.oss-cn-beijing.aliyuncs.com/img/20200817170139.png"><img src="/mysql2.assets/20200817170139.png" alt="img"></a></p><p><a href="https://nyimapicture.oss-cn-beijing.aliyuncs.com/img/20200817170522.png"><img src="/mysql2.assets/20200817170522.png" alt="img"></a></p><p>å¯ä»¥çœ‹å‡ºï¼Œå½“ageå­—æ®µä½¿ç”¨äº†leftå‡½æ•°ä»¥åï¼Œ<strong>å¯¼è‡´ç´¢å¼•å®Œå…¨å¤±æ•ˆ</strong></p><p><strong>ç»“è®ºï¼šç­‰å·å·¦è¾¹æ— è®¡ç®—</strong></p><h2 id="4ã€èŒƒå›´ä¹‹åå…¨å¤±æ•ˆ"><a href="#4ã€èŒƒå›´ä¹‹åå…¨å¤±æ•ˆ" class="headerlink" title="4ã€èŒƒå›´ä¹‹åå…¨å¤±æ•ˆ"></a>4ã€èŒƒå›´ä¹‹åå…¨å¤±æ•ˆ</h2><p><strong>SQLè¯­å¥</strong></p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-comment">--èŒƒå›´æŸ¥è¯¢</span><br><span class="hljs-keyword">EXPLAIN</span> <span class="hljs-keyword">SELECT</span> empno <span class="hljs-keyword">FROM</span> t_emp <span class="hljs-keyword">WHERE</span> age &gt; <span class="hljs-number">50</span> <span class="hljs-keyword">AND</span> deptId = <span class="hljs-number">1</span> <span class="hljs-keyword">AND</span> <span class="hljs-type">name</span> = <span class="hljs-string">&#x27;é£æ¸…æ‰¬&#x27;</span>;<br><span class="hljs-keyword">EXPLAIN</span> <span class="hljs-keyword">SELECT</span> empno <span class="hljs-keyword">FROM</span> t_emp <span class="hljs-keyword">WHERE</span> age = <span class="hljs-number">50</span> <span class="hljs-keyword">AND</span> deptId &gt; <span class="hljs-number">1</span> <span class="hljs-keyword">AND</span> <span class="hljs-type">NAME</span> = <span class="hljs-string">&#x27;é£æ¸…æ‰¬&#x27;</span>;<br><br><span class="hljs-comment">--æœªä½¿ç”¨èŒƒå›´æŸ¥è¯¢</span><br><span class="hljs-keyword">EXPLAIN</span> <span class="hljs-keyword">SELECT</span> empno <span class="hljs-keyword">FROM</span> t_emp <span class="hljs-keyword">WHERE</span> age = <span class="hljs-number">50</span> <span class="hljs-keyword">AND</span> deptId = <span class="hljs-number">1</span> <span class="hljs-keyword">AND</span> <span class="hljs-type">name</span> = <span class="hljs-string">&#x27;é£æ¸…æ‰¬&#x27;</span>;<span class="hljs-keyword">Copy</span><br></code></pre></td></tr></table></figure><p><strong>å¯¹åº”ç»“æœ</strong></p><p><a href="https://nyimapicture.oss-cn-beijing.aliyuncs.com/img/20200817171833.png"><img src="/mysql2.assets/20200817171833.png" alt="img"></a></p><p><a href="https://nyimapicture.oss-cn-beijing.aliyuncs.com/img/20200817172159.png"><img src="/mysql2.assets/20200817172159.png" alt="img"></a></p><p><a href="https://nyimapicture.oss-cn-beijing.aliyuncs.com/img/20200817171903.png"><img src="/mysql2.assets/20200817171903.png" alt="img"></a></p><p>å¯ä»¥çœ‹å‡ºï¼Œå½“å¯¹ageå­—æ®µä½¿ç”¨èŒƒå›´æŸ¥è¯¢åï¼Œä½¿å¾—èŒƒå›´åé¢çš„ç´¢å¼•å¤±æ•ˆäº†</p><p><strong>å»ºè®®ï¼š</strong>å°†å¯èƒ½åšèŒƒå›´æŸ¥è¯¢çš„å­—æ®µçš„ç´¢å¼•é¡ºåº<strong>æ”¾åœ¨æœ€å</strong></p><p><strong>ç»“è®ºï¼šä½¿ç”¨èŒƒå›´æŸ¥è¯¢åï¼Œå¦‚æœèŒƒå›´å†…çš„è®°å½•è¿‡å¤šï¼Œä¼šå¯¼è‡´ç´¢å¼•å¤±æ•ˆ</strong>ï¼Œå› ä¸ºä»è‡ªå®šä¹‰ç´¢å¼•æ˜ å°„åˆ°ä¸»é”®ç´¢å¼•éœ€è¦è€—è´¹å¤ªå¤šçš„æ—¶é—´ï¼Œåè€Œä¸å¦‚å…¨è¡¨æ‰«ææ¥å¾—å¿«</p><h2 id="5ã€è¦†ç›–ç´¢å¼•å¤šä½¿ç”¨"><a href="#5ã€è¦†ç›–ç´¢å¼•å¤šä½¿ç”¨" class="headerlink" title="5ã€è¦†ç›–ç´¢å¼•å¤šä½¿ç”¨"></a>5ã€è¦†ç›–ç´¢å¼•å¤šä½¿ç”¨</h2><p><strong>SQLè¯­å¥</strong></p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-comment">--æŸ¥è¯¢æ‰€æœ‰å­—æ®µ</span><br><span class="hljs-keyword">EXPLAIN</span> <span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> t_dept <span class="hljs-keyword">WHERE</span> id = <span class="hljs-number">1</span>;<br><br><span class="hljs-comment">--æŸ¥è¯¢ç´¢å¼•å­—æ®µ</span><br><span class="hljs-keyword">EXPLAIN</span> <span class="hljs-keyword">SELECT</span> id <span class="hljs-keyword">FROM</span> t_dept <span class="hljs-keyword">WHERE</span> id = <span class="hljs-number">1</span>;<span class="hljs-keyword">Copy</span><br></code></pre></td></tr></table></figure><p><strong>å¯¹åº”ç»“æœ</strong></p><p><a href="https://nyimapicture.oss-cn-beijing.aliyuncs.com/img/20200817173338.png"><img src="/mysql2.assets/20200817173338.png" alt="img"></a></p><p><a href="https://nyimapicture.oss-cn-beijing.aliyuncs.com/img/20200817173314.png"><img src="/mysql2.assets/20200817173314.png" alt="img"></a></p><p><strong>ç»“è®ºï¼šä½¿ç”¨è¦†ç›–ç´¢å¼•ï¼ˆUsing indexï¼‰ä¼šæé«˜æ£€ç´¢æ•ˆç‡</strong></p><h2 id="6ã€ä½¿ç”¨ä¸ç­‰ä¼šå¤±æ•ˆ"><a href="#6ã€ä½¿ç”¨ä¸ç­‰ä¼šå¤±æ•ˆ" class="headerlink" title="6ã€ä½¿ç”¨ä¸ç­‰ä¼šå¤±æ•ˆ"></a>6ã€ä½¿ç”¨ä¸ç­‰ä¼šå¤±æ•ˆ</h2><p>åœ¨ä½¿ç”¨<strong>ä¸ç­‰äº(!&#x3D; æˆ–è€…&lt;&gt;)æ—¶</strong>ï¼Œæœ‰æ—¶ä¼šæ— æ³•ä½¿ç”¨ç´¢å¼•ä¼šå¯¼è‡´å…¨è¡¨æ‰«æ</p><p><strong>SQLè¯­å¥</strong></p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-comment">--SQLè¯­å¥ä¸­æœ‰ä¸ç­‰äº</span><br><span class="hljs-keyword">EXPLAIN</span> <span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> t_emp <span class="hljs-keyword">WHERE</span> age != <span class="hljs-number">90</span>;<br><span class="hljs-keyword">EXPLAIN</span> <span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> t_emp <span class="hljs-keyword">WHERE</span> age &lt;&gt; <span class="hljs-number">90</span>;<br><br><span class="hljs-comment">--SQLè¯­å¥ä¸­æ²¡æœ‰ä¸ç­‰äº</span><br><span class="hljs-keyword">EXPLAIN</span> <span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> t_emp <span class="hljs-keyword">WHERE</span> age = <span class="hljs-number">90</span>;<span class="hljs-keyword">Copy</span><br></code></pre></td></tr></table></figure><p><strong>å¯¹åº”ç»“æœ</strong></p><p><a href="https://nyimapicture.oss-cn-beijing.aliyuncs.com/img/20200817180448.png"><img src="/mysql2.assets/20200817180448.png" alt="img"></a></p><p><a href="https://nyimapicture.oss-cn-beijing.aliyuncs.com/img/20200817180505.png"><img src="/mysql2.assets/20200817180505.png" alt="img"></a></p><p><a href="https://nyimapicture.oss-cn-beijing.aliyuncs.com/img/20200817180521.png"><img src="/mysql2.assets/20200817180521.png" alt="img"></a></p><p><strong>ç»“è®ºï¼šå°½é‡ä¸è¦ä½¿ç”¨ä¸ç­‰äº</strong></p><h2 id="7ã€ä½¿ç”¨NULLå€¼è¦å°å¿ƒ"><a href="#7ã€ä½¿ç”¨NULLå€¼è¦å°å¿ƒ" class="headerlink" title="7ã€ä½¿ç”¨NULLå€¼è¦å°å¿ƒ"></a>7ã€ä½¿ç”¨NULLå€¼è¦å°å¿ƒ</h2><p>åœ¨ä½¿ç”¨</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">IS</span> <span class="hljs-keyword">NULL</span><br>æˆ–è€…<br><span class="hljs-keyword">IS</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span><span class="hljs-keyword">Copy</span><br></code></pre></td></tr></table></figure><p>æ—¶ï¼Œå¯èƒ½ä¼šå¯¼è‡´ç´¢å¼•å¤±æ•ˆ</p><p>ä½†æ˜¯å¦‚æœ<strong>å…è®¸å­—æ®µä¸ºç©º</strong>ï¼Œåˆ™</p><ul><li>IS NULL ä¸ä¼šå¯¼è‡´ç´¢å¼•å¤±æ•ˆ</li><li>IS NOT NULL ä¼šå¯¼è‡´ç´¢å¼•å¤±æ•ˆ</li></ul><p><a href="https://nyimapicture.oss-cn-beijing.aliyuncs.com/img/20200817181044.png"><img src="/mysql2.assets/20200817181044.png" alt="img"></a></p><p><strong>SQLè¯­å¥</strong></p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-keyword">EXPLAIN</span> <span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> t_emp <span class="hljs-keyword">WHERE</span> age <span class="hljs-keyword">IS</span> <span class="hljs-keyword">NULL</span>;<br><br><span class="hljs-keyword">EXPLAIN</span> <span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> t_emp <span class="hljs-keyword">WHERE</span> age <span class="hljs-keyword">IS</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>;<span class="hljs-keyword">Copy</span><br></code></pre></td></tr></table></figure><p><strong>å¯¹åº”ç»“æœ</strong></p><p><a href="https://nyimapicture.oss-cn-beijing.aliyuncs.com/img/20200817181116.png"><img src="/mysql2.assets/20200817181116.png" alt="img"></a></p><p><a href="https://nyimapicture.oss-cn-beijing.aliyuncs.com/img/20200817181137.png"><img src="/mysql2.assets/20200817181137.png" alt="img"></a></p><h2 id="8ã€æ¨¡ç³ŠæŸ¥è¯¢åŠ å³è¾¹"><a href="#8ã€æ¨¡ç³ŠæŸ¥è¯¢åŠ å³è¾¹" class="headerlink" title="8ã€æ¨¡ç³ŠæŸ¥è¯¢åŠ å³è¾¹"></a>8ã€æ¨¡ç³ŠæŸ¥è¯¢åŠ å³è¾¹</h2><p>è¦ä½¿ç”¨æ¨¡ç³ŠæŸ¥è¯¢æ—¶ï¼Œ<strong>ç™¾åˆ†å·æœ€å¥½åŠ åœ¨å³è¾¹ï¼Œè€Œä¸”è¿›è¡Œæ¨¡ç³ŠæŸ¥è¯¢çš„å­—æ®µå¿…é¡»æ˜¯å•å€¼ç´¢å¼•</strong></p><p><strong>SQLè¯­å¥</strong></p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-comment">--åˆ›å»ºå•å€¼ç´¢å¼•</span><br><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">INDEX</span> idx_emp_name <span class="hljs-keyword">ON</span> t_emp(<span class="hljs-type">NAME</span>);<br><br><span class="hljs-comment">--è¿›è¡Œæ¨¡ç³ŠæŸ¥è¯¢</span><br><span class="hljs-keyword">EXPLAIN</span> <span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> t_emp <span class="hljs-keyword">WHERE</span> <span class="hljs-type">name</span> <span class="hljs-keyword">LIKE</span> <span class="hljs-string">&#x27;%é£&#x27;</span>;<br><span class="hljs-keyword">EXPLAIN</span> <span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> t_emp <span class="hljs-keyword">WHERE</span> <span class="hljs-type">name</span> <span class="hljs-keyword">LIKE</span> <span class="hljs-string">&#x27;é£%&#x27;</span>;<br><span class="hljs-keyword">EXPLAIN</span> <span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> t_emp <span class="hljs-keyword">WHERE</span> <span class="hljs-type">name</span> <span class="hljs-keyword">LIKE</span> <span class="hljs-string">&#x27;%é£%&#x27;</span>;<span class="hljs-keyword">Copy</span><br></code></pre></td></tr></table></figure><p><strong>å¯¹åº”ç»“æœ</strong></p><p><a href="https://nyimapicture.oss-cn-beijing.aliyuncs.com/img/20200817183416.png"><img src="/mysql2.assets/20200817183416.png" alt="img"></a></p><p><a href="https://nyimapicture.oss-cn-beijing.aliyuncs.com/img/20200817183401.png"><img src="/mysql2.assets/20200817183401.png" alt="img"></a></p><p><a href="https://nyimapicture.oss-cn-beijing.aliyuncs.com/img/20200817183416.png"><img src="/mysql2.assets/20200817183416.png" alt="img"></a></p><p>å¯ä»¥çœ‹å‡ºï¼Œå¯¹ç´¢å¼•ä½¿ç”¨æ¨¡ç³ŠæŸ¥è¯¢æ—¶ï¼Œ<strong>åªæœ‰å½“ç™¾åˆ†å·åœ¨å³è¾¹ï¼Œç´¢å¼•ä¸ºå•å€¼ç´¢å¼•ä¸”æ¨¡ç³ŠæŸ¥è¯¢è¯­å¥åœ¨æœ€å³è¾¹æ—¶ï¼Œç´¢å¼•æ‰ä¼šç”Ÿæ•ˆ</strong></p><p>å…¶ä»–æƒ…å†µå‡å¤±æ•ˆäº†</p><p><strong>ä½†æ˜¯</strong>æœ‰æ—¶å¿…é¡»ä½¿ç”¨å…¶ä»–ç±»å‹çš„æ¨¡ç³ŠæŸ¥è¯¢ï¼Œè¿™æ—¶å°±éœ€è¦ç”¨<strong>è¦†ç›–ç´¢å¼•</strong>æ¥è§£å†³ç´¢å¼•å¤±æ•ˆçš„é—®é¢˜</p><p><strong>SQLè¯­å¥</strong></p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-keyword">EXPLAIN</span> <span class="hljs-keyword">SELECT</span> <span class="hljs-type">name</span> <span class="hljs-keyword">FROM</span> t_emp <span class="hljs-keyword">WHERE</span> <span class="hljs-type">name</span> <span class="hljs-keyword">LIKE</span> <span class="hljs-string">&#x27;%é£&#x27;</span>;<br><span class="hljs-keyword">EXPLAIN</span> <span class="hljs-keyword">SELECT</span> <span class="hljs-type">name</span> <span class="hljs-keyword">FROM</span> t_emp <span class="hljs-keyword">WHERE</span> <span class="hljs-type">name</span> <span class="hljs-keyword">LIKE</span> <span class="hljs-string">&#x27;é£%&#x27;</span>;<br><br><span class="hljs-keyword">EXPLAIN</span> <span class="hljs-keyword">SELECT</span> <span class="hljs-type">NAME</span> <span class="hljs-keyword">FROM</span> t_emp <span class="hljs-keyword">WHERE</span> <span class="hljs-type">name</span> <span class="hljs-keyword">LIKE</span> <span class="hljs-string">&#x27;%é£%&#x27;</span>;<span class="hljs-keyword">Copy</span><br></code></pre></td></tr></table></figure><p><strong>å¯¹åº”ç»“æœ</strong></p><p><a href="https://nyimapicture.oss-cn-beijing.aliyuncs.com/img/20200817183741.png"><img src="/mysql2.assets/20200817183741.png" alt="img"></a></p><p><a href="https://nyimapicture.oss-cn-beijing.aliyuncs.com/img/20200817183801.png"><img src="/mysql2.assets/20200817183801.png" alt="img"></a></p><p><a href="https://nyimapicture.oss-cn-beijing.aliyuncs.com/img/20200817183741.png"><img src="/mysql2.assets/20200817183741.png" alt="img"></a></p><p><strong>ç»“è®ºï¼šå¯¹ç´¢å¼•è¿›è¡Œæ¨¡ç³ŠæŸ¥è¯¢æ—¶ï¼Œæœ€å¥½åœ¨å³è¾¹åŠ ç™¾åˆ†å·ã€‚å¿…é¡»åœ¨å·¦è¾¹æˆ–å·¦å³åŠ ç™¾åˆ†å·æ—¶ï¼Œéœ€è¦ç”¨åˆ°è¦†ç›–ç´¢å¼•æ¥æå‡æŸ¥è¯¢æ•ˆç‡</strong></p><h2 id="9ã€å­—ç¬¦ä¸²åŠ å•å¼•å·"><a href="#9ã€å­—ç¬¦ä¸²åŠ å•å¼•å·" class="headerlink" title="9ã€å­—ç¬¦ä¸²åŠ å•å¼•å·"></a>9ã€å­—ç¬¦ä¸²åŠ å•å¼•å·</h2><p>å½“å­—æ®µä¸ºå­—ç¬¦ä¸²æ—¶ï¼ŒæŸ¥è¯¢æ—¶å¿…é¡»å¸¦ä¸Šå•å¼•å·ã€‚å¦åˆ™<strong>ä¼šå‘ç”Ÿè‡ªåŠ¨çš„ç±»å‹è½¬æ¢</strong>ï¼Œä»è€Œå‘ç”Ÿå…¨è¡¨æ‰«æ</p><p><strong>ç”¨äºæŸ¥è¯¢çš„è¡¨</strong></p><p><a href="https://nyimapicture.oss-cn-beijing.aliyuncs.com/img/20200817203952.png"><img src="/mysql2.assets/20200817203952.png" alt="img"></a></p><p><strong>å…¶ä¸­card_idå­—æ®µä¸ºvarcharç±»å‹ï¼Œä¸”è®¾ç½®äº†å•å€¼ç´¢å¼•</strong></p><p><strong>SQLè¯­å¥</strong></p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-comment">--ä½¿ç”¨äº†å•å¼•å·</span><br><span class="hljs-keyword">EXPLAIN</span> <span class="hljs-keyword">SELECT</span> card_id <span class="hljs-keyword">FROM</span> person <span class="hljs-keyword">WHERE</span> card_id = <span class="hljs-string">&#x27;1&#x27;</span>;<br><br><span class="hljs-comment">--æœªä½¿ç”¨å•å¼•å·ï¼Œå‘ç”Ÿè‡ªåŠ¨ç±»å‹è½¬æ¢</span><br><span class="hljs-keyword">EXPLAIN</span> <span class="hljs-keyword">SELECT</span> card_id <span class="hljs-keyword">FROM</span> person <span class="hljs-keyword">WHERE</span> card_id = <span class="hljs-number">1</span>;<span class="hljs-keyword">Copy</span><br></code></pre></td></tr></table></figure><p><strong>å¯¹åº”ç»“æœ</strong></p><p><a href="https://nyimapicture.oss-cn-beijing.aliyuncs.com/img/20200817204047.png"><img src="/mysql2.assets/20200817204047.png" alt="img"></a></p><p><a href="https://nyimapicture.oss-cn-beijing.aliyuncs.com/img/20200817204027.png"><img src="/mysql2.assets/20200817204027.png" alt="img"></a></p><h2 id="10ã€å°½é‡ä¸ç”¨oræŸ¥è¯¢"><a href="#10ã€å°½é‡ä¸ç”¨oræŸ¥è¯¢" class="headerlink" title="10ã€å°½é‡ä¸ç”¨oræŸ¥è¯¢"></a>10ã€å°½é‡ä¸ç”¨oræŸ¥è¯¢</h2><p>å¦‚æœä½¿ç”¨orï¼Œå¯èƒ½å¯¼è‡´ç´¢å¼•å¤±æ•ˆã€‚æ‰€ä»¥è¦å‡å°‘orçš„ä½¿ç”¨ï¼Œå¯ä»¥<strong>ä½¿ç”¨ union all æˆ–è€… union æ¥æ›¿ä»£ï¼š</strong></p><p><strong>SQLè¯­å¥</strong></p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-comment">--ä½¿ç”¨orè¿›è¡ŒæŸ¥è¯¢</span><br><span class="hljs-keyword">EXPLAIN</span> <span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> t_emp <span class="hljs-keyword">WHERE</span> age = <span class="hljs-number">90</span> <span class="hljs-keyword">OR</span> <span class="hljs-type">NAME</span> = <span class="hljs-string">&#x27;é£æ¸…æ‰¬&#x27;</span>;<span class="hljs-keyword">Copy</span><br></code></pre></td></tr></table></figure><p><strong>å¯¹åº”ç»“æœ</strong></p><p><a href="https://nyimapicture.oss-cn-beijing.aliyuncs.com/img/20200817204307.png"><img src="/mysql2.assets/20200817204307.png" alt="img"></a></p><h2 id="å£è¯€"><a href="#å£è¯€" class="headerlink" title="å£è¯€"></a>å£è¯€</h2><p>å…¨èŒåŒ¹é…æˆ‘æœ€çˆ±ï¼Œæœ€å·¦å‰ç¼€è¦éµå®ˆ</p><p>å¸¦å¤´å¤§å“¥ä¸èƒ½æ­»ï¼Œä¸­é—´å…„å¼Ÿä¸èƒ½æ–­</p><p>ç´¢å¼•åˆ—ä¸Šå°‘è®¡ç®—ï¼ŒèŒƒå›´ä¹‹åå…¨å¤±æ•ˆ</p><p>LIKE ç™¾åˆ†å†™æœ€å³ï¼Œè¦†ç›–ç´¢å¼•ä¸å†™*</p><p>ä¸ç­‰ç©ºå€¼è¿˜æœ‰ ORï¼Œç´¢å¼•å½±å“è¦æ³¨æ„</p><p>VARCHAR å¼•å·ä¸å¯ä¸¢ï¼ŒSQL ä¼˜åŒ–æœ‰è¯€çª</p><h1 id="å…­ã€å…³è”æŸ¥è¯¢ä¼˜åŒ–"><a href="#å…­ã€å…³è”æŸ¥è¯¢ä¼˜åŒ–" class="headerlink" title="å…­ã€å…³è”æŸ¥è¯¢ä¼˜åŒ–"></a>å…­ã€å…³è”æŸ¥è¯¢ä¼˜åŒ–</h1><p><strong>å»ºè¡¨è¯­å¥</strong></p><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><code class="hljs scss">CREATE <span class="hljs-selector-tag">TABLE</span> IF NOT EXISTS `class` (<br>`id` INT(<span class="hljs-number">10</span>) UNSIGNED NOT NULL AUTO_INCREMENT, `card` <span class="hljs-built_in">INT</span>(<span class="hljs-number">10</span>) UNSIGNED NOT NULL, PRIMARY KEY (`id`)<br>);<br>CREATE <span class="hljs-selector-tag">TABLE</span> IF NOT EXISTS `book` (<br>`bookid` INT(<span class="hljs-number">10</span>) UNSIGNED NOT NULL AUTO_INCREMENT, `card` <span class="hljs-built_in">INT</span>(<span class="hljs-number">10</span>) UNSIGNED NOT NULL, PRIMARY KEY (`bookid`)<br>);<br>INSERT INTO <span class="hljs-built_in">class</span>(card) <span class="hljs-built_in">VALUES</span>(FLOOR(<span class="hljs-number">1</span> + (RAND() * <span class="hljs-number">20</span>)));<br>INSERT INTO <span class="hljs-built_in">class</span>(card) <span class="hljs-built_in">VALUES</span>(FLOOR(<span class="hljs-number">1</span> + (RAND() * <span class="hljs-number">20</span>)));<br>INSERT INTO <span class="hljs-built_in">class</span>(card) <span class="hljs-built_in">VALUES</span>(FLOOR(<span class="hljs-number">1</span> + (RAND() * <span class="hljs-number">20</span>)));<br>INSERT INTO <span class="hljs-built_in">class</span>(card) <span class="hljs-built_in">VALUES</span>(FLOOR(<span class="hljs-number">1</span> + (RAND() * <span class="hljs-number">20</span>)));<br>INSERT INTO <span class="hljs-built_in">class</span>(card) <span class="hljs-built_in">VALUES</span>(FLOOR(<span class="hljs-number">1</span> + (RAND() * <span class="hljs-number">20</span>)));<br>INSERT INTO <span class="hljs-built_in">class</span>(card) <span class="hljs-built_in">VALUES</span>(FLOOR(<span class="hljs-number">1</span> + (RAND() * <span class="hljs-number">20</span>)));<br>INSERT INTO <span class="hljs-built_in">class</span>(card) <span class="hljs-built_in">VALUES</span>(FLOOR(<span class="hljs-number">1</span> + (RAND() * <span class="hljs-number">20</span>)));<br>INSERT INTO <span class="hljs-built_in">class</span>(card) <span class="hljs-built_in">VALUES</span>(FLOOR(<span class="hljs-number">1</span> + (RAND() * <span class="hljs-number">20</span>)));<br>INSERT INTO <span class="hljs-built_in">class</span>(card) <span class="hljs-built_in">VALUES</span>(FLOOR(<span class="hljs-number">1</span> + (RAND() * <span class="hljs-number">20</span>)));<br>INSERT INTO <span class="hljs-built_in">class</span>(card) <span class="hljs-built_in">VALUES</span>(FLOOR(<span class="hljs-number">1</span> + (RAND() * <span class="hljs-number">20</span>)));<br>INSERT INTO <span class="hljs-built_in">class</span>(card) <span class="hljs-built_in">VALUES</span>(FLOOR(<span class="hljs-number">1</span> + (RAND() * <span class="hljs-number">20</span>)));<br>INSERT INTO <span class="hljs-built_in">class</span>(card) <span class="hljs-built_in">VALUES</span>(FLOOR(<span class="hljs-number">1</span> + (RAND() * <span class="hljs-number">20</span>)));<br>INSERT INTO <span class="hljs-built_in">class</span>(card) <span class="hljs-built_in">VALUES</span>(FLOOR(<span class="hljs-number">1</span> + (RAND() * <span class="hljs-number">20</span>)));<br>INSERT INTO <span class="hljs-built_in">class</span>(card) <span class="hljs-built_in">VALUES</span>(FLOOR(<span class="hljs-number">1</span> + (RAND() * <span class="hljs-number">20</span>)));<br>INSERT INTO <span class="hljs-built_in">class</span>(card) <span class="hljs-built_in">VALUES</span>(FLOOR(<span class="hljs-number">1</span> + (RAND() * <span class="hljs-number">20</span>)));<br>INSERT INTO <span class="hljs-built_in">class</span>(card) <span class="hljs-built_in">VALUES</span>(FLOOR(<span class="hljs-number">1</span> + (RAND() * <span class="hljs-number">20</span>)));<br>INSERT INTO <span class="hljs-built_in">class</span>(card) <span class="hljs-built_in">VALUES</span>(FLOOR(<span class="hljs-number">1</span> + (RAND() * <span class="hljs-number">20</span>)));<br>INSERT INTO <span class="hljs-built_in">class</span>(card) <span class="hljs-built_in">VALUES</span>(FLOOR(<span class="hljs-number">1</span> + (RAND() * <span class="hljs-number">20</span>)));<br>INSERT INTO <span class="hljs-built_in">class</span>(card) <span class="hljs-built_in">VALUES</span>(FLOOR(<span class="hljs-number">1</span> + (RAND() * <span class="hljs-number">20</span>)));<br>INSERT INTO <span class="hljs-built_in">class</span>(card) <span class="hljs-built_in">VALUES</span>(FLOOR(<span class="hljs-number">1</span> + (RAND() * <span class="hljs-number">20</span>)));<br>INSERT INTO <span class="hljs-built_in">book</span>(card) <span class="hljs-built_in">VALUES</span>(FLOOR(<span class="hljs-number">1</span> + (RAND() * <span class="hljs-number">20</span>)));<br>INSERT INTO <span class="hljs-built_in">book</span>(card) <span class="hljs-built_in">VALUES</span>(FLOOR(<span class="hljs-number">1</span> + (RAND() * <span class="hljs-number">20</span>)));<br>INSERT INTO <span class="hljs-built_in">book</span>(card) <span class="hljs-built_in">VALUES</span>(FLOOR(<span class="hljs-number">1</span> + (RAND() * <span class="hljs-number">20</span>)));<br>INSERT INTO <span class="hljs-built_in">book</span>(card) <span class="hljs-built_in">VALUES</span>(FLOOR(<span class="hljs-number">1</span> + (RAND() * <span class="hljs-number">20</span>)));<br>INSERT INTO <span class="hljs-built_in">book</span>(card) <span class="hljs-built_in">VALUES</span>(FLOOR(<span class="hljs-number">1</span> + (RAND() * <span class="hljs-number">20</span>)));<br>INSERT INTO <span class="hljs-built_in">book</span>(card) <span class="hljs-built_in">VALUES</span>(FLOOR(<span class="hljs-number">1</span> + (RAND() * <span class="hljs-number">20</span>)));<br>INSERT INTO <span class="hljs-built_in">book</span>(card) <span class="hljs-built_in">VALUES</span>(FLOOR(<span class="hljs-number">1</span> + (RAND() * <span class="hljs-number">20</span>)));<br>INSERT INTO <span class="hljs-built_in">book</span>(card) <span class="hljs-built_in">VALUES</span>(FLOOR(<span class="hljs-number">1</span> + (RAND() * <span class="hljs-number">20</span>)));<br>INSERT INTO <span class="hljs-built_in">book</span>(card) <span class="hljs-built_in">VALUES</span>(FLOOR(<span class="hljs-number">1</span> + (RAND() * <span class="hljs-number">20</span>)));<br>INSERT INTO <span class="hljs-built_in">book</span>(card) <span class="hljs-built_in">VALUES</span>(FLOOR(<span class="hljs-number">1</span> + (RAND() * <span class="hljs-number">20</span>)));<br>INSERT INTO <span class="hljs-built_in">book</span>(card) <span class="hljs-built_in">VALUES</span>(FLOOR(<span class="hljs-number">1</span> + (RAND() * <span class="hljs-number">20</span>)));<br>INSERT INTO <span class="hljs-built_in">book</span>(card) <span class="hljs-built_in">VALUES</span>(FLOOR(<span class="hljs-number">1</span> + (RAND() * <span class="hljs-number">20</span>)));<br>INSERT INTO <span class="hljs-built_in">book</span>(card) <span class="hljs-built_in">VALUES</span>(FLOOR(<span class="hljs-number">1</span> + (RAND() * <span class="hljs-number">20</span>)));<br>INSERT INTO <span class="hljs-built_in">book</span>(card) <span class="hljs-built_in">VALUES</span>(FLOOR(<span class="hljs-number">1</span> + (RAND() * <span class="hljs-number">20</span>)));<br>INSERT INTO <span class="hljs-built_in">book</span>(card) <span class="hljs-built_in">VALUES</span>(FLOOR(<span class="hljs-number">1</span> + (RAND() * <span class="hljs-number">20</span>)));<br>INSERT INTO <span class="hljs-built_in">book</span>(card) <span class="hljs-built_in">VALUES</span>(FLOOR(<span class="hljs-number">1</span> + (RAND() * <span class="hljs-number">20</span>)));<br>INSERT INTO <span class="hljs-built_in">book</span>(card) <span class="hljs-built_in">VALUES</span>(FLOOR(<span class="hljs-number">1</span> + (RAND() * <span class="hljs-number">20</span>)));<br>INSERT INTO <span class="hljs-built_in">book</span>(card) <span class="hljs-built_in">VALUES</span>(FLOOR(<span class="hljs-number">1</span> + (RAND() * <span class="hljs-number">20</span>)));<br>INSERT INTO <span class="hljs-built_in">book</span>(card) <span class="hljs-built_in">VALUES</span>(FLOOR(<span class="hljs-number">1</span> + (RAND() * <span class="hljs-number">20</span>)));<br>INSERT INTO <span class="hljs-built_in">book</span>(card) <span class="hljs-built_in">VALUES</span>(FLOOR(<span class="hljs-number">1</span> + (RAND() * <span class="hljs-number">20</span>)));Copy<br></code></pre></td></tr></table></figure><h2 id="1ã€LEFT-JOINä¼˜åŒ–"><a href="#1ã€LEFT-JOINä¼˜åŒ–" class="headerlink" title="1ã€LEFT JOINä¼˜åŒ–"></a>1ã€LEFT JOINä¼˜åŒ–</h2><p><strong>SQLè¯­å¥</strong></p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-comment">--æœªå»ºç«‹ç´¢å¼•æ—¶çš„å·¦å¤–è¿æ¥æŸ¥è¯¢</span><br><span class="hljs-keyword">EXPLAIN</span> <span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> <span class="hljs-keyword">class</span> <span class="hljs-keyword">LEFT JOIN</span> book <span class="hljs-keyword">ON</span> <span class="hljs-keyword">class</span>.card = book.card;<br><br><span class="hljs-comment">--å·¦è¡¨ï¼ˆclassï¼‰å»ºç«‹ç´¢å¼•</span><br><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">INDEX</span> idx_class_card <span class="hljs-keyword">ON</span> <span class="hljs-keyword">class</span>(card);<br><br><span class="hljs-comment">--å†æ¬¡æ‰§è¡ŒæŸ¥è¯¢</span><br><span class="hljs-keyword">EXPLAIN</span> <span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> <span class="hljs-keyword">class</span> <span class="hljs-keyword">LEFT JOIN</span> book <span class="hljs-keyword">ON</span> <span class="hljs-keyword">class</span>.card = book.card;<br><br><span class="hljs-comment">--å»æ‰å·¦è¡¨ç´¢å¼•</span><br><span class="hljs-keyword">DROP</span> <span class="hljs-keyword">INDEX</span> idx_class_card <span class="hljs-keyword">ON</span> <span class="hljs-keyword">class</span>;<br><br><span class="hljs-comment">--å³è¡¨å»ºç«‹ç´¢å¼•</span><br><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">INDEX</span> idx_book_card <span class="hljs-keyword">ON</span> book(card);<br><br><span class="hljs-comment">--å†æ¬¡æ‰§è¡ŒæŸ¥è¯¢</span><br><span class="hljs-keyword">EXPLAIN</span> <span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> <span class="hljs-keyword">class</span> <span class="hljs-keyword">LEFT JOIN</span> book <span class="hljs-keyword">ON</span> <span class="hljs-keyword">class</span>.card = book.card;<span class="hljs-keyword">Copy</span><br></code></pre></td></tr></table></figure><p><strong>å¯¹åº”ç»“æœ</strong></p><p><a href="https://nyimapicture.oss-cn-beijing.aliyuncs.com/img/20200818170458.png"><img src="/mysql2.assets/20200818170458.png" alt="img"></a></p><p><a href="https://nyimapicture.oss-cn-beijing.aliyuncs.com/img/20200818170402.png"><img src="/mysql2.assets/20200818170402.png" alt="img"></a></p><p><a href="https://nyimapicture.oss-cn-beijing.aliyuncs.com/img/20200818170547.png"><img src="/mysql2.assets/20200818170547.png" alt="img"></a></p><p><strong>ç»“è®º</strong></p><ul><li>åœ¨ä¼˜åŒ–å…³è”æŸ¥è¯¢æ—¶ï¼Œåªæœ‰åœ¨<strong>è¢«é©±åŠ¨è¡¨ä¸Šå»ºç«‹ç´¢å¼•æ‰æœ‰æ•ˆ</strong></li><li>left join æ—¶ï¼Œå·¦ä¾§çš„ä¸ºé©±åŠ¨è¡¨ï¼Œ<strong>å³ä¾§ä¸ºè¢«é©±åŠ¨è¡¨</strong></li></ul><h2 id="2ã€INNER-JOINä¼˜åŒ–"><a href="#2ã€INNER-JOINä¼˜åŒ–" class="headerlink" title="2ã€INNER JOINä¼˜åŒ–"></a>2ã€INNER JOINä¼˜åŒ–</h2><p><strong>SQLè¯­å¥</strong></p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-comment">--æŸ¥è¯¢æ“ä½œï¼Œç›®å‰ç´¢å¼•åœ¨bookè¡¨çš„cardä¸Šï¼Œclassè¡¨å’Œbookè¡¨çš„ä½ç½®ä¸ä¼šæ”¹å˜æŸ¥è¯¢ç»“æœ</span><br><span class="hljs-keyword">EXPLAIN</span> <span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> <span class="hljs-keyword">class</span> <span class="hljs-keyword">INNER</span> <span class="hljs-keyword">JOIN</span> book <span class="hljs-keyword">ON</span> <span class="hljs-keyword">class</span>.card = book.card;<br><span class="hljs-keyword">EXPLAIN</span> <span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> book <span class="hljs-keyword">INNER</span> <span class="hljs-keyword">JOIN</span> <span class="hljs-keyword">class</span> <span class="hljs-keyword">ON</span> book.card = <span class="hljs-keyword">class</span>.card;<br><br><span class="hljs-comment">--åˆ é™¤bookè¡¨ä¸­çš„å‡ æ¡è®°å½•</span><br><span class="hljs-keyword">DELETE</span> <span class="hljs-keyword">FROM</span> book <span class="hljs-keyword">WHERE</span> bookid&lt;<span class="hljs-number">10</span>;<br><br><span class="hljs-comment">--å†æ¬¡æŸ¥è¯¢</span><br><span class="hljs-keyword">EXPLAIN</span> <span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> <span class="hljs-keyword">class</span> <span class="hljs-keyword">INNER</span> <span class="hljs-keyword">JOIN</span> book <span class="hljs-keyword">ON</span> <span class="hljs-keyword">class</span>.card = book.card;<br><br><span class="hljs-comment">--åˆ é™¤bookè¡¨cardå­—æ®µç´¢å¼•ï¼Œç»™classè¡¨çš„cardå­—æ®µæ·»åŠ ç´¢å¼•</span><br><span class="hljs-keyword">DROP</span> <span class="hljs-keyword">INDEX</span> idx_book_card <span class="hljs-keyword">ON</span> book;<br><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">INDEX</span> idx_class_card <span class="hljs-keyword">ON</span> <span class="hljs-keyword">class</span>(card);<br><br><span class="hljs-comment">--å†æ¬¡æŸ¥è¯¢</span><br><span class="hljs-keyword">EXPLAIN</span> <span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> <span class="hljs-keyword">class</span> <span class="hljs-keyword">INNER</span> <span class="hljs-keyword">JOIN</span> book <span class="hljs-keyword">ON</span> <span class="hljs-keyword">class</span>.card = book.card;<span class="hljs-keyword">Copy</span><br></code></pre></td></tr></table></figure><p><strong>å¯¹åº”ç»“æœ</strong></p><p><a href="https://nyimapicture.oss-cn-beijing.aliyuncs.com/img/20200818171341.png"><img src="/mysql2.assets/20200818171341.png" alt="img"></a></p><p><a href="https://nyimapicture.oss-cn-beijing.aliyuncs.com/img/20200818171538.png"><img src="/mysql2.assets/20200818171538.png" alt="img"></a></p><p><a href="https://nyimapicture.oss-cn-beijing.aliyuncs.com/img/20200818171625.png"><img src="/mysql2.assets/20200818171625.png" alt="img"></a></p><p><strong>ç»“è®º</strong>ï¼šinner join æ—¶ï¼Œ<strong>mysql ä¼šæŠŠå°ç»“æœé›†çš„è¡¨é€‰ä¸ºé©±åŠ¨è¡¨</strong>ï¼ˆå°è¡¨é©±åŠ¨å¤§è¡¨ï¼‰</p><p><strong>æ‰€ä»¥æœ€å¥½æŠŠç´¢å¼•å»ºç«‹åœ¨å¤§è¡¨ï¼ˆæ•°æ®è¾ƒå¤šçš„è¡¨ï¼‰ä¸Š</strong></p><h2 id="3ã€RIGHT-JOINä¼˜åŒ–"><a href="#3ã€RIGHT-JOINä¼˜åŒ–" class="headerlink" title="3ã€RIGHT JOINä¼˜åŒ–"></a>3ã€RIGHT JOINä¼˜åŒ–</h2><p>ä¼˜åŒ–ç±»å‹å’ŒLEFT JOINç±»ä¼¼ï¼Œåªä¸è¿‡<strong>è¢«é©±åŠ¨è¡¨å˜æˆäº†å·¦è¡¨</strong></p><h1 id="ä¸ƒã€æ’åºåˆ†ç»„ä¼˜åŒ–"><a href="#ä¸ƒã€æ’åºåˆ†ç»„ä¼˜åŒ–" class="headerlink" title="ä¸ƒã€æ’åºåˆ†ç»„ä¼˜åŒ–"></a>ä¸ƒã€æ’åºåˆ†ç»„ä¼˜åŒ–</h1><p>åœ¨æŸ¥è¯¢ä¸­éš¾å…ä¼šå¯¹æŸ¥è¯¢ç»“æœè¿›è¡Œæ’åºæ“ä½œã€‚è¿›è¡Œæ’åºæ“ä½œæ—¶è¦<strong>é¿å…å‡ºç° Using filesort</strong>ï¼Œåº”ä½¿ç”¨ç´¢å¼•ç»™æ’åºå¸¦æ¥çš„æ–¹ä¾¿</p><p><strong>ç´¢å¼•ä¿¡æ¯</strong></p><p><a href="https://nyimapicture.oss-cn-beijing.aliyuncs.com/img/20200819160428.png"><img src="/mysql2.assets/20200819160428.png" alt="img"></a></p><h2 id="1ã€ORDER-BY-ä¼˜åŒ–"><a href="#1ã€ORDER-BY-ä¼˜åŒ–" class="headerlink" title="1ã€ORDER BY ä¼˜åŒ–"></a>1ã€ORDER BY ä¼˜åŒ–</h2><p>ä»¥ä¸‹æŸ¥è¯¢éƒ½æ˜¯åœ¨<strong>ç´¢å¼•è¦†ç›–</strong>çš„æ¡ä»¶ä¸‹è¿›è¡Œçš„</p><p><strong>SQLè¯­å¥</strong></p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-comment">--ä¸æ»¡è¶³ç´¢å¼•è¦†ç›–æ—¶è¿›è¡Œæ’åºæŸ¥è¯¢</span><br><span class="hljs-keyword">EXPLAIN</span> <span class="hljs-keyword">SELECT</span> empno <span class="hljs-keyword">FROM</span> t_emp  <span class="hljs-keyword">WHERE</span> age &gt; <span class="hljs-number">50</span> <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> age, deptId;<br><br><span class="hljs-comment">--æŒ‰ç…§å¤åˆç´¢å¼•é¡ºåºè¿›è¡Œæ’åº</span><br><span class="hljs-keyword">EXPLAIN</span> <span class="hljs-keyword">SELECT</span> age, deptId <span class="hljs-keyword">FROM</span> t_emp  <span class="hljs-keyword">WHERE</span> age &gt; <span class="hljs-number">50</span> <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> age;<br><span class="hljs-keyword">EXPLAIN</span> <span class="hljs-keyword">SELECT</span> age, deptId <span class="hljs-keyword">FROM</span> t_emp  <span class="hljs-keyword">WHERE</span> age &gt; <span class="hljs-number">50</span> <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> age, deptId;<br><span class="hljs-keyword">EXPLAIN</span> <span class="hljs-keyword">SELECT</span> age, deptId <span class="hljs-keyword">FROM</span> t_emp  <span class="hljs-keyword">WHERE</span> age &gt; <span class="hljs-number">50</span> <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> age, deptId, <span class="hljs-type">name</span>;<br><br><span class="hljs-comment">--ä¸æŒ‰ç…§å¤åˆç´¢å¼•é¡ºåºè¿›è¡Œæ’åºï¼ˆæ—  age å­—æ®µï¼‰ï¼Œå‘ç”ŸUsing filesort</span><br><span class="hljs-keyword">EXPLAIN</span> <span class="hljs-keyword">SELECT</span> age, deptId <span class="hljs-keyword">FROM</span> t_emp  <span class="hljs-keyword">WHERE</span> age &gt; <span class="hljs-number">50</span> <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> deptId, <span class="hljs-type">name</span>;<br><br><span class="hljs-comment">--ä¸æŒ‰ç…§å¤åˆç´¢å¼•é¡ºåºè¿›è¡Œæ’åºï¼ˆç´¢å¼•é¡ºåºæ‰“ä¹±ï¼‰ï¼Œå‘ç”ŸUsing filesort</span><br><span class="hljs-keyword">EXPLAIN</span> <span class="hljs-keyword">SELECT</span> age, deptId <span class="hljs-keyword">FROM</span> t_emp  <span class="hljs-keyword">WHERE</span> age &gt; <span class="hljs-number">50</span> <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> deptId, <span class="hljs-type">name</span>, age;<br><br><span class="hljs-comment">--æ’åºæ—¶éƒ¨åˆ†(age)å‡åºï¼Œéƒ¨åˆ†(deptId)é™åºï¼Œå‘ç”ŸUsing filesort</span><br><span class="hljs-keyword">EXPLAIN</span> <span class="hljs-keyword">SELECT</span> age, deptId <span class="hljs-keyword">FROM</span> t_emp  <span class="hljs-keyword">WHERE</span> age &gt; <span class="hljs-number">50</span> <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> age <span class="hljs-keyword">ASC</span>, deptId <span class="hljs-keyword">DESC</span>;<br><br><span class="hljs-comment">--æ’åºæ—¶éƒ½ä¸ºé™åº</span><br><span class="hljs-keyword">EXPLAIN</span> <span class="hljs-keyword">SELECT</span> age, deptId <span class="hljs-keyword">FROM</span> t_emp  <span class="hljs-keyword">WHERE</span> age &gt; <span class="hljs-number">50</span> <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> age <span class="hljs-keyword">DESC</span>, deptId <span class="hljs-keyword">DESC</span>;<br><br><span class="hljs-comment">--æ’åºæ—¶ï¼Œåœ¨å‰é¢çš„å­—æ®µä¸ºå¸¸é‡æ—¶ï¼ˆéèŒƒå›´ï¼‰</span><br><span class="hljs-keyword">EXPLAIN</span> <span class="hljs-keyword">SELECT</span> age, deptId <span class="hljs-keyword">FROM</span> t_emp  <span class="hljs-keyword">WHERE</span> age = <span class="hljs-number">50</span> <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> deptId, <span class="hljs-type">name</span>;<br><span class="hljs-keyword">EXPLAIN</span> <span class="hljs-keyword">SELECT</span> age, deptId <span class="hljs-keyword">FROM</span> t_emp  <span class="hljs-keyword">WHERE</span> age = <span class="hljs-number">50</span> <span class="hljs-keyword">AND</span> deptId&gt;<span class="hljs-number">10000</span> <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> deptId, <span class="hljs-type">name</span>;<span class="hljs-keyword">Copy</span><br></code></pre></td></tr></table></figure><p><strong>å¯¹åº”ç»“æœ</strong></p><p><a href="https://nyimapicture.oss-cn-beijing.aliyuncs.com/img/20200819162506.png"><img src="/mysql2.assets/20200819162506.png" alt="img"></a></p><p><a href="https://nyimapicture.oss-cn-beijing.aliyuncs.com/img/20200819162240.png"><img src="/mysql2.assets/20200819162240.png" alt="img"></a></p><p><a href="https://nyimapicture.oss-cn-beijing.aliyuncs.com/img/20200819162240.png"><img src="/mysql2.assets/20200819162240.png" alt="img"></a></p><p><a href="https://nyimapicture.oss-cn-beijing.aliyuncs.com/img/20200819162240.png"><img src="/mysql2.assets/20200819162240.png" alt="img"></a></p><p><a href="https://nyimapicture.oss-cn-beijing.aliyuncs.com/img/20200819162314.png"><img src="/mysql2.assets/20200819162314.png" alt="img"></a></p><p><a href="https://nyimapicture.oss-cn-beijing.aliyuncs.com/img/20200907210532.png"><img src="/mysql2.assets/20200907210532.png" alt="img"></a></p><p><a href="https://nyimapicture.oss-cn-beijing.aliyuncs.com/img/20200819162429.png"><img src="/mysql2.assets/20200819162429.png" alt="img"></a></p><p><a href="https://nyimapicture.oss-cn-beijing.aliyuncs.com/img/20200819162901.png"><img src="/mysql2.assets/20200819162901.png" alt="img"></a></p><p><a href="https://nyimapicture.oss-cn-beijing.aliyuncs.com/img/20200819164020.png"><img src="/mysql2.assets/20200819164020.png" alt="img"></a></p><p><a href="https://nyimapicture.oss-cn-beijing.aliyuncs.com/img/20200819164317.png"><img src="/mysql2.assets/20200819164317.png" alt="img"></a></p><p><strong>ç»“è®º</strong>ï¼š</p><p>è¦æƒ³åœ¨æ’åºæ—¶ä½¿ç”¨ç´¢å¼•ï¼Œé¿å… Using filesortï¼Œé¦–å…ˆéœ€è¦å‘ç”Ÿ<strong>ç´¢å¼•è¦†ç›–</strong>ï¼Œå…¶æ¬¡</p><ul><li>ORDER BY åé¢å­—æ®µçš„é¡ºåºè¦å’Œå¤åˆç´¢å¼•çš„<strong>é¡ºåºå®Œå…¨ä¸€è‡´</strong></li><li>ORDER BY åé¢çš„ç´¢å¼•å¿…é¡»æŒ‰ç…§é¡ºåºå‡ºç°ï¼Œ<strong>æ’åœ¨åé¢çš„å¯ä»¥ä¸å‡ºç°</strong></li><li>è¦è¿›è¡Œå‡åºæˆ–è€…é™åºæ—¶ï¼Œ<strong>å­—æ®µçš„æ’åºé¡ºåºå¿…é¡»ä¸€è‡´</strong>ã€‚ä¸èƒ½ä¸€éƒ¨åˆ†å‡åºï¼Œä¸€éƒ¨åˆ†é™åºï¼Œå¯ä»¥éƒ½å‡åºæˆ–è€…éƒ½é™åº</li><li>å¦‚æœå¤åˆç´¢å¼•å‰é¢çš„<strong>å­—æ®µä½œä¸ºå¸¸é‡</strong>å‡ºç°åœ¨è¿‡æ»¤æ¡ä»¶ä¸­ï¼Œ<strong>æ’åºå­—æ®µå¯ä»¥ä¸ºç´§è·Ÿå…¶åçš„å­—æ®µ</strong></li></ul><h3 id="MySQLçš„æ’åºç®—æ³•"><a href="#MySQLçš„æ’åºç®—æ³•" class="headerlink" title="MySQLçš„æ’åºç®—æ³•"></a>MySQLçš„æ’åºç®—æ³•</h3><p>å½“å‘ç”Ÿ Using filesort æ—¶ï¼ŒMySQLä¼šæ ¹æ®è‡ªå·±çš„ç®—æ³•å¯¹æŸ¥è¯¢ç»“æœè¿›è¡Œæ’åº</p><ul><li>åŒè·¯æ’åº<ul><li>MySQL 4.1 ä¹‹å‰æ˜¯ä½¿ç”¨åŒè·¯æ’åº,å­—é¢æ„æ€å°±æ˜¯<strong>ä¸¤æ¬¡æ‰«æç£ç›˜</strong>ï¼Œæœ€ç»ˆå¾—åˆ°æ•°æ®ï¼Œè¯»å–è¡ŒæŒ‡é’ˆå’Œ order by åˆ—ï¼Œå¯¹ä»–ä»¬è¿›è¡Œæ’åºï¼Œç„¶åæ‰«æå·²ç»æ’åºå¥½çš„åˆ—è¡¨ï¼ŒæŒ‰ç…§åˆ—è¡¨ä¸­çš„å€¼é‡æ–°ä»åˆ—è¡¨ä¸­è¯»å–å¯¹åº”çš„æ•°æ®è¾“å‡º</li><li>ä»ç£ç›˜å–æ’åºå­—æ®µï¼Œåœ¨ buffer è¿›è¡Œæ’åºï¼Œå†ä»ç£ç›˜å–å…¶ä»–å­—æ®µ</li><li>ç®€å•æ¥è¯´ï¼Œ<strong>å–ä¸€æ‰¹æ•°æ®ï¼Œè¦å¯¹ç£ç›˜è¿›è¡Œäº†ä¸¤æ¬¡æ‰«æ</strong>ï¼Œä¼—æ‰€å‘¨çŸ¥ï¼ŒI\O æ˜¯å¾ˆè€—æ—¶çš„ï¼Œæ‰€ä»¥åœ¨ mysql4.1 ä¹‹åï¼Œå‡ºç°äº†ç¬¬äºŒç§æ”¹è¿›çš„ç®—æ³•ï¼Œå°±æ˜¯å•è·¯æ’åº</li></ul></li><li>å•è·¯æ’åº<ul><li>ä»ç£ç›˜è¯»å–æŸ¥è¯¢éœ€è¦çš„æ‰€æœ‰åˆ—ï¼ŒæŒ‰ç…§ order by åˆ—<strong>åœ¨ buffer å¯¹å®ƒä»¬è¿›è¡Œæ’åº</strong>ï¼Œç„¶åæ‰«ææ’åºåçš„åˆ—è¡¨è¿›è¡Œè¾“å‡ºï¼Œ å®ƒçš„æ•ˆç‡æ›´å¿«ä¸€äº›ï¼Œé¿å…äº†ç¬¬äºŒæ¬¡è¯»å–æ•°æ®ã€‚å¹¶ä¸”æŠŠéšæœº IO å˜æˆäº†é¡ºåº IO,ä½†æ˜¯å®ƒä¼šä½¿ç”¨æ›´å¤šçš„ç©ºé—´ï¼Œ å› ä¸ºå®ƒæŠŠæ¯ä¸€è¡Œéƒ½ä¿å­˜åœ¨å†…å­˜ä¸­äº†</li><li><strong>å­˜åœ¨çš„é—®é¢˜</strong>ï¼šåœ¨ sort_buffer ä¸­ï¼Œæ–¹æ³• B æ¯”æ–¹æ³• A è¦å¤šå ç”¨å¾ˆå¤šç©ºé—´ï¼Œå› ä¸ºæ–¹æ³• B æ˜¯æŠŠæ‰€æœ‰å­—æ®µéƒ½å–å‡º, æ‰€ä»¥æœ‰å¯èƒ½<strong>å–å‡ºçš„æ•°æ®çš„æ€»å¤§å°è¶…å‡ºäº† sort_buffer çš„å®¹é‡</strong>ï¼Œå¯¼è‡´æ¯æ¬¡åªèƒ½å– sort_buffer å®¹é‡å¤§å°çš„æ•°æ®ï¼Œè¿›è¡Œæ’åºï¼ˆåˆ›å»º tmp æ–‡ä»¶ï¼Œå¤š è·¯åˆå¹¶ï¼‰ï¼Œæ’å®Œå†å–å– sort_buffer å®¹é‡å¤§å°ï¼Œå†æ’â€¦â€¦ä»è€Œå¤šæ¬¡ I&#x2F;Oã€‚ä¹Ÿå°±æ˜¯<strong>æœ¬æ¥æƒ³çœä¸€æ¬¡ I&#x2F;O æ“ä½œï¼Œåè€Œå¯¼è‡´äº†å¤§é‡çš„ I&#x2F;O æ“ä½œï¼Œåè€Œå¾—ä¸å¿å¤±</strong></li></ul></li><li>ä¼˜åŒ–Using filesort<ul><li>å¢å¤§ sort_butter_size å‚æ•°çš„è®¾ç½®<ul><li>ä¸ç®¡ç”¨å“ªç§ç®—æ³•ï¼Œæé«˜è¿™ä¸ªå‚æ•°éƒ½ä¼šæé«˜æ•ˆç‡ï¼Œå½“ç„¶ï¼Œè¦æ ¹æ®ç³»ç»Ÿçš„èƒ½åŠ›å»æé«˜ï¼Œå› ä¸ºè¿™ä¸ªå‚æ•°æ˜¯é’ˆå¯¹<strong>æ¯ä¸ªè¿›ç¨‹çš„ 1M-8M ä¹‹é—´è°ƒæ•´</strong></li></ul></li><li>å¢å¤§ max_length_for_sort_data å‚æ•°çš„è®¾ç½®<ul><li>mysql ä½¿ç”¨å•è·¯æ’åºçš„å‰ææ˜¯<strong>æ’åºçš„å­—æ®µå¤§å°è¦å°äº max_length_for_sort_data</strong></li><li>æé«˜è¿™ä¸ªå‚æ•°ï¼Œä¼šå¢åŠ ç”¨æ”¹è¿›ç®—æ³•çš„æ¦‚ç‡ã€‚ä½†æ˜¯å¦‚æœè®¾çš„å¤ªé«˜ï¼Œæ•°æ®æ€»å®¹é‡è¶…å‡º sort_buffer_size çš„æ¦‚ç‡å°±å¢å¤§ï¼Œ æ˜æ˜¾ç—‡çŠ¶æ˜¯é«˜çš„ç£ç›˜ I&#x2F;O æ´»åŠ¨å’Œä½çš„å¤„ç†å™¨ä½¿ç”¨ç‡ã€‚ï¼ˆ1024-8192 ä¹‹é—´è°ƒæ•´ï¼‰</li></ul></li><li>å‡å°‘ select åé¢çš„æŸ¥è¯¢çš„å­—æ®µ<ul><li>æŸ¥è¯¢çš„å­—æ®µå‡å°‘äº†ï¼Œç¼“å†²é‡Œå°±èƒ½å®¹çº³æ›´å¤šçš„å†…å®¹äº†ï¼Œ<strong>é—´æ¥å¢å¤§äº†sort_buffer_size</strong></li></ul></li></ul></li></ul><p><a href="https://nyimapicture.oss-cn-beijing.aliyuncs.com/img/20200819164341.png"><img src="/mysql2.assets/20200819164341.png" alt="img"></a></p><h2 id="2ã€GROUP-BY-ä¼˜åŒ–"><a href="#2ã€GROUP-BY-ä¼˜åŒ–" class="headerlink" title="2ã€GROUP BY ä¼˜åŒ–"></a>2ã€GROUP BY ä¼˜åŒ–</h2><p>ä¼˜åŒ–æ–¹å¼å’Œ ORDER BY ç±»ä¼¼ï¼Œå‚è€ƒORDER BY çš„ä¼˜åŒ–æ–¹å¼å³å¯</p><h1 id="å…«ã€æˆªå–æŸ¥è¯¢åˆ†æ"><a href="#å…«ã€æˆªå–æŸ¥è¯¢åˆ†æ" class="headerlink" title="å…«ã€æˆªå–æŸ¥è¯¢åˆ†æ"></a>å…«ã€æˆªå–æŸ¥è¯¢åˆ†æ</h1><h2 id="1ã€æ…¢æ—¥å¿—æŸ¥è¯¢"><a href="#1ã€æ…¢æ—¥å¿—æŸ¥è¯¢" class="headerlink" title="1ã€æ…¢æ—¥å¿—æŸ¥è¯¢"></a>1ã€æ…¢æ—¥å¿—æŸ¥è¯¢</h2><h3 id="æ¦‚å¿µ"><a href="#æ¦‚å¿µ" class="headerlink" title="æ¦‚å¿µ"></a>æ¦‚å¿µ</h3><ul><li>MySQLçš„æ…¢æŸ¥è¯¢æ—¥å¿—æ˜¯MySQLæä¾›çš„ä¸€ç§æ—¥å¿—è®°å½•ï¼Œ<strong>å®ƒç”¨æ¥è®°å½•åœ¨MySQLä¸­å“åº”æ—¶é—´è¶…è¿‡é˜€å€¼çš„è¯­å¥</strong>ï¼Œå…·ä½“æŒ‡è¿è¡Œæ—¶é—´è¶…è¿‡<strong>long_query_time</strong>å€¼çš„SQLï¼Œåˆ™ä¼šè¢«è®°å½•åˆ°æ…¢æŸ¥è¯¢æ—¥å¿—ä¸­</li><li>å…·ä½“æŒ‡è¿è¡Œæ—¶é—´è¶…è¿‡long_query_timeå€¼çš„SQLï¼Œåˆ™ä¼šè¢«è®°å½•åˆ°æ…¢æŸ¥è¯¢æ—¥å¿—ä¸­ã€‚long_query_timeçš„é»˜è®¤å€¼ä¸º 10ï¼Œæ„æ€æ˜¯è¿è¡Œ10ç§’ä»¥ä¸Šçš„è¯­å¥</li><li>ç”±ä»–æ¥æŸ¥çœ‹å“ªäº›SQLè¶…å‡ºäº†æˆ‘ä»¬çš„æœ€å¤§å¿è€æ—¶é—´å€¼ï¼Œæ¯”å¦‚ä¸€æ¡sqlæ‰§è¡Œè¶…è¿‡5ç§’é’Ÿï¼Œæˆ‘ä»¬å°±ç®—æ…¢SQLï¼Œå¸Œæœ›èƒ½ æ”¶é›†è¶…è¿‡5ç§’çš„sqlï¼Œç»“åˆä¹‹å‰explainè¿›è¡Œå…¨é¢åˆ†æ</li></ul><h3 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h3><p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒMySQL æ•°æ®åº“æ²¡æœ‰å¼€å¯æ…¢æŸ¥è¯¢æ—¥å¿—ï¼Œéœ€è¦æˆ‘ä»¬<strong>æ‰‹åŠ¨</strong>æ¥è®¾ç½®è¿™ä¸ªå‚æ•°</p><p>å¦‚æœä¸æ˜¯è°ƒä¼˜éœ€è¦çš„è¯ï¼Œ<strong>ä¸€èˆ¬ä¸å»ºè®®å¯åŠ¨è¯¥å‚æ•°</strong>ï¼Œå› ä¸ºå¼€å¯æ…¢æŸ¥è¯¢æ—¥å¿—ä¼šæˆ–å¤šæˆ–å°‘å¸¦æ¥ä¸€å®šçš„æ€§èƒ½å½±å“ã€‚ æ…¢æŸ¥è¯¢æ—¥å¿—æ”¯æŒå°†æ—¥å¿—è®°å½•å†™å…¥æ–‡ä»¶</p><table><thead><tr><th>SQL è¯­å¥</th><th>æè¿°</th><th>å¤‡æ³¨</th></tr></thead><tbody><tr><td>SHOW VARIABLES LIKE â€˜%slow_query_log%â€™</td><td>æŸ¥çœ‹æ…¢æŸ¥è¯¢æ—¥å¿—æ˜¯å¦å¼€å¯</td><td>é»˜è®¤æƒ…å†µä¸‹ slow_query_log çš„å€¼ä¸º OFF</td></tr><tr><td>set global slow_query_log&#x3D;1</td><td>å¼€å¯æ…¢æŸ¥è¯¢æ—¥å¿—</td><td></td></tr><tr><td>SHOW VARIABLES LIKE â€˜long_query_time%â€™</td><td>æŸ¥çœ‹æ…¢æŸ¥è¯¢è®¾å®šé˜ˆå€¼</td><td>å•ä½ï¼šç§’</td></tr><tr><td>set long_query_time&#x3D;1</td><td>è®¾å®šæ…¢æŸ¥è¯¢é˜ˆå€¼</td><td>å•ä½ï¼šç§’</td></tr></tbody></table><p>è¿è¡ŒæŸ¥è¯¢æ—¶é—´é•¿çš„ sqlï¼Œ<strong>å¯ä»¥æ‰“å¼€æ…¢æŸ¥è¯¢æ—¥å¿—æŸ¥çœ‹</strong></p><h2 id="2ã€æ‰¹é‡æ•°æ®è„šæœ¬"><a href="#2ã€æ‰¹é‡æ•°æ®è„šæœ¬" class="headerlink" title="2ã€æ‰¹é‡æ•°æ®è„šæœ¬"></a>2ã€æ‰¹é‡æ•°æ®è„šæœ¬</h2><h3 id="å»ºè¡¨è¯­å¥-1"><a href="#å»ºè¡¨è¯­å¥-1" class="headerlink" title="å»ºè¡¨è¯­å¥"></a>å»ºè¡¨è¯­å¥</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">--dept éƒ¨é—¨è¡¨</span><br><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> `dept` (<br>`id` <span class="hljs-type">INT</span>(<span class="hljs-number">11</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> AUTO_INCREMENT, `deptName` <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">30</span>) <span class="hljs-keyword">DEFAULT</span> <span class="hljs-keyword">NULL</span>, `address` <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">40</span>) <span class="hljs-keyword">DEFAULT</span> <span class="hljs-keyword">NULL</span>, ceo <span class="hljs-type">INT</span> <span class="hljs-keyword">NULL</span> , <span class="hljs-keyword">PRIMARY</span> KEY (`id`)<br>) ENGINE<span class="hljs-operator">=</span>INNODB AUTO_INCREMENT<span class="hljs-operator">=</span><span class="hljs-number">1</span> <span class="hljs-keyword">DEFAULT</span> CHARSET<span class="hljs-operator">=</span>utf8;<br><br><span class="hljs-comment">-- emp å‘˜å·¥è¡¨</span><br><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> `emp` (<br>`id` <span class="hljs-type">INT</span>(<span class="hljs-number">11</span>) <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> AUTO_INCREMENT, `empno` <span class="hljs-type">INT</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> , `name` <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">20</span>) <span class="hljs-keyword">DEFAULT</span> <span class="hljs-keyword">NULL</span>, `age` <span class="hljs-type">INT</span>(<span class="hljs-number">3</span>) <span class="hljs-keyword">DEFAULT</span> <span class="hljs-keyword">NULL</span>, `deptId` <span class="hljs-type">INT</span>(<span class="hljs-number">11</span>) <span class="hljs-keyword">DEFAULT</span> <span class="hljs-keyword">NULL</span>, <span class="hljs-keyword">PRIMARY</span> KEY (`id`)<br>#<span class="hljs-keyword">CONSTRAINT</span> `fk_dept_id` <span class="hljs-keyword">FOREIGN</span> KEY (`deptId`) <span class="hljs-keyword">REFERENCES</span> `t_dept` (`id`)<br>) ENGINE<span class="hljs-operator">=</span>INNODB AUTO_INCREMENT<span class="hljs-operator">=</span><span class="hljs-number">1</span> <span class="hljs-keyword">DEFAULT</span> CHARSET<span class="hljs-operator">=</span>utf8;<span class="hljs-keyword">Copy</span><br></code></pre></td></tr></table></figure><h3 id="è®¾ç½®å‚æ•°"><a href="#è®¾ç½®å‚æ•°" class="headerlink" title="è®¾ç½®å‚æ•°"></a>è®¾ç½®å‚æ•°</h3><p>åœ¨æ‰§è¡Œåˆ›å»ºå‡½æ•°ä¹‹å‰ï¼Œé¦–å…ˆè¯·ä¿è¯ log_bin_trust_function_creators å‚æ•°ä¸º 1ï¼Œå³ on å¼€å¯çŠ¶æ€ã€‚ å¦åˆ™ä¼šæŠ¥é”™</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">--æŸ¥è¯¢</span><br><span class="hljs-keyword">SHOW</span> VARIABLES <span class="hljs-keyword">LIKE</span> <span class="hljs-string">&#x27;log_bin_trust_function_creators&#x27;</span>;<br><br><span class="hljs-comment">--è®¾ç½®</span><br><span class="hljs-keyword">SET</span> <span class="hljs-keyword">GLOBAL</span> log_bin_trust_function_creators<span class="hljs-operator">=</span><span class="hljs-number">1</span>;<span class="hljs-keyword">Copy</span><br></code></pre></td></tr></table></figure><h3 id="ç¼–å†™éšæœºå‡½æ•°"><a href="#ç¼–å†™éšæœºå‡½æ•°" class="headerlink" title="ç¼–å†™éšæœºå‡½æ•°"></a>ç¼–å†™éšæœºå‡½æ•°</h3><h4 id="éšæœºäº§ç”Ÿå­—ç¬¦ä¸²"><a href="#éšæœºäº§ç”Ÿå­—ç¬¦ä¸²" class="headerlink" title="éšæœºäº§ç”Ÿå­—ç¬¦ä¸²"></a><strong>éšæœºäº§ç”Ÿå­—ç¬¦ä¸²</strong></h4><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-comment">--DELIMITER æ˜¯ç”¨äºæ”¹å˜ç»“æŸçš„æ ‡å¿—çš„ï¼Œä¸€èˆ¬ä»¥åˆ†å·ç»“å°¾ï¼Œä½†è¿™é‡Œæ”¹ä¸ºäº†ä»¥ $$ ç»“å°¾</span><br><span class="hljs-keyword">DELIMITER</span> $$<span class="language-pgsql"></span><br><span class="language-pgsql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">FUNCTION</span> rand_string(n <span class="hljs-type">INT</span>) <span class="hljs-keyword">RETURNS</span> <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">255</span>)</span><br><span class="language-pgsql"><span class="hljs-keyword">BEGIN</span></span><br><span class="language-pgsql"><span class="hljs-keyword">DECLARE</span> chars_str <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">100</span>) <span class="hljs-keyword">DEFAULT</span> <span class="hljs-string">&#x27;abcdefghijklmnopqrstuvwxyzABCDEFJHIJKLMNOPQRSTUVWXYZ&#x27;</span>;</span><br><span class="language-pgsql"><span class="hljs-keyword">DECLARE</span> return_str <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">255</span>) <span class="hljs-keyword">DEFAULT</span> <span class="hljs-string">&#x27;&#x27;</span>;</span><br><span class="language-pgsql"><span class="hljs-keyword">DECLARE</span> i <span class="hljs-type">INT</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-number">0</span>;</span><br><span class="language-pgsql"><span class="hljs-keyword">WHILE</span> i &lt; n <span class="hljs-keyword">DO</span></span><br><span class="language-pgsql"><span class="hljs-keyword">SET</span> return_str =CONCAT(return_str,SUBSTRING(chars_str,FLOOR(<span class="hljs-number">1</span>+RAND()*<span class="hljs-number">52</span>),<span class="hljs-number">1</span>));</span><br><span class="language-pgsql"><span class="hljs-keyword">SET</span> i = i + <span class="hljs-number">1</span>;</span><br><span class="language-pgsql"><span class="hljs-keyword">END</span> <span class="hljs-keyword">WHILE</span>;</span><br><span class="language-pgsql"><span class="hljs-keyword">RETURN</span> return_str;</span><br><span class="language-pgsql"><span class="hljs-keyword">END</span> $$</span><span class="hljs-keyword">Copy</span><br></code></pre></td></tr></table></figure><p>å¦‚æœè¦<strong>åˆ é™¤å‡½æ•°</strong>ï¼Œåˆ™æ‰§è¡Œï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">DROP</span> <span class="hljs-keyword">FUNCTION</span> rand_string;<span class="hljs-keyword">Copy</span><br></code></pre></td></tr></table></figure><h4 id="éšæœºäº§ç”Ÿéƒ¨é—¨ç¼–å·"><a href="#éšæœºäº§ç”Ÿéƒ¨é—¨ç¼–å·" class="headerlink" title="éšæœºäº§ç”Ÿéƒ¨é—¨ç¼–å·"></a>éšæœºäº§ç”Ÿéƒ¨é—¨ç¼–å·</h4><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-keyword">DELIMITER</span> $$<span class="language-pgsql"></span><br><span class="language-pgsql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">FUNCTION</span> rand_num (from_num <span class="hljs-type">INT</span> ,to_num <span class="hljs-type">INT</span>) <span class="hljs-keyword">RETURNS</span> <span class="hljs-type">INT</span>(<span class="hljs-number">11</span>)</span><br><span class="language-pgsql"><span class="hljs-keyword">BEGIN</span></span><br><span class="language-pgsql"><span class="hljs-keyword">DECLARE</span> i <span class="hljs-type">INT</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-number">0</span>;</span><br><span class="language-pgsql"><span class="hljs-keyword">SET</span> i = FLOOR(from_num +RAND()*(to_num -from_num+<span class="hljs-number">1</span>)) ;</span><br><span class="language-pgsql"><span class="hljs-keyword">RETURN</span> i;</span><br><span class="language-pgsql"><span class="hljs-keyword">END</span>$$</span><span class="hljs-keyword">Copy</span><br></code></pre></td></tr></table></figure><p>å¦‚æœè¦<strong>åˆ é™¤å‡½æ•°</strong>ï¼Œåˆ™æ‰§è¡Œï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">drop</span> <span class="hljs-keyword">function</span> rand_num;<span class="hljs-keyword">Copy</span><br></code></pre></td></tr></table></figure><h3 id="åˆ›å»ºå­˜å‚¨è¿‡ç¨‹"><a href="#åˆ›å»ºå­˜å‚¨è¿‡ç¨‹" class="headerlink" title="åˆ›å»ºå­˜å‚¨è¿‡ç¨‹"></a>åˆ›å»ºå­˜å‚¨è¿‡ç¨‹</h3><h4 id="åˆ›å»ºå¾€-emp-è¡¨ä¸­æ’å…¥æ•°æ®çš„å­˜å‚¨è¿‡ç¨‹"><a href="#åˆ›å»ºå¾€-emp-è¡¨ä¸­æ’å…¥æ•°æ®çš„å­˜å‚¨è¿‡ç¨‹" class="headerlink" title="åˆ›å»ºå¾€ emp è¡¨ä¸­æ’å…¥æ•°æ®çš„å­˜å‚¨è¿‡ç¨‹"></a>åˆ›å»ºå¾€ emp è¡¨ä¸­æ’å…¥æ•°æ®çš„å­˜å‚¨è¿‡ç¨‹</h4><figure class="highlight oxygene"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs oxygene">DELIMITER $$<br><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">PROCEDURE</span> <span class="hljs-title function_">insert_emp</span><span class="hljs-params">( START INT , max_num INT )</span><br><span class="hljs-title function_">BEGIN</span><br><span class="hljs-title function_">DECLARE</span> <span class="hljs-title function_">i</span> <span class="hljs-title function_">INT</span> <span class="hljs-title function_">DEFAULT</span> 0;<br>#<span class="hljs-keyword">set</span> autocommit =<span class="hljs-number">0</span> æŠŠ autocommit è®¾ç½®æˆ <span class="hljs-number">0</span><br><span class="hljs-keyword">SET</span> autocommit = <span class="hljs-number">0</span><span class="hljs-punctuation">;</span><br><span class="hljs-keyword">REPEAT</span><br><span class="hljs-keyword">SET</span> i = i + <span class="hljs-number">1</span><span class="hljs-punctuation">;</span><br>INSERT <span class="hljs-keyword">INTO</span> emp (empno, NAME ,age ,deptid ) VALUES ((START+i) ,rand_string(<span class="hljs-number">6</span>) , rand_num(<span class="hljs-number">30</span>,<span class="hljs-number">50</span>),rand_num(<span class="hljs-number">1</span>,<span class="hljs-number">10000</span>))<span class="hljs-punctuation">;</span><br><span class="hljs-keyword">UNTIL</span> i = max_num<br><span class="hljs-keyword">END</span> <span class="hljs-keyword">REPEAT</span><span class="hljs-punctuation">;</span><br>COMMIT<span class="hljs-punctuation">;</span><br><span class="hljs-keyword">END</span>$$<br><br>--åˆ é™¤<br>-- DELIMITER <span class="hljs-punctuation">;</span><br>-- drop <span class="hljs-keyword">PROCEDURE</span> <span class="hljs-title function_">insert_emp</span>;<span class="hljs-keyword">Copy</span><br></code></pre></td></tr></table></figure><h4 id="åˆ›å»ºå¾€-dept-è¡¨ä¸­æ’å…¥æ•°æ®çš„å­˜å‚¨è¿‡ç¨‹"><a href="#åˆ›å»ºå¾€-dept-è¡¨ä¸­æ’å…¥æ•°æ®çš„å­˜å‚¨è¿‡ç¨‹" class="headerlink" title="åˆ›å»ºå¾€ dept è¡¨ä¸­æ’å…¥æ•°æ®çš„å­˜å‚¨è¿‡ç¨‹"></a>åˆ›å»ºå¾€ dept è¡¨ä¸­æ’å…¥æ•°æ®çš„å­˜å‚¨è¿‡ç¨‹</h4><figure class="highlight oxygene"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs oxygene">--æ‰§è¡Œå­˜å‚¨è¿‡ç¨‹ï¼Œå¾€ dept è¡¨æ·»åŠ éšæœºæ•°æ®<br>DELIMITER $$<br><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">PROCEDURE</span> `<span class="hljs-title function_">insert_dept</span>`<span class="hljs-params">( max_num INT )</span><br><span class="hljs-title function_">BEGIN</span><br><span class="hljs-title function_">DECLARE</span> <span class="hljs-title function_">i</span> <span class="hljs-title function_">INT</span> <span class="hljs-title function_">DEFAULT</span> 0;<br><span class="hljs-keyword">SET</span> autocommit = <span class="hljs-number">0</span><span class="hljs-punctuation">;</span><br><span class="hljs-keyword">REPEAT</span><br><span class="hljs-keyword">SET</span> i = i + <span class="hljs-number">1</span><span class="hljs-punctuation">;</span><br>INSERT <span class="hljs-keyword">INTO</span> dept ( deptname,address,ceo ) VALUES (rand_string(<span class="hljs-number">8</span>),rand_string(<span class="hljs-number">10</span>),rand_num(<span class="hljs-number">1</span>,<span class="hljs-number">500000</span>))<span class="hljs-punctuation">;</span><br><span class="hljs-keyword">UNTIL</span> i = max_num<br><span class="hljs-keyword">END</span> <span class="hljs-keyword">REPEAT</span><span class="hljs-punctuation">;</span><br>COMMIT<span class="hljs-punctuation">;</span><br><span class="hljs-keyword">END</span>$$<br><br>--åˆ é™¤<br>-- DELIMITER <span class="hljs-punctuation">;</span><br>-- drop <span class="hljs-keyword">PROCEDURE</span> <span class="hljs-title function_">insert_dept</span>;<span class="hljs-keyword">Copy</span><br></code></pre></td></tr></table></figure><h3 id="è°ƒç”¨å­˜å‚¨è¿‡ç¨‹"><a href="#è°ƒç”¨å­˜å‚¨è¿‡ç¨‹" class="headerlink" title="è°ƒç”¨å­˜å‚¨è¿‡ç¨‹"></a>è°ƒç”¨å­˜å‚¨è¿‡ç¨‹</h3><h4 id="æ·»åŠ æ•°æ®åˆ°éƒ¨é—¨è¡¨"><a href="#æ·»åŠ æ•°æ®åˆ°éƒ¨é—¨è¡¨" class="headerlink" title="æ·»åŠ æ•°æ®åˆ°éƒ¨é—¨è¡¨"></a>æ·»åŠ æ•°æ®åˆ°éƒ¨é—¨è¡¨</h4><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-comment">--æ‰§è¡Œå­˜å‚¨è¿‡ç¨‹ï¼Œå¾€ dept è¡¨æ·»åŠ  1 ä¸‡æ¡æ•°æ®</span><br><span class="hljs-keyword">DELIMITER</span> ;<br><span class="hljs-keyword">CALL</span> insert_dept(<span class="hljs-number">10000</span>);<span class="hljs-keyword">Copy</span><br></code></pre></td></tr></table></figure><h4 id="æ·»åŠ æ•°æ®åˆ°å‘˜å·¥è¡¨"><a href="#æ·»åŠ æ•°æ®åˆ°å‘˜å·¥è¡¨" class="headerlink" title="æ·»åŠ æ•°æ®åˆ°å‘˜å·¥è¡¨"></a>æ·»åŠ æ•°æ®åˆ°å‘˜å·¥è¡¨</h4><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-comment">--æ‰§è¡Œå­˜å‚¨è¿‡ç¨‹ï¼Œå¾€ emp è¡¨æ·»åŠ  50 ä¸‡æ¡æ•°æ®</span><br><span class="hljs-keyword">DELIMITER</span> ;<br><span class="hljs-keyword">CALL</span> insert_emp(<span class="hljs-number">100000</span>,<span class="hljs-number">500000</span>);<span class="hljs-keyword">Copy</span><br></code></pre></td></tr></table></figure><h3 id="æ‰¹é‡åˆ é™¤æŸä¸ªè¡¨ä¸Šçš„æ‰€æœ‰ç´¢å¼•"><a href="#æ‰¹é‡åˆ é™¤æŸä¸ªè¡¨ä¸Šçš„æ‰€æœ‰ç´¢å¼•" class="headerlink" title="æ‰¹é‡åˆ é™¤æŸä¸ªè¡¨ä¸Šçš„æ‰€æœ‰ç´¢å¼•"></a>æ‰¹é‡åˆ é™¤æŸä¸ªè¡¨ä¸Šçš„æ‰€æœ‰ç´¢å¼•</h3><h4 id="åˆ é™¤ç´¢å¼•çš„å­˜å‚¨è¿‡ç¨‹"><a href="#åˆ é™¤ç´¢å¼•çš„å­˜å‚¨è¿‡ç¨‹" class="headerlink" title="åˆ é™¤ç´¢å¼•çš„å­˜å‚¨è¿‡ç¨‹"></a>åˆ é™¤ç´¢å¼•çš„å­˜å‚¨è¿‡ç¨‹</h4><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-keyword">DELIMITER</span> $$<span class="language-pgsql"></span><br><span class="language-pgsql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">PROCEDURE</span> `proc_drop_index`(dbname <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">200</span>),tablename <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">200</span>))</span><br><span class="language-pgsql"><span class="hljs-keyword">BEGIN</span></span><br><span class="language-pgsql"><span class="hljs-keyword">DECLARE</span> done <span class="hljs-type">INT</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-number">0</span>;</span><br><span class="language-pgsql"><span class="hljs-keyword">DECLARE</span> ct <span class="hljs-type">INT</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-number">0</span>;</span><br><span class="language-pgsql"><span class="hljs-keyword">DECLARE</span> _index <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">200</span>) <span class="hljs-keyword">DEFAULT</span> <span class="hljs-string">&#x27;&#x27;</span>;</span><br><span class="language-pgsql"><span class="hljs-keyword">DECLARE</span> _cur <span class="hljs-keyword">CURSOR</span> <span class="hljs-keyword">FOR</span> <span class="hljs-keyword">SELECT</span> index_name <span class="hljs-keyword">FROM</span> information_schema.<span class="hljs-keyword">STATISTICS</span> <span class="hljs-keyword">WHERE</span></span><br><span class="language-pgsql">table_schema=dbname <span class="hljs-keyword">AND</span> <span class="hljs-built_in">table_name</span>=tablename <span class="hljs-keyword">AND</span> seq_in_index=<span class="hljs-number">1</span> <span class="hljs-keyword">AND</span> index_name &lt;&gt;<span class="hljs-string">&#x27;PRIMARY&#x27;</span> ;</span><br><span class="language-pgsql"><span class="hljs-keyword">DECLARE</span> <span class="hljs-keyword">CONTINUE</span> <span class="hljs-keyword">HANDLER</span> <span class="hljs-keyword">FOR</span> <span class="hljs-keyword">NOT</span> <span class="hljs-built_in">FOUND</span> <span class="hljs-keyword">set</span> done=<span class="hljs-number">2</span> ;</span><br><span class="language-pgsql"><span class="hljs-keyword">OPEN</span> _cur;</span><br><span class="language-pgsql"><span class="hljs-keyword">FETCH</span> _cur <span class="hljs-keyword">INTO</span> _index;</span><br><span class="language-pgsql"><span class="hljs-keyword">WHILE</span> _index&lt;&gt;<span class="hljs-string">&#x27;&#x27;</span> <span class="hljs-keyword">DO</span></span><br><span class="language-pgsql"><span class="hljs-keyword">SET</span> @str = CONCAT(&quot;drop index &quot;,_index,&quot; on &quot;,tablename );</span><br><span class="language-pgsql"><span class="hljs-keyword">PREPARE</span> sql_str <span class="hljs-keyword">FROM</span> @str ;</span><br><span class="language-pgsql"><span class="hljs-keyword">EXECUTE</span> sql_str;</span><br><span class="language-pgsql"><span class="hljs-keyword">DEALLOCATE</span> <span class="hljs-keyword">PREPARE</span> sql_str;</span><br><span class="language-pgsql"><span class="hljs-keyword">SET</span> _index=<span class="hljs-string">&#x27;&#x27;</span>;</span><br><span class="language-pgsql"><span class="hljs-keyword">FETCH</span> _cur <span class="hljs-keyword">INTO</span> _index;</span><br><span class="language-pgsql"><span class="hljs-keyword">END</span> <span class="hljs-keyword">WHILE</span>;</span><br><span class="language-pgsql"><span class="hljs-keyword">CLOSE</span> _cur;</span><br><span class="language-pgsql"><span class="hljs-keyword">END</span>$$</span><span class="hljs-keyword">Copy</span><br></code></pre></td></tr></table></figure><h4 id="æ‰§è¡Œå­˜å‚¨è¿‡ç¨‹"><a href="#æ‰§è¡Œå­˜å‚¨è¿‡ç¨‹" class="headerlink" title="æ‰§è¡Œå­˜å‚¨è¿‡ç¨‹"></a>æ‰§è¡Œå­˜å‚¨è¿‡ç¨‹</h4><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gradle"><span class="hljs-keyword">CALL</span> proc_drop_index(<span class="hljs-string">&quot;dbname&quot;</span>,<span class="hljs-string">&quot;tablename&quot;</span>);<span class="hljs-keyword">Copy</span><br></code></pre></td></tr></table></figure><h1 id="ä¹ã€MySQLé”æœºåˆ¶"><a href="#ä¹ã€MySQLé”æœºåˆ¶" class="headerlink" title="ä¹ã€MySQLé”æœºåˆ¶"></a>ä¹ã€MySQLé”æœºåˆ¶</h1><h2 id="1ã€è¡¨é”"><a href="#1ã€è¡¨é”" class="headerlink" title="1ã€è¡¨é”"></a>1ã€è¡¨é”</h2><p><strong>MylSAMå¼•æ“ä½¿ç”¨è¡¨é”ï¼Œå¹¶ä¸”ä¸æ”¯æŒäº‹åŠ¡</strong></p><p><strong>SQLè¯­å¥</strong></p><figure class="highlight cos"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs cos">--å±•ç¤ºè¡¨æ˜¯å¦åŠ é”<br>SHOW <span class="hljs-keyword">OPEN</span> TABLES<span class="hljs-comment">;</span><br><br>--åŠ é” <span class="hljs-keyword">read</span> (è¯»é”) <span class="hljs-keyword">write</span> (å†™é”)<br><span class="hljs-keyword">LOCK</span> TABLE table1 <span class="hljs-keyword">read</span>(<span class="hljs-keyword">write</span>), table2 <span class="hljs-keyword">read</span>(<span class="hljs-keyword">write</span>)...<br><br>--å…¨éƒ¨è§£é”<br>UNLOCK TABLES<span class="hljs-comment">;Copy</span><br></code></pre></td></tr></table></figure><h3 id="è¯»é”"><a href="#è¯»é”" class="headerlink" title="è¯»é”"></a>è¯»é”</h3><ul><li>ä¸»æœºAç»™è¡¨åŠ ä¸Š<strong>è¡¨é”ï¼ˆè¯»é”ï¼‰</strong>ä»¥å<ul><li>ä¸»æœºAå’Œå…¶ä»–ä¸»æœºéƒ½å¯ä»¥è¯»å–<strong>è¯¥è¡¨</strong>çš„ä¿¡æ¯</li><li><strong>ä¸»æœºAä¸èƒ½è¯»å–åº“ä¸­å…¶ä»–è¡¨çš„ä¿¡æ¯</strong>ï¼Œä½†å…¶ä»–ä¸»æœºå¯ä»¥è¯»å–åº“ä¸­æ‰€æœ‰è¡¨çš„ä¿¡æ¯</li><li>å¦‚æœè¦ä¿®æ”¹è¢«é”è¡¨çš„ä¿¡æ¯<ul><li>ä¸»æœºAå¦‚æœå¯¹è¡¨è¿›è¡Œä¿®æ”¹ï¼Œ<strong>ä¼šä¿®æ”¹å¤±è´¥</strong></li><li>å…¶ä»–ä¸»æœºå¯¹è¡¨è¿›è¡Œä¿®æ”¹ï¼Œ<strong>ä¼šè¢«é˜»å¡ï¼Œç›´åˆ°é”è¢«é‡Šæ”¾</strong></li></ul></li></ul></li></ul><p><strong>æ¼”ç¤º</strong></p><ul><li><p>ç»™deptè¡¨åŠ é”å¹¶æŸ¥è¯¢çŠ¶æ€</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-keyword">LOCK</span> <span class="hljs-keyword">TABLE</span> dept <span class="hljs-keyword">READ</span>;<br><br><span class="hljs-keyword">SHOW</span> <span class="hljs-keyword">OPEN</span> <span class="hljs-keyword">TABLES</span>;<span class="hljs-keyword">Copy</span><br></code></pre></td></tr></table></figure><p><a href="https://nyimapicture.oss-cn-beijing.aliyuncs.com/img/20200820151441.png"><img src="/mysql2.assets/20200820151441.png" alt="img"></a></p></li></ul><p><strong>è¯»å–</strong></p><ul><li><p>ä¸¤ä¸ªå®¢æˆ·ç«¯åˆ†åˆ«è¯»å–deptè¡¨çš„ä¿¡æ¯ï¼Œéƒ½èƒ½è¯»å‡ºæ¥</p><figure class="highlight oxygene"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs oxygene"><span class="hljs-keyword">SELECT</span> id <span class="hljs-keyword">FROM</span> dept <span class="hljs-keyword">WHERE</span> id = <span class="hljs-number">1</span><span class="hljs-punctuation">;</span><span class="hljs-keyword">Copy</span><br></code></pre></td></tr></table></figure></li><li><p>å®¢æˆ·ç«¯Aï¼ˆåŠ é”ç«¯ï¼‰A<strong>è¯»å–å…¶ä»–è¡¨</strong>ä¿¡æ¯ï¼Œ<strong>è¯»å–å¤±è´¥</strong></p><figure class="highlight oxygene"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs oxygene"><span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> t_emp<span class="hljs-punctuation">;</span><span class="hljs-keyword">Copy</span><br></code></pre></td></tr></table></figure><p><a href="https://nyimapicture.oss-cn-beijing.aliyuncs.com/img/20200820152614.png"><img src="/mysql2.assets/20200820152614.png" alt="img"></a></p></li><li><p>å…¶ä»–å®¢æˆ·ç«¯è¯»å–åº¦å…¶ä»–è¡¨ä¿¡æ¯ï¼Œè¯»å–æˆåŠŸ</p><figure class="highlight oxygene"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs oxygene"><span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> t_emp<span class="hljs-punctuation">;</span><span class="hljs-keyword">Copy</span><br></code></pre></td></tr></table></figure><p><a href="https://nyimapicture.oss-cn-beijing.aliyuncs.com/img/20200820152714.png"><img src="/mysql2.assets/20200820152714.png" alt="img"></a></p></li></ul><p><strong>ä¿®æ”¹</strong></p><ul><li><p>å®¢æˆ·ç«¯Aå¯¹è¡¨ä¸­å†…å®¹è¿›è¡Œä¿®æ”¹ï¼Œ<strong>ä¿®æ”¹å¤±è´¥</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">DELETE</span> <span class="hljs-keyword">FROM</span> dept <span class="hljs-keyword">WHERE</span> id <span class="hljs-operator">=</span> <span class="hljs-number">1</span>;<span class="hljs-keyword">Copy</span><br></code></pre></td></tr></table></figure><p><a href="https://nyimapicture.oss-cn-beijing.aliyuncs.com/img/20200820151654.png"><img src="/mysql2.assets/20200820151654.png" alt="img"></a></p></li><li><p>å®¢æˆ·ç«¯Bå¯¹è¡¨ä¸­å†…å®¹è¿›è¡Œä¿®æ”¹ï¼Œè¿›å…¥é˜»å¡çŠ¶æ€</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">DELETE</span> <span class="hljs-keyword">FROM</span> dept <span class="hljs-keyword">WHERE</span> id <span class="hljs-operator">=</span> <span class="hljs-number">1</span>;<span class="hljs-keyword">Copy</span><br></code></pre></td></tr></table></figure></li></ul><p><a href="https://nyimapicture.oss-cn-beijing.aliyuncs.com/img/20200820151737.png"><img src="/mysql2.assets/20200820151737.png" alt="img"></a></p><ul><li><p>ä»å®¢æˆ·ç«¯Aè§£é”åï¼Œå®¢æˆ·ç«¯Bä¿®æ”¹æˆåŠŸ</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">UNLOCK <span class="hljs-keyword">TABLES</span>;<span class="hljs-keyword">Copy</span><br></code></pre></td></tr></table></figure><p><a href="https://nyimapicture.oss-cn-beijing.aliyuncs.com/img/20200820151818.png"><img src="/mysql2.assets/20200820151818.png" alt="img"></a></p></li></ul><h3 id="å†™é”"><a href="#å†™é”" class="headerlink" title="å†™é”"></a>å†™é”</h3><p>ä¸»æœºAç»™è¡¨åŠ ä¸Š<strong>è¡¨é”ï¼ˆå†™é”ï¼‰</strong>ä»¥å</p><ul><li>ä¸»æœºAå¯ä»¥è¯»å–è¯¥è¡¨ä¿¡æ¯ï¼Œä½†<strong>å…¶ä»–ä¸»æœºè¯»å–æ—¶ï¼Œä¼šè¿›å…¥é˜»å¡çŠ¶æ€ï¼ŒçŸ¥é“è¯»é”è¢«é‡Šæ”¾</strong></li><li><strong>ä¸»æœºAä¸èƒ½è¯»å–åº“ä¸­å…¶ä»–è¡¨çš„ä¿¡æ¯</strong>ï¼Œä½†å…¶ä»–ä¸»æœºå¯ä»¥è¯»å–åº“ä¸­<strong>é™¤è¯¥è¡¨ä»¥å¤–æ‰€æœ‰è¡¨</strong>çš„ä¿¡æ¯</li><li>å¦‚æœè¦ä¿®æ”¹è¢«é”è¡¨çš„ä¿¡æ¯<ul><li>ä¸»æœºAå¦‚æœå¯¹è¡¨è¿›è¡Œä¿®æ”¹ï¼Œä¿®æ”¹æˆåŠŸ</li><li>å…¶ä»–ä¸»æœºå¯¹è¡¨è¿›è¡Œä¿®æ”¹ï¼Œ<strong>ä¼šè¢«é˜»å¡ï¼Œç›´åˆ°é”è¢«é‡Šæ”¾</strong></li></ul></li></ul><p><strong>æ¼”ç¤º</strong></p><ul><li><p>ç»™deptè¡¨åŠ ä¸Šå†™é”å¹¶æŸ¥çœ‹</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-keyword">LOCK</span> <span class="hljs-keyword">TABLE</span> dept <span class="hljs-keyword">WRITE</span>;<br><br><span class="hljs-keyword">SHOW</span> <span class="hljs-keyword">OPEN</span> <span class="hljs-keyword">TABLES</span>;<span class="hljs-keyword">Copy</span><br></code></pre></td></tr></table></figure><p><a href="https://nyimapicture.oss-cn-beijing.aliyuncs.com/img/20200820153259.png"><img src="/mysql2.assets/20200820153259.png" alt="img"></a></p></li></ul><p><strong>è¯»å–</strong></p><ul><li><p>å®¢æˆ·ç«¯AæŸ¥è¯¢è¯¥è¡¨å†…å®¹ï¼ŒæŸ¥è¯¢æˆåŠŸï¼›è¯»å–å…¶ä»–è¡¨ï¼Œè¯»å–å¤±è´¥</p><figure class="highlight oxygene"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs oxygene"><span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> dept<span class="hljs-punctuation">;</span><br><br><span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> t_emp<span class="hljs-punctuation">;</span><span class="hljs-keyword">Copy</span><br></code></pre></td></tr></table></figure><p><a href="https://nyimapicture.oss-cn-beijing.aliyuncs.com/img/20200820153403.png"><img src="/mysql2.assets/20200820153403.png" alt="img"></a></p></li></ul><p><a href="https://nyimapicture.oss-cn-beijing.aliyuncs.com/img/20200820153437.png"><img src="/mysql2.assets/20200820153437.png" alt="img"></a></p><ul><li><p>å…¶ä»–è¡¨è¯»å–è¯¥è¡¨ä¿¡æ¯ï¼Œè¿›å…¥é˜»å¡çŠ¶æ€</p><figure class="highlight oxygene"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs oxygene"><span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> dept<span class="hljs-punctuation">;</span><span class="hljs-keyword">Copy</span><br></code></pre></td></tr></table></figure><p><a href="https://nyimapicture.oss-cn-beijing.aliyuncs.com/img/20200820153517.png"><img src="/mysql2.assets/20200820153517.png" alt="img"></a></p></li><li><p>é‡Šæ”¾åï¼Œè¯»å–æˆåŠŸ</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">UNLOCK <span class="hljs-keyword">TABLES</span>;<span class="hljs-keyword">Copy</span><br></code></pre></td></tr></table></figure></li></ul><p><strong>ä¿®æ”¹</strong></p><ul><li><p>å®¢æˆ·ç«¯Aä¿®æ”¹<strong>è¯¥è¡¨</strong>å†…å®¹ï¼Œä¿®æ”¹æˆåŠŸ</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">DELETE</span> dept <span class="hljs-keyword">WHERE</span> id <span class="hljs-operator">=</span> <span class="hljs-number">2</span>;<span class="hljs-keyword">Copy</span><br></code></pre></td></tr></table></figure><p><a href="https://nyimapicture.oss-cn-beijing.aliyuncs.com/img/20200820153637.png"><img src="/mysql2.assets/20200820153637.png" alt="img"></a></p></li><li><p>å®¢æˆ·ç«¯Aä¿®æ”¹<strong>å…¶ä»–è¡¨</strong>å†…å®¹ï¼Œä¿®æ”¹å¤±è´¥</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">DELETE</span> <span class="hljs-keyword">FROM</span> t_emp <span class="hljs-keyword">WHERE</span> id <span class="hljs-operator">=</span> <span class="hljs-number">2</span>;<span class="hljs-keyword">Copy</span><br></code></pre></td></tr></table></figure><p><a href="https://nyimapicture.oss-cn-beijing.aliyuncs.com/img/20200820153710.png"><img src="/mysql2.assets/20200820153710.png" alt="img"></a></p></li><li><p>å…¶ä»–å®¢æˆ·ç«¯ä¿®æ”¹<strong>è¯¥è¡¨</strong>å†…å®¹ï¼Œè¿›å…¥é˜»å¡çŠ¶æ€</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">DELETE</span> <span class="hljs-keyword">FROM</span> t_emp <span class="hljs-keyword">WHERE</span> id <span class="hljs-operator">=</span> <span class="hljs-number">2</span>;<span class="hljs-keyword">Copy</span><br></code></pre></td></tr></table></figure></li></ul><h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p><strong>è¯»é”ä¸ä¼šé˜»å¡è¯»ï¼Œåªä¼šé˜»å¡å†™ã€‚ä½†æ˜¯å†™é”ä¼šé˜»å¡è¯»å’Œå†™ã€‚</strong></p><h2 id="2ã€è¡Œé”"><a href="#2ã€è¡Œé”" class="headerlink" title="2ã€è¡Œé”"></a>2ã€è¡Œé”</h2><p><strong>InnoDBä½¿ç”¨è¡Œé”ï¼Œå¹¶ä¸”æ”¯æŒäº‹åŠ¡</strong>ï¼Œäº‹åŠ¡ç›¸å…³å¯å‚è€ƒ <a href="https://nyimac.gitee.io/2020/08/11/MySQL%E5%9F%BA%E7%A1%80/#%E5%85%AD%E3%80%81%E4%BA%8B%E5%8A%A1"><strong>MySQLåŸºç¡€</strong></a></p><h3 id="ç‰¹ç‚¹"><a href="#ç‰¹ç‚¹" class="headerlink" title="ç‰¹ç‚¹"></a>ç‰¹ç‚¹</h3><p>å¦‚æœä¸¤ä¸ªå®¢æˆ·ç«¯<strong>å¯¹åŒä¸€æ¡è®°å½•è¿›è¡Œä¿®æ”¹</strong></p><ul><li>å®¢æˆ·ç«¯Aä¿®æ”¹åï¼Œæœªæäº¤ï¼ˆæœªcommitï¼‰ï¼Œæ­¤æ—¶å®¢æˆ·ç«¯Bä¿®æ”¹ï¼Œåˆ™ä¼šé˜»å¡</li><li>å®¢æˆ·ç«¯Aä¿®æ”¹åï¼Œæäº¤åï¼Œå®¢æˆ·ç«¯Bå†ä¿®æ”¹ï¼Œåˆ™ä¸ä¼šé˜»å¡</li></ul><p>å¦‚æœä¸¤ä¸ªå®¢æˆ·ç«¯åˆ†åˆ«<strong>å¯¹ä¸åŒçš„è®°å½•è¿›è¡Œä¿®æ”¹</strong>ï¼Œåˆ™ä¸ä¼šè¢«é˜»å¡</p><p><strong>ä¿®æ”¹åŒä¸€æ¡è®°å½•</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">--å…³é—­è‡ªåŠ¨æäº¤</span><br><span class="hljs-keyword">SET</span> autocommit <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br><br><span class="hljs-comment">--å®¢æˆ·ç«¯Aã€BæŸ¥è¯¢id=2çš„è®°å½•</span><br><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> t_emp <span class="hljs-keyword">WHERE</span> id <span class="hljs-operator">=</span> <span class="hljs-number">2</span>;<br><br><span class="hljs-comment">--å®¢æˆ·ç«¯Aè¿›è¡Œä¿®æ”¹æ“ä½œï¼ˆå°†å¹´é¾„æ”¹ä¸ºäº†80ï¼‰ï¼Œä½†æœªæäº¤</span><br><span class="hljs-keyword">UPDATE</span> t_emp <span class="hljs-keyword">SET</span> age <span class="hljs-operator">=</span> <span class="hljs-number">80</span> <span class="hljs-keyword">WHERE</span> id <span class="hljs-operator">=</span> <span class="hljs-number">2</span>;<br><br><span class="hljs-comment">--å®¢æˆ·ç«¯Aè¿›è¡ŒæŸ¥è¯¢</span><br><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> t_emp <span class="hljs-keyword">WHERE</span> id <span class="hljs-operator">=</span> <span class="hljs-number">2</span>;<br><br><span class="hljs-comment">--å®¢æˆ·ç«¯Bè¿›è¡ŒæŸ¥è¯¢</span><br><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> t_emp <span class="hljs-keyword">WHERE</span> id <span class="hljs-operator">=</span> <span class="hljs-number">2</span>;<br><br><span class="hljs-comment">--å®¢æˆ·ç«¯Bè¿›è¡Œä¿®æ”¹ï¼ˆå®¢æˆ·ç«¯Aæœªæäº¤ï¼‰</span><br><span class="hljs-keyword">UPDATE</span> t_emp <span class="hljs-keyword">SET</span> age <span class="hljs-operator">=</span> <span class="hljs-number">90</span> <span class="hljs-keyword">WHERE</span> id <span class="hljs-operator">=</span> <span class="hljs-number">2</span>;<br><br><span class="hljs-comment">--å®¢æˆ·ç«¯Aæäº¤</span><br><span class="hljs-keyword">COMMIT</span>;<br><br><span class="hljs-comment">--å®¢æˆ·ç«¯Bæäº¤</span><br><span class="hljs-keyword">COMMIT</span>;<span class="hljs-keyword">Copy</span><br></code></pre></td></tr></table></figure><p><strong>å¯¹åº”ç»“æœ</strong></p><p>å®¢æˆ·ç«¯AæŸ¥è¯¢ç»“æœ</p><p><a href="https://nyimapicture.oss-cn-beijing.aliyuncs.com/img/20200820163718.png"><img src="/mysql2.assets/20200820163718.png" alt="img"></a></p><p>å®¢æˆ·ç«¯BæŸ¥è¯¢ç»“æœ</p><p><a href="https://nyimapicture.oss-cn-beijing.aliyuncs.com/img/20200820163718.png"><img src="/mysql2.assets/20200820163718.png" alt="img"></a></p><p>å®¢æˆ·ç«¯Aä¿®æ”¹åAæŸ¥è¯¢</p><p><a href="https://nyimapicture.oss-cn-beijing.aliyuncs.com/img/20200820163847.png"><img src="/mysql2.assets/20200820163847.png" alt="img"></a></p><p>å®¢æˆ·ç«¯Aä¿®æ”¹åBæŸ¥è¯¢</p><p><a href="https://nyimapicture.oss-cn-beijing.aliyuncs.com/img/20200820163718.png"><img src="/mysql2.assets/20200820163718.png" alt="img"></a></p><p>å®¢æˆ·ç«¯Aä¿®æ”¹ï¼Œæœªæäº¤ï¼Œæ­¤æ—¶Bè¿›è¡Œä¿®æ”¹ï¼Œ<strong>è¢«é˜»å¡</strong></p><p><a href="https://nyimapicture.oss-cn-beijing.aliyuncs.com/img/20200820163957.png"><img src="/mysql2.assets/20200820163957.png" alt="img"></a></p><p>å®¢æˆ·ç«¯Aæäº¤åï¼ŒBä¿®æ”¹æˆåŠŸ</p><p><a href="https://nyimapicture.oss-cn-beijing.aliyuncs.com/img/20200820164036.png"><img src="/mysql2.assets/20200820164036.png" alt="img"></a></p><p><strong>ä¿®æ”¹ä¸åŒè®°å½•</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">--å®¢æˆ·ç«¯Aå¯¹id=2çš„å¹´é¾„è¿›è¡Œä¿®æ”¹</span><br><span class="hljs-keyword">UPDATE</span> t_emp <span class="hljs-keyword">SET</span> age <span class="hljs-operator">=</span> <span class="hljs-number">90</span> <span class="hljs-keyword">WHERE</span> id <span class="hljs-operator">=</span> <span class="hljs-number">2</span>;<br><br><span class="hljs-comment">--å®¢æˆ·ç«¯Bå¯¹id=3çš„å¹´é¾„è¿›è¡Œä¿®æ”¹</span><br><span class="hljs-keyword">UPDATE</span> t_emp <span class="hljs-keyword">SET</span> age <span class="hljs-operator">=</span> <span class="hljs-number">30</span> <span class="hljs-keyword">WHERE</span> id <span class="hljs-operator">=</span> <span class="hljs-number">3</span>;<br><br><span class="hljs-comment">--å®¢æˆ·ç«¯Aï¼ŒBåˆ†åˆ«æäº¤</span><br><span class="hljs-keyword">COMMIT</span>;<br><span class="hljs-keyword">COMMIT</span>;<span class="hljs-keyword">Copy</span><br></code></pre></td></tr></table></figure><p>å› ä¸ºInnoDBä½¿ç”¨è¡Œé”ï¼Œå¯¹äºä¸åŒè¡Œçš„æ“ä½œï¼Œä¸ä¼šå‡ºç°é˜»å¡ç°è±¡</p><h3 id="ç´¢å¼•å¤±æ•ˆ-1"><a href="#ç´¢å¼•å¤±æ•ˆ-1" class="headerlink" title="ç´¢å¼•å¤±æ•ˆ"></a>ç´¢å¼•å¤±æ•ˆ</h3><p>ç´¢å¼•å¤±æ•ˆï¼Œ<strong>è¡Œé”å˜è¡¨é”</strong></p><p>å½“<strong>ç´¢å¼•å¤±æ•ˆ</strong>åï¼Œå³ä½¿å¤šä¸ªå®¢æˆ·ç«¯æ“ä½œçš„ä¸æ˜¯åŒä¸€æ¡è®°å½•ï¼Œ<strong>å¦‚æœæœªæäº¤ï¼Œå…¶ä»–å®¢æˆ·ç«¯ä¹Ÿä¼šè¿›å…¥é˜»å¡çŠ¶æ€</strong></p><p>æ‰€ä»¥è¦<strong>é¿å…ç´¢å¼•å¤±æ•ˆ</strong></p><h3 id="é—´éš™é”å±å®³"><a href="#é—´éš™é”å±å®³" class="headerlink" title="é—´éš™é”å±å®³"></a>é—´éš™é”å±å®³</h3><h4 id="æ¦‚å¿µ-1"><a href="#æ¦‚å¿µ-1" class="headerlink" title="æ¦‚å¿µ"></a>æ¦‚å¿µ</h4><p>å½“æˆ‘ä»¬ç”¨<strong>èŒƒå›´æ¡ä»¶</strong>è€Œä¸æ˜¯ç›¸ç­‰æ¡ä»¶æ£€ç´¢æ•°æ®ï¼Œå¹¶è¯·æ±‚å…±äº«æˆ–æ’ä»–é”æ—¶ï¼ŒInnoDBä¼šç»™ç¬¦åˆæ¡ä»¶çš„å·²æœ‰æ•°æ®è®°å½•çš„ç´¢å¼•é¡¹åŠ é”</p><p>å¯¹äºé”®å€¼<strong>åœ¨æ¡ä»¶èŒƒå›´å†…ä½†å¹¶ä¸å­˜åœ¨çš„è®°å½•</strong>ï¼Œå«åš<strong>â€œé—´éš™(GAP)<strong>â€ ï¼Œ</strong>InnoDBä¹Ÿä¼šå¯¹è¿™ä¸ªâ€œé—´éš™â€åŠ é”</strong>ï¼Œè¿™ç§é”æœºåˆ¶å°±æ˜¯æ‰€è°“çš„é—´éš™é”(Next-Keyé”)ã€‚</p><h4 id="å±å®³"><a href="#å±å®³" class="headerlink" title="å±å®³"></a>å±å®³</h4><p>å› ä¸ºQueryæ‰§è¡Œè¿‡ç¨‹ä¸­é€šè¿‡è¿‡èŒƒå›´æŸ¥æ‰¾çš„è¯ï¼Œä»–ä¼šé”å®šæ•´ä¸ªèŒƒå›´å†…æ‰€æœ‰çš„ç´¢å¼•é”®å€¼ï¼Œå³ä½¿è¿™ä¸ªé”®å€¼å¹¶ä¸å­˜åœ¨ã€‚<br>é—´éš™é”æœ‰ä¸€ä¸ªæ¯”è¾ƒè‡´å‘½çš„å¼±ç‚¹ï¼Œå°±æ˜¯å½“é”å®šä¸€ä¸ªèŒƒå›´é”®å€¼ä¹‹åï¼Œå³ä½¿æŸäº›ä¸å­˜åœ¨çš„é”®å€¼ä¹Ÿä¼šè¢«æ— è¾œçš„é”å®šï¼Œè€Œé€ æˆåœ¨é”å®šçš„æ—¶å€™æ— æ³•æ’å…¥é”å®šé”®å€¼èŒƒå›´å†…çš„ä»»ä½•æ•°æ®ã€‚åœ¨æŸäº›åœºæ™¯ä¸‹è¿™å¯èƒ½ä¼šå¯¹æ€§èƒ½é€ æˆå¾ˆå¤§çš„å±å®³</p><h4 id="æ¼”ç¤º"><a href="#æ¼”ç¤º" class="headerlink" title="æ¼”ç¤º"></a>æ¼”ç¤º</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">--æŸ¥è¯¢è¡¨è®°å½•ï¼Œæ­¤å¤„æ²¡æœ‰id=2çš„è®°å½•</span><br><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> t_emp;<br><br><span class="hljs-comment">--å®¢æˆ·ç«¯Aè¿›è¡ŒèŒƒå›´æŸ¥è¯¢ï¼Œä½†æ˜¯èŒƒå›´å†…æ²¡æœ‰id=2çš„è®°å½•</span><br><span class="hljs-keyword">UPDATE</span> t_emp <span class="hljs-keyword">SET</span> deptId <span class="hljs-operator">=</span> <span class="hljs-number">1</span> <span class="hljs-keyword">WHERE</span> id<span class="hljs-operator">&gt;</span><span class="hljs-number">1</span> <span class="hljs-keyword">AND</span> id <span class="hljs-operator">&lt;</span> <span class="hljs-number">6</span>;<br><br><span class="hljs-comment">--å®¢æˆ·ç«¯Bè¿›è¡Œæ’å…¥æ•°æ®ï¼Œæ’å…¥ä¸€æ¡id=2çš„è®°å½•</span><br><span class="hljs-keyword">INSERT</span> t_emp <span class="hljs-keyword">VALUES</span>(<span class="hljs-number">2</span>, <span class="hljs-string">&#x27;å²³ä¸ç¾¤&#x27;</span>, <span class="hljs-number">11</span>, <span class="hljs-number">2</span>, <span class="hljs-number">100002</span>); <br><br><span class="hljs-comment">--å®¢æˆ·ç«¯Aæäº¤</span><br><span class="hljs-keyword">COMMIT</span>;<br><br><span class="hljs-comment">--å®¢æˆ·ç«¯Bæäº¤</span><br><span class="hljs-keyword">COMMIT</span>;<span class="hljs-keyword">Copy</span><br></code></pre></td></tr></table></figure><p><a href="https://nyimapicture.oss-cn-beijing.aliyuncs.com/img/20200820170126.png"><img src="/mysql2.assets/20200820170126.png" alt="img"></a></p><p><strong>å®¢æˆ·ç«¯Bè¿›å…¥é˜»å¡çŠ¶æ€</strong></p><p><a href="https://nyimapicture.oss-cn-beijing.aliyuncs.com/img/20200820170617.png"><img src="/mysql2.assets/20200820170617.png" alt="img"></a></p><p>æäº¤åï¼Œæ’å…¥æˆåŠŸ</p><p><a href="https://nyimapicture.oss-cn-beijing.aliyuncs.com/img/20200820170654.png"><img src="/mysql2.assets/20200820170654.png" alt="img"></a></p><p><strong>ç»“è®º</strong>ï¼šå¯ä»¥çœ‹åˆ°è¡¨ä¸­æœ¬æ¥<strong>æ²¡æœ‰id&#x3D;2çš„è®°å½•</strong>ï¼Œä½†æ˜¯åœ¨å®¢æˆ·ç«¯Aè¿›è¡Œ<strong>èŒƒå›´ä¿®æ”¹</strong>æ—¶ï¼Œå®¢æˆ·ç«¯Bå¯¹<strong>åœ¨èŒƒå›´å†…ä½†ä¸å­˜åœ¨çš„æ•°æ®è¿›è¡Œæ’å…¥æ—¶ï¼Œå®¢æˆ·ç«¯Bè¿›å…¥äº†é˜»å¡çŠ¶æ€</strong></p><h3 id="é”ä½æŒ‡å®šçš„ä¸€è¡Œ"><a href="#é”ä½æŒ‡å®šçš„ä¸€è¡Œ" class="headerlink" title="é”ä½æŒ‡å®šçš„ä¸€è¡Œ"></a>é”ä½æŒ‡å®šçš„ä¸€è¡Œ</h3><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-keyword">BEGIN</span>;<br><br><span class="hljs-comment">--é”ä½æŒ‡å®šçš„ä¸€è¡Œï¼Œå¦‚æœè¿›è¡Œæ›´æ–°æ“ä½œå°±æ˜¯ ... FOR UPDATEï¼Œåˆ é™¤æ“ä½œå°±æ˜¯ ... FOR DELETE ä»¥æ­¤ç±»æ¨</span><br><span class="hljs-keyword">SELECT</span> * <span class="hljs-keyword">FROM</span> t_emp <span class="hljs-keyword">WHERE</span> id = <span class="hljs-number">1</span> <span class="hljs-keyword">FOR</span> <span class="hljs-keyword">UPDATE</span>;<br><br><span class="hljs-comment">--è¿›è¡Œä¿®æ”¹æ“ä½œ</span><br><span class="hljs-keyword">UPDATE</span> t_emp <span class="hljs-keyword">SET</span> <span class="hljs-type">NAME</span> = <span class="hljs-string">&#x27;é£è½¦è½¦&#x27;</span> <span class="hljs-keyword">WHERE</span> id = <span class="hljs-number">1</span>;<br><br><span class="hljs-comment">--æäº¤</span><br><span class="hljs-keyword">COMMIT</span>;<span class="hljs-keyword">Copy</span><br></code></pre></td></tr></table></figure><p>å¦‚æœå½“æŸä¸€è¡Œè¢«é”ä½åï¼Œå…¶ä»–å®¢æˆ·ç«¯å¯¹æ”¹è¡Œè¿›è¡Œæ“ä½œï¼Œä¼šè¢«<strong>é˜»å¡</strong></p><h3 id="æ€»ç»“-1"><a href="#æ€»ç»“-1" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p>Innodbå­˜å‚¨å¼•æ“ç”±äºå®ç°äº†<strong>è¡Œçº§é”å®š</strong>ï¼Œè™½ç„¶åœ¨é”å®šæœºåˆ¶çš„å®ç°æ–¹é¢æ‰€å¸¦æ¥çš„æ€§èƒ½æŸè€—å¯èƒ½æ¯”è¡¨çº§é”å®šä¼šè¦æ›´é«˜ä¸€äº›ï¼Œ ä½†æ˜¯åœ¨æ•´ä½“<strong>å¹¶å‘å¤„ç†èƒ½åŠ›æ–¹é¢è¦è¿œè¿œä¼˜äºMyISAMçš„è¡¨çº§é”å®šçš„</strong>ã€‚å½“ç³»ç»Ÿå¹¶å‘é‡è¾ƒé«˜çš„æ—¶å€™ï¼ŒInnodbçš„æ•´ä½“æ€§èƒ½å’ŒMyISAMç›¸æ¯”å°±ä¼šæœ‰æ¯”è¾ƒæ˜æ˜¾çš„ä¼˜åŠ¿äº†ã€‚<br>ä½†æ˜¯ï¼ŒInnodbçš„è¡Œçº§é”å®šåŒæ ·ä¹Ÿæœ‰å…¶è„†å¼±çš„ä¸€é¢ï¼Œå½“æˆ‘ä»¬<strong>ä½¿ç”¨ä¸å½“çš„æ—¶å€™</strong>ï¼Œå¯èƒ½ä¼šè®©Innodbçš„æ•´ä½“æ€§èƒ½è¡¨ç°ä¸ä»…ä¸èƒ½æ¯”MylSAMé«˜ï¼Œç”šè‡³å¯èƒ½ä¼šæ›´å·®ã€‚</p><h1 id="åã€å¤åˆ¶"><a href="#åã€å¤åˆ¶" class="headerlink" title="åã€å¤åˆ¶"></a>åã€å¤åˆ¶</h1><h2 id="1ã€ä¸»ä»å¤åˆ¶"><a href="#1ã€ä¸»ä»å¤åˆ¶" class="headerlink" title="1ã€ä¸»ä»å¤åˆ¶"></a>1ã€ä¸»ä»å¤åˆ¶</h2><p>ä¸»è¦æ¶‰åŠä¸‰ä¸ªçº¿ç¨‹ï¼šbinlog çº¿ç¨‹ã€I&#x2F;O çº¿ç¨‹å’Œ SQL çº¿ç¨‹ã€‚</p><ul><li><strong>binlog çº¿ç¨‹</strong> ï¼šè´Ÿè´£å°†ä¸»æœåŠ¡å™¨ä¸Šçš„æ•°æ®æ›´æ”¹<strong>å†™å…¥äºŒè¿›åˆ¶æ—¥å¿—</strong>ï¼ˆBinary logï¼‰ä¸­ã€‚</li><li><strong>I&#x2F;O çº¿ç¨‹</strong> ï¼šè´Ÿè´£ä»ä¸»æœåŠ¡å™¨ä¸Šè¯»å–äºŒè¿›åˆ¶æ—¥å¿—ï¼Œå¹¶<strong>å†™å…¥ä»æœåŠ¡å™¨çš„ä¸­ç»§æ—¥å¿—</strong>ï¼ˆRelay logï¼‰ã€‚</li><li><strong>SQL çº¿ç¨‹</strong> ï¼šè´Ÿè´£<strong>è¯»å–ä¸­ç»§æ—¥å¿—</strong>ï¼Œè§£æå‡ºä¸»æœåŠ¡å™¨å·²ç»æ‰§è¡Œçš„æ•°æ®æ›´æ”¹å¹¶åœ¨ä»æœåŠ¡å™¨ä¸­é‡æ”¾ï¼ˆReplayï¼‰ã€‚</li></ul><p><a href="https://nyimapicture.oss-cn-beijing.aliyuncs.com/img/20200822133613.png"><img src="/mysql2.assets/20200822133613.png" alt="img"></a></p><h2 id="2ã€è¯»å†™åˆ†ç¦»"><a href="#2ã€è¯»å†™åˆ†ç¦»" class="headerlink" title="2ã€è¯»å†™åˆ†ç¦»"></a>2ã€è¯»å†™åˆ†ç¦»</h2><p><strong>ä¸»æœåŠ¡å™¨å¤„ç†å†™æ“ä½œ</strong>ä»¥åŠå®æ—¶æ€§è¦æ±‚æ¯”è¾ƒé«˜çš„è¯»æ“ä½œï¼Œè€Œ<strong>ä»æœåŠ¡å™¨å¤„ç†è¯»æ“ä½œ</strong></p><p>è¯»å†™åˆ†ç¦»èƒ½æé«˜æ€§èƒ½çš„åŸå› åœ¨äºï¼š</p><ul><li>ä¸»ä»æœåŠ¡å™¨è´Ÿè´£å„è‡ªçš„è¯»å’Œå†™ï¼Œæå¤§ç¨‹åº¦<strong>ç¼“è§£äº†é”çš„äº‰ç”¨</strong></li><li><strong>ä»æœåŠ¡å™¨</strong>å¯ä»¥ä½¿ç”¨ <a href="https://nyimac.gitee.io/2020/08/16/MySQL%E9%AB%98%E7%BA%A7/#%E5%BC%95%E6%93%8E%E5%B1%82">MyISAM</a>ï¼Œæå‡æŸ¥è¯¢æ€§èƒ½ä»¥åŠèŠ‚çº¦ç³»ç»Ÿå¼€é”€</li><li>å¢åŠ å†—ä½™ï¼Œæé«˜å¯ç”¨æ€§</li></ul><p>è¯»å†™åˆ†ç¦»å¸¸ç”¨ä»£ç†æ–¹å¼æ¥å®ç°ï¼Œä»£ç†æœåŠ¡å™¨æ¥æ”¶åº”ç”¨å±‚ä¼ æ¥çš„è¯»å†™è¯·æ±‚ï¼Œç„¶åå†³å®šè½¬å‘åˆ°å“ªä¸ªæœåŠ¡å™¨</p><p><a href="https://nyimapicture.oss-cn-beijing.aliyuncs.com/img/20200822133739.png"><img src="/mysql2.assets/20200822133739.png" alt="img"></a></p>]]></content>
    
    
    
    <tags>
      
      <tag>mysql</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Javaå¹¶å‘</title>
    <link href="/2022/03/11/javac_oncurrency/"/>
    <url>/2022/03/11/javac_oncurrency/</url>
    
    <content type="html"><![CDATA[]]></content>
    
    
    
    <tags>
      
      <tag>java</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>MysqlåŸºç¡€</title>
    <link href="/2022/03/11/mysql1/"/>
    <url>/2022/03/11/mysql1/</url>
    
    <content type="html"><![CDATA[<h1 id="ä¸€ã€Mysqlå®‰è£…ä»¥åŠé…ç½®"><a href="#ä¸€ã€Mysqlå®‰è£…ä»¥åŠé…ç½®" class="headerlink" title="ä¸€ã€Mysqlå®‰è£…ä»¥åŠé…ç½®"></a>ä¸€ã€Mysqlå®‰è£…ä»¥åŠé…ç½®</h1><p>LInuxï¼šç§»æ­¥<a href="https://zhuanlan.zhihu.com/p/472517343">Linux (centos)å®‰è£…Mysql8.0+ - çŸ¥ä¹ (zhihu.com)</a></p><p>Windowï¼šè¿›å…¥Oracleå®˜ç½‘ä¸‹è½½msiæˆ–è€…zipå‹ç¼©åŒ…å³å¯</p><h1 id="äºŒã€MysqlåŸºæœ¬æ“ä½œè¯­å¥"><a href="#äºŒã€MysqlåŸºæœ¬æ“ä½œè¯­å¥" class="headerlink" title="äºŒã€MysqlåŸºæœ¬æ“ä½œè¯­å¥"></a>äºŒã€MysqlåŸºæœ¬æ“ä½œè¯­å¥</h1><p>ç§»æ­¥ï¼š<a href="https://www.runoob.com/sql/sql-tutorial.html">https://www.runoob.com/sql/sql-tutorial.html</a></p><h1 id="ä¸‰ã€Mysqlå‡½æ•°å’Œå­˜å‚¨è¿‡ç¨‹"><a href="#ä¸‰ã€Mysqlå‡½æ•°å’Œå­˜å‚¨è¿‡ç¨‹" class="headerlink" title="ä¸‰ã€Mysqlå‡½æ•°å’Œå­˜å‚¨è¿‡ç¨‹"></a>ä¸‰ã€Mysqlå‡½æ•°å’Œå­˜å‚¨è¿‡ç¨‹</h1><p>MySQLçš„å­˜å‚¨è¿‡ç¨‹ï¼ˆstored procedureï¼‰å’Œå‡½æ•°ï¼ˆstored functionï¼‰ç»Ÿç§°ä¸ºstored routinesã€‚å®ƒæ˜¯äº‹å…ˆç»è¿‡ç¼–è¯‘å¹¶å­˜å‚¨åœ¨æ•°æ®åº“ä¸­çš„ä¸€æ®µSQLè¯­å¥çš„é›†åˆã€‚</p><p><strong>å­˜å‚¨è¿‡ç¨‹ï¼ˆStored Procedureï¼‰</strong>æ˜¯ä¸€ç§åœ¨æ•°æ®åº“ä¸­å­˜å‚¨å¤æ‚ç¨‹åºï¼Œä»¥ä¾¿å¤–éƒ¨ç¨‹åºè°ƒç”¨çš„ä¸€ç§æ•°æ®åº“å¯¹è±¡ã€‚å­˜å‚¨è¿‡ç¨‹æ˜¯ä¸ºäº†å®Œæˆç‰¹å®šåŠŸèƒ½çš„SQLè¯­å¥é›†ï¼Œç»ç¼–è¯‘åˆ›å»ºå¹¶ä¿å­˜åœ¨æ•°æ®åº“ä¸­ï¼Œç”¨æˆ·å¯é€šè¿‡æŒ‡å®šå­˜å‚¨è¿‡ç¨‹çš„åå­—å¹¶ç»™å®šå‚æ•°(éœ€è¦æ—¶)æ¥è°ƒç”¨æ‰§è¡Œã€‚å­˜å‚¨è¿‡ç¨‹æ€æƒ³ä¸Šå¾ˆç®€å•ï¼Œå°±æ˜¯æ•°æ®åº“ SQL è¯­è¨€å±‚é¢çš„ä»£ç å°è£…ä¸é‡ç”¨ã€‚</p><p><strong>å‡½æ•°ï¼ˆStored Functionï¼‰</strong>ï¼šæ˜¯ç”±ä¸€ä¸ªæˆ–å¤šä¸ªSQLè¯­å¥ç»„æˆçš„å­ç¨‹åºï¼Œå¯ç”¨äºå°è£…ä»£ç ä»¥ä¾¿é‡æ–°ä½¿ç”¨ã€‚è‡ªå®šä¹‰å‡½æ•°è¯¸å¤šé™åˆ¶ï¼Œæœ‰è®¸å¤šè¯­å¥ä¸èƒ½ä½¿ç”¨ï¼Œè®¸å¤šåŠŸèƒ½ä¸èƒ½å®ç°ã€‚å‡½æ•°å¯ä»¥ç›´æ¥å¼•ç”¨è¿”å›å€¼ï¼Œç”¨è¡¨å˜é‡è¿”å›è®°å½•é›†ã€‚ä½†æ˜¯ï¼Œç”¨æˆ·å®šä¹‰å‡½æ•°ä¸èƒ½ç”¨äºæ‰§è¡Œä¸€ç»„ä¿®æ”¹å…¨å±€æ•°æ®åº“çŠ¶æ€çš„æ“ä½œã€‚</p><h2 id="1ã€å­˜å‚¨è¿‡ç¨‹ä¸å‡½æ•°çš„åŒºåˆ«"><a href="#1ã€å­˜å‚¨è¿‡ç¨‹ä¸å‡½æ•°çš„åŒºåˆ«" class="headerlink" title="1ã€å­˜å‚¨è¿‡ç¨‹ä¸å‡½æ•°çš„åŒºåˆ«"></a>1ã€<strong>å­˜å‚¨è¿‡ç¨‹ä¸å‡½æ•°çš„åŒºåˆ«</strong></h2><p>æœ¬è´¨ä¸Šæ²¡åŒºåˆ«ã€‚å‡½æ•°åªèƒ½é€šè¿‡returnè¯­å¥è¿”å›å•ä¸ªå€¼æˆ–è€…è¡¨å¯¹è±¡ã€‚è€Œå­˜å‚¨è¿‡ç¨‹ä¸å…è®¸æ‰§è¡Œreturnï¼Œä½†æ˜¯é€šè¿‡outå‚æ•°è¿”å›å¤šä¸ªå€¼ã€‚ å‡½æ•°æ˜¯å¯ä»¥åµŒå…¥åœ¨sqlä¸­ä½¿ç”¨çš„,å¯ä»¥åœ¨selectä¸­è°ƒç”¨ï¼Œè€Œå­˜å‚¨è¿‡ç¨‹ä¸è¡Œã€‚å‡½æ•°é™åˆ¶æ¯”è¾ƒå¤šï¼Œå¦‚ä¸èƒ½ç”¨ä¸´æ—¶è¡¨ï¼Œåªèƒ½ç”¨è¡¨å˜é‡ç­‰ï¼Œè€Œå­˜å‚¨è¿‡ç¨‹çš„é™åˆ¶ç›¸å¯¹å°±æ¯”è¾ƒå°‘ã€‚</p><ol><li>ä¸€èˆ¬æ¥è¯´ï¼Œå­˜å‚¨è¿‡ç¨‹å®ç°çš„åŠŸèƒ½è¦å¤æ‚ä¸€ç‚¹ï¼Œè€Œå‡½æ•°çš„å®ç°çš„åŠŸèƒ½é’ˆå¯¹æ€§æ¯”è¾ƒå¼º</li><li>å½“å¯¹æ•°æ®åº“è¿›è¡Œå¤æ‚æ“ä½œæ—¶(å¦‚å¯¹å¤šä¸ªè¡¨è¿›è¡ŒUpdateã€Insertã€Queryã€Deleteæ—¶ï¼‰ï¼Œå¯å°†æ­¤å¤æ‚æ“ä½œç”¨å­˜å‚¨è¿‡ç¨‹å°è£…èµ·æ¥ä¸æ•°æ®åº“æä¾›çš„äº‹åŠ¡å¤„ç†ç»“åˆä¸€èµ·ä½¿ç”¨ã€‚<a href="http://blog.csdn.net/xiaohutushen/article/details/1956429">å­˜å‚¨è¿‡ç¨‹å¯ä»¥ä»è‡ªå·±çš„å­˜å‚¨è¿‡ç¨‹å†…å¼•ç”¨å…¶å®ƒå­˜å‚¨è¿‡ç¨‹</a>ï¼Œè¿™å¯ä»¥ç®€åŒ–ä¸€ç³»åˆ—å¤æ‚è¯­å¥</li><li>å­˜å‚¨è¿‡ç¨‹ä¸€èˆ¬æ˜¯ä½œä¸ºä¸€ä¸ªç‹¬ç«‹çš„éƒ¨åˆ†æ¥æ‰§è¡Œï¼Œè€Œå‡½æ•°å¯ä»¥ä½œä¸ºæŸ¥è¯¢è¯­å¥çš„ä¸€ä¸ªéƒ¨åˆ†æ¥è°ƒç”¨ï¼Œç”±äºå‡½æ•°å¯ä»¥è¿”å›ä¸€ä¸ªè¡¨å¯¹è±¡ï¼Œå› æ­¤å®ƒå¯ä»¥åœ¨æŸ¥è¯¢è¯­å¥ä¸­ä½äºFROMå…³é”®å­—çš„åé¢</li><li>å­˜å‚¨è¿‡ç¨‹åªåœ¨åˆ›é€ æ—¶è¿›è¡Œç¼–è¯‘ï¼Œä»¥åæ¯æ¬¡æ‰§è¡Œå­˜å‚¨è¿‡ç¨‹éƒ½ä¸éœ€å†é‡æ–°ç¼–è¯‘ï¼Œè€Œä¸€èˆ¬SQLè¯­å¥æ¯æ‰§è¡Œä¸€æ¬¡å°±ç¼–è¯‘ä¸€æ¬¡,æ‰€ä»¥ä½¿ç”¨å­˜å‚¨è¿‡ç¨‹å¯æé«˜æ•°æ®åº“æ‰§è¡Œé€Ÿåº¦</li><li>å­˜å‚¨è¿‡ç¨‹å¯ä»¥æ¥å—å‚æ•°ã€è¾“å‡ºå‚æ•°ã€è¿”å›å•ä¸ªæˆ–å¤šä¸ªç»“æœé›†ä»¥åŠè¿”å›å€¼ï¼Œå¯ä»¥å‘ç¨‹åºè¿”å›é”™è¯¯åŸå› ã€‚ä½†å‡½æ•°åªèƒ½è¿”å›ä¸€ä¸ªç‰¹å®šç±»å‹çš„å€¼æˆ–è€…è¡¨å¯¹è±¡</li><li>å­˜å‚¨è¿‡ç¨‹ä¸­çš„CRUDçš„æ“ä½œä¼šå½±å“æ•°æ®åº“çŠ¶æ€ï¼Œä½†å‡½æ•°å´ä¸èƒ½</li><li>å‡½æ•°åªèƒ½æ˜¯inç±»å‹ï¼Œå­˜å‚¨è¿‡ç¨‹å¯ä»¥ä½¿ç”¨In\out\inoutç±»å‹</li></ol><h2 id="2ã€å‡½æ•°å®šä¹‰ä¸ä½¿ç”¨"><a href="#2ã€å‡½æ•°å®šä¹‰ä¸ä½¿ç”¨" class="headerlink" title="2ã€å‡½æ•°å®šä¹‰ä¸ä½¿ç”¨"></a>2ã€å‡½æ•°å®šä¹‰ä¸ä½¿ç”¨</h2><h2 id="3ã€å­˜å‚¨è¿‡ç¨‹å®šäºä¸ä½¿ç”¨"><a href="#3ã€å­˜å‚¨è¿‡ç¨‹å®šäºä¸ä½¿ç”¨" class="headerlink" title="3ã€å­˜å‚¨è¿‡ç¨‹å®šäºä¸ä½¿ç”¨"></a>3ã€å­˜å‚¨è¿‡ç¨‹å®šäºä¸ä½¿ç”¨</h2><h1 id="å››ã€çº¦æŸ"><a href="#å››ã€çº¦æŸ" class="headerlink" title="å››ã€çº¦æŸ"></a>å››ã€çº¦æŸ</h1><h2 id="1ã€ä¸»é”®"><a href="#1ã€ä¸»é”®" class="headerlink" title="1ã€ä¸»é”®"></a>1ã€ä¸»é”®</h2><p>èƒ½å¤Ÿå”¯ä¸€ç¡®å®šè¡¨ä¸­çš„ä¸€æ¡è®°å½•ã€‚æˆ‘ä»¬é€šè¿‡ç»™æŸä¸ªå­—æ®µæ·»åŠ è¯¥çº¦æŸï¼Œå°±å¯ä»¥ä½¿å¾—è¯¥å­—æ®µä¸é‡å¤ä¸”ä¸ä¸ºç©ºã€‚</p><figure class="highlight sql"><table><tr><td class="gutter"><div class="code-wrapper"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></div></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> <span class="hljs-keyword">user</span> (<br>id <span class="hljs-type">INT</span> <span class="hljs-keyword">PRIMARY</span> KEY,<br>name <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">20</span>)<br>);<br></code></pre></td></tr></table></figure><h2 id="2ã€è”åˆä¸»é”®"><a href="#2ã€è”åˆä¸»é”®" class="headerlink" title="2ã€è”åˆä¸»é”®"></a>2ã€è”åˆä¸»é”®</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> user2 (<br>id <span class="hljs-type">INT</span>,<br>name <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">20</span>),<br>    <span class="hljs-keyword">PRIMARY</span> KEY(id, name)<br>);<br></code></pre></td></tr></table></figure><p>æ­¤å¤„å­—æ®µidå’Œnameä¸€åŒä½œä¸ºä¸»é”®ï¼Œè”åˆä¸»é”®è¦æ±‚æ¯ä¸ªå­—æ®µ<strong>åŠ èµ·æ¥ä¸åŒå³å¯</strong>ï¼ˆæ— éœ€æ¯ä¸ªå­—æ®µéƒ½ä¸åŒï¼‰</p><p><strong>å»ºè¡¨åæ·»åŠ ä¸»é”®</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">ALERT <span class="hljs-keyword">TABLE</span> user2 <span class="hljs-keyword">ADD</span> <span class="hljs-keyword">PRIMARY</span> KEY (id);<br></code></pre></td></tr></table></figure><p>æˆ–è€…é€šè¿‡<strong>ä¿®æ”¹å­—æ®µ</strong>çš„æ–¹å¼æ¥æ·»åŠ ä¸»é”®</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">ALERT <span class="hljs-keyword">TABLE</span> user2 MODIFY id <span class="hljs-type">INT</span> <span class="hljs-keyword">PRIMARY</span> KEY;<br></code></pre></td></tr></table></figure><p><strong>å»ºè¡¨ååˆ é™¤ä¸»é”®</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">ALERT <span class="hljs-keyword">TABLE</span> user2 <span class="hljs-keyword">DROP</span>  <span class="hljs-keyword">PRIMARY</span> KEY (id);<br></code></pre></td></tr></table></figure><h2 id="2ã€è‡ªå¢çº¦æŸ"><a href="#2ã€è‡ªå¢çº¦æŸ" class="headerlink" title="2ã€è‡ªå¢çº¦æŸ"></a>2ã€è‡ªå¢çº¦æŸ</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> user3 (<br>id <span class="hljs-type">INT</span> <span class="hljs-keyword">PRIMARY</span> KEY AUTO_INCREAMENT,<br>name <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">20</span>),<br>);<br><br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> user3 (name) <span class="hljs-keyword">VALUES</span> (<span class="hljs-string">&#x27;name&#x27;</span>); <span class="hljs-operator">/</span><span class="hljs-operator">/</span>æ’å…¥æˆåŠŸï¼Œè‡ªåŠ¨ç”Ÿæˆäº†id<br></code></pre></td></tr></table></figure><p>è‡ªå¢çº¦æŸä¸€èˆ¬<strong>ä¸ä¸»é”®æ­é…ä½¿ç”¨</strong></p><h2 id="3ã€å”¯ä¸€çº¦æŸ"><a href="#3ã€å”¯ä¸€çº¦æŸ" class="headerlink" title="3ã€å”¯ä¸€çº¦æŸ"></a>3ã€å”¯ä¸€çº¦æŸ</h2><p>çº¦æŸä¿®é¥°çš„å­—æ®µä¸å¯ä»¥é‡å¤</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> user4 (<br>id <span class="hljs-type">INT</span> <span class="hljs-keyword">PRIMARY</span> KEY AUTO_INCREAMENT <span class="hljs-keyword">UNIQUE</span>,<br>name <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">20</span>)<br>);<br></code></pre></td></tr></table></figure><p>æˆ–è€…</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> user4 (<br>id <span class="hljs-type">INT</span> <span class="hljs-keyword">PRIMARY</span> KEY AUTO_INCREAMENT,<br>name <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">20</span>),<br><span class="hljs-keyword">UNIQUE</span>(id, name)<br>);<br></code></pre></td></tr></table></figure><h2 id="4ã€éç©ºçº¦æŸ"><a href="#4ã€éç©ºçº¦æŸ" class="headerlink" title="4ã€éç©ºçº¦æŸ"></a>4ã€éç©ºçº¦æŸ</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> user4 (<br>id <span class="hljs-type">INT</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,<br>name <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">20</span>),<br>);<br></code></pre></td></tr></table></figure><h2 id="5ã€é»˜è®¤çº¦æŸ"><a href="#5ã€é»˜è®¤çº¦æŸ" class="headerlink" title="5ã€é»˜è®¤çº¦æŸ"></a>5ã€é»˜è®¤çº¦æŸ</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> user4 (<br>id <span class="hljs-type">INT</span> <span class="hljs-keyword">DEFAULT</span> <span class="hljs-number">10</span>,<br>name <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">20</span>),<br>);<br></code></pre></td></tr></table></figure><p>å¦‚æœæˆ‘ä»¬æ’å…¥å­—æ®µæ—¶æ²¡æœ‰ä¼ å€¼ï¼Œå°±ä¼š<strong>ä½¿ç”¨é»˜è®¤å€¼</strong></p><h2 id="6ã€å¤–é”®çº¦æŸ"><a href="#6ã€å¤–é”®çº¦æŸ" class="headerlink" title="6ã€å¤–é”®çº¦æŸ"></a>6ã€å¤–é”®çº¦æŸ</h2><p>ä¸»è¡¨</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> master(<br>id <span class="hljs-type">INT</span> <span class="hljs-keyword">PRIMARY</span> KEY,<br>name <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">20</span>)<br>);<br></code></pre></td></tr></table></figure><p>ä»è¡¨</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> pet(<br>id <span class="hljs-type">INT</span> <span class="hljs-keyword">PRIMARY</span> KEY,<br>name <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">20</span>),<br>master_id <span class="hljs-type">int</span>,<br><span class="hljs-keyword">FOREIGN</span> KEY(master_id) <span class="hljs-keyword">REFERENCES</span> master(id)<br>);<br></code></pre></td></tr></table></figure><ul><li>ä¸»è¡¨ä¸­æ²¡æœ‰çš„æ•°æ®ï¼Œåœ¨å‰¯è¡¨ä¸­æ˜¯ä¸å¯ä»¥ä½¿ç”¨çš„</li><li>ä¸»è¡¨ä¸­çš„æ•°æ®è¢«å‰¯æ ‡å¼•ç”¨æ—¶ï¼Œæ˜¯ä¸å¯ä»¥åˆ é™¤çš„</li></ul><h1 id="äº”ã€æ•°æ®åº“èŒƒå¼"><a href="#äº”ã€æ•°æ®åº“èŒƒå¼" class="headerlink" title="äº”ã€æ•°æ®åº“èŒƒå¼"></a>äº”ã€æ•°æ®åº“èŒƒå¼</h1><p>ä¸ºäº†å»ºç«‹å†—ä½™è¾ƒå°ã€ç»“æ„åˆç†çš„æ•°æ®åº“ï¼Œè®¾è®¡æ•°æ®åº“æ—¶å¿…é¡»éµå¾ªä¸€å®šçš„è§„åˆ™ã€‚åœ¨å…³ç³»å‹æ•°æ®åº“ä¸­è¿™ç§è§„åˆ™å°±ç§°ä¸ºèŒƒå¼ã€‚èŒƒå¼æ˜¯ç¬¦åˆæŸä¸€ç§è®¾è®¡è¦æ±‚çš„æ€»ç»“ã€‚è¦æƒ³è®¾è®¡ä¸€ä¸ªç»“æ„åˆç†çš„å…³ç³»å‹æ•°æ®åº“ï¼Œå¿…é¡»æ»¡è¶³ä¸€å®šçš„èŒƒå¼ã€‚</p><p>é€šå¸¸ä½¿ç”¨åˆ°çš„æœ‰ <strong>1NF</strong>ã€<strong>2NF</strong>ã€<strong>3NF</strong>ã€<strong>BCNF</strong>ï¼Œåœ¨å®é™…å¼€å‘ä¸­æœ€ä¸ºå¸¸è§çš„è®¾è®¡èŒƒå¼ç”¨å‰ä¸‰ä¸ªï¼š</p><h2 id="1ã€ç¬¬ä¸€èŒƒå¼"><a href="#1ã€ç¬¬ä¸€èŒƒå¼" class="headerlink" title="1ã€ç¬¬ä¸€èŒƒå¼"></a>1ã€ç¬¬ä¸€èŒƒå¼</h2><p><strong>å­—æ®µè¿˜å¯ä»¥æ‹†åˆ†çš„ï¼Œå°±ä¸æ»¡è¶³ç¬¬ä¸€èŒƒå¼</strong></p><p>æ¯”å¦‚åœ°å€å¦‚æœå†™ä¸º</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-string">åœ°å€ï¼šé™•è¥¿çœè¥¿å®‰å¸‚é•¿å®‰åŒºå­¦åºœå¤§è¡—è¥¿åŒ—å¤§å­¦</span><br></code></pre></td></tr></table></figure><p>å°±æ˜¯å¯ä»¥è¢«æ‹†åˆ†çš„</p><p>å¦‚æœå­—æ®µå†™ä¸º</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-string">çœä»½ï¼šé™•è¥¿çœ</span><br><span class="hljs-string">åŸå¸‚ï¼šè¥¿å®‰å¸‚</span><br><span class="hljs-string">åŒºåŸŸï¼šé•¿å®‰åŒº</span><br><span class="hljs-string">è¡—åï¼šå­¦åºœå¤§è¡—è¥¿åŒ—å¤§å­¦</span><br></code></pre></td></tr></table></figure><p>å°±æ˜¯ä¸å¯æ‹†åˆ†çš„</p><p>å»ºè¡¨å¦‚ä¸‹</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> student(<br>id <span class="hljs-type">INT</span> <span class="hljs-keyword">PRIMARY</span> KEY AUTO_INCRAEMENT,<br>name <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">20</span>),<br>province <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">20</span>),<br>city <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">20</span>),<br>area <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">20</span>),<br>street: <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">20</span>)<br>);<br></code></pre></td></tr></table></figure><p>å°±æ˜¯<strong>ç¬¦åˆç¬¬ä¸€èŒƒå¼</strong>çš„ï¼Œä½†<strong>å¹¶ä¸æ˜¯æ‹†åˆ†çš„è¶Šè¯¦ç»†è¶Šå¥½</strong></p><h2 id="2ã€ç¬¬äºŒèŒƒå¼"><a href="#2ã€ç¬¬äºŒèŒƒå¼" class="headerlink" title="2ã€ç¬¬äºŒèŒƒå¼"></a>2ã€ç¬¬äºŒèŒƒå¼</h2><ul><li>æ»¡è¶³ç¬¬ä¸€èŒƒå¼çš„æ¡ä»¶ä¸‹ï¼Œç¬¬äºŒèŒƒå¼è¦æ±‚ï¼š<strong>é™¤ä¸»é”®å¤–çš„æ¯ä¸€åˆ—ï¼Œéƒ½å¿…é¡»å®Œå…¨ä¾èµ–äºä¸»é”®</strong></li><li>å¦‚æœå‡ºç°ä¸å®Œå…¨ä¾èµ–ï¼Œåˆ™åªå¯èƒ½å‘ç”Ÿåœ¨<strong>è”åˆä¸»é”®</strong>çš„æƒ…å†µä¸‹</li></ul><p><strong>ä¸æ»¡è¶³ç¬¬äºŒèŒƒå¼çš„ä¾‹å­</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> <span class="hljs-keyword">order</span>(<br>product_id <span class="hljs-type">INT</span>,<br>customer_id <span class="hljs-type">INT</span>,<br>product_name <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">20</span>),<br>customer_name <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">20</span>),<br>    <span class="hljs-keyword">PRIMARY</span> KEY(product_id, customer_id)<br>);<span class="hljs-keyword">Copy</span><br></code></pre></td></tr></table></figure><p>æ­¤å¤„product_nameåªä¾èµ–äºproduct_idï¼Œcustomer_nameåªä¾èµ–äºcustomer_id</p><p><strong>æ»¡è¶³ç¬¬äºŒèŒƒå¼çš„ä¾‹å­</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> <span class="hljs-keyword">order</span>(<br>id <span class="hljs-type">INT</span> <span class="hljs-keyword">PRIMARY</span> KEY,<br>product_id <span class="hljs-type">INT</span>,<br>customer_id <span class="hljs-type">INT</span><br>);<br><br><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> product(<br>id <span class="hljs-type">INT</span> <span class="hljs-keyword">PRIMARY</span> KEY,<br>name <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">20</span>)<br>);<br><br><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> customer(<br>id <span class="hljs-type">INT</span> <span class="hljs-keyword">PRIMARY</span> KEY,<br>    name <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">20</span>)<br>);<br></code></pre></td></tr></table></figure><h2 id="3ã€ç¬¬ä¸‰èŒƒå¼"><a href="#3ã€ç¬¬ä¸‰èŒƒå¼" class="headerlink" title="3ã€ç¬¬ä¸‰èŒƒå¼"></a>3ã€ç¬¬ä¸‰èŒƒå¼</h2><ul><li>æ»¡è¶³ç¬¬äºŒèŒƒå¼ï¼Œé™¤ä¸»é”®å¤–çš„å…¶ä»–åˆ—ä¹‹é—´ä¸èƒ½æœ‰ä¼ é€’ä¾èµ–å…³ç³»</li></ul><p><strong>ä¸æ»¡è¶³ç¬¬ä¸‰èŒƒå¼çš„ä¾‹å­</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> <span class="hljs-keyword">order</span>(<br>id <span class="hljs-type">INT</span> <span class="hljs-keyword">PRIMARY</span> KEY,<br>product_id <span class="hljs-type">INT</span>,<br>customer_id <span class="hljs-type">INT</span>,<br>customer_phone <span class="hljs-type">INT</span><br>);<br></code></pre></td></tr></table></figure><p>æ­¤å¤„customer_phoneåˆä¾èµ–äºcustomer_idï¼Œå­˜åœ¨ä¼ é€’ä¾èµ–å…³ç³»ï¼Œä¸æ»¡è¶³ç¬¬ä¸‰èŒƒå¼</p><p><strong>æ»¡è¶³ç¬¬ä¸‰èŒƒå¼çš„ä¾‹å­</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> <span class="hljs-keyword">order</span>(<br>id <span class="hljs-type">INT</span> <span class="hljs-keyword">PRIMARY</span> KEY,<br>product_id <span class="hljs-type">INT</span>,<br>customer_id <span class="hljs-type">INT</span><br>);<br><br><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> customer(<br>id <span class="hljs-type">INT</span> <span class="hljs-keyword">PRIMARY</span> KEY,<br>    name <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">20</span>),<br>    phone <span class="hljs-type">INT</span><br>);<br></code></pre></td></tr></table></figure><h1 id="å…­ã€äº‹åŠ¡"><a href="#å…­ã€äº‹åŠ¡" class="headerlink" title="å…­ã€äº‹åŠ¡"></a>å…­ã€äº‹åŠ¡</h1><h2 id="1ã€äº‹åŠ¡çš„ACID"><a href="#1ã€äº‹åŠ¡çš„ACID" class="headerlink" title="1ã€äº‹åŠ¡çš„ACID"></a>1ã€äº‹åŠ¡çš„ACID</h2><p><strong>åŸå­æ€§(atomicity)</strong><br>ä¸€ä¸ªäº‹åŠ¡å¿…é¡»è¢«è§†ä¸ºä¸€ä¸ªä¸å¯åˆ†å‰²çš„æœ€å°å·¥ä½œå•å…ƒï¼Œæ•´ä¸ªäº‹åŠ¡ä¸­çš„æ‰€æœ‰æ“ä½œè¦ä¹ˆå…¨éƒ¨æäº¤æˆåŠŸï¼Œè¦ä¹ˆå…¨éƒ¨å¤±è´¥å›æ»šï¼Œå¯¹äºä¸€ä¸ªäº‹åŠ¡æ¥è¯´ä¸å¯èƒ½åªæ‰§è¡Œå…¶ä¸­çš„ä¸€éƒ¨åˆ†æ“ä½œï¼Œè¿™å°±æ˜¯äº‹åŠ¡çš„åŸå­æ€§ã€‚</p><p><strong>ä¸€è‡´æ€§ (consistency)</strong><br>æ•°æ®åº“æ€»æ˜¯ä»ä¸€ä¸ªä¸€è‡´æ€§çš„çŠ¶æ€è½¬æ¢åˆ°å¦å¤–ä¸€ä¸ªä¸€è‡´æ€§çš„çŠ¶æ€ã€‚ä¾‹å¦‚åœ¨ä¸€ä¸ªäº‹åŠ¡æ‰§è¡Œè¿‡ç¨‹ä¸­,æœåŠ¡å™¨çªç„¶æ–­ç”µï¼Œä½†å› ä¸ºäº‹åŠ¡æœ€ç»ˆæ²¡æœ‰æäº¤ï¼Œæ‰€ä»¥äº‹åŠ¡ä¸­æ‰€åšçš„ä¿®æ”¹ä¹Ÿä¸ä¼šä¿å­˜åˆ°æ•°æ®åº“ä¸­ï¼Œè€Œå¦‚æœäº‹åŠ¡æ­£å¸¸æ‰§è¡Œä¸”æˆåŠŸæäº¤ï¼Œé‚£ä¹ˆæ•°æ®åº“å°±è½¬æ¢åˆ°äº†å¦å¤–ä¸€ä¸ªä¸€è‡´æ€§çŠ¶æ€ã€‚</p><p><strong>éš”ç¦»æ€§ (isolation)</strong><br>é€šå¸¸æ¥è° ï¼Œä¸€ä¸ªäº‹åŠ¡æ‰€åšçš„ä¿®æ”¹åœ¨æœ€ç»ˆæäº¤ä»¥å‰ï¼Œå¯¹å…¶ä»–äº‹åŠ¡æ˜¯ä¸å¯è§çš„ã€‚</p><p><strong>æŒä¹…æ€§ (durability)</strong><br>ä¸€æ—¦äº‹åŠ¡æäº¤ï¼Œåˆ™å…¶æ‰€åšçš„ä¿®æ”¹å°±ä¼šæ°¸ä¹…ä¿å­˜åˆ°æ•°æ®åº“ä¸­ã€‚æ­¤æ—¶å³ä½¿ç³»ç»Ÿå´©æºƒï¼Œä¿®æ”¹çš„æ•°æ®ä¹Ÿä¸ä¼šä¸¢å¤±ã€‚</p><h2 id="2ã€éš”ç¦»çº§åˆ«"><a href="#2ã€éš”ç¦»çº§åˆ«" class="headerlink" title="2ã€éš”ç¦»çº§åˆ«"></a>2ã€éš”ç¦»çº§åˆ«</h2><p><strong>READ UNCOMMITTEDï¼ˆæœªæäº¤è¯»)</strong><br>åœ¨ READ UNCOMMITTED çº§åˆ«ï¼Œäº‹åŠ¡ä¸­çš„ä¿®æ”¹ï¼Œå³ä½¿æ²¡æœ‰æäº¤ï¼Œå¯¹å…¶ä»–äº‹åŠ¡ä¹Ÿéƒ½æ˜¯å¯è§çš„ã€‚äº‹åŠ¡å¯ä»¥è¯»å–æœªæäº¤çš„æ•°æ®ï¼Œè¿™ä¼šå¯¼è‡´è„è¯»ã€‚è¿™ä¸ªçº§åˆ«ä¼šå¯¼è‡´å¾ˆå¤šé—®é¢˜ï¼Œä»æ€§èƒ½ä¸Šæ¥è¯´ï¼ŒREAD UNCOMMITTED ä¸ä¼šæ¯”å…¶ä»–çš„çº§åˆ«å¥½å¤ªå¤šï¼Œä½†å´ç¼ºä¹å…¶ä»–çº§åˆ«çš„å¾ˆå¤šå¥½å¤„ï¼Œé™¤éçœŸçš„æœ‰éå¸¸å¿…è¦çš„ç†ç”±ï¼Œåœ¨å®é™…åº”ç”¨ä¸­ä¸€èˆ¬å¾ˆå°‘ä½¿ç”¨ã€‚</p><p><strong>READ COMMITTEDï¼ˆæäº¤è¯»ï¼‰</strong><br>å¤§å¤šæ•°æ•°æ®åº“ç³»ç»Ÿçš„é»˜è®¤éš”ç¦»çº§åˆ«éƒ½æ˜¯ READ COMMITTED ï¼ˆä½† MySQL ä¸æ˜¯ï¼‰ã€‚READCOMMITTED æ»¡è¶³å‰é¢æåˆ°çš„éš”ç¦»æ€§çš„ç®€å•å®šä¹‰ï¼šä¸€ä¸ªäº‹åŠ¡å¼€å§‹æ—¶ï¼Œåªèƒ½ â€œçœ‹è§â€å·²ç»æäº¤çš„äº‹åŠ¡æ‰€åšçš„ä¿®æ”¹ã€‚æ¢å¥è¯è¯´ï¼Œä¸€ä¸ªäº‹åŠ¡ä»å¼€å§‹ç›´åˆ°æäº¤ä¹‹å‰ï¼Œæ‰€åšçš„ä»»ä½•ä¿®æ”¹å¯¹å…¶ä»–äº‹åŠ¡éƒ½æ˜¯ä¸å¯è§çš„ã€‚è¿™ä¸ªçº§åˆ«ä¼šå‡ºç°ä¸å¯é‡å¤è¯»ï¼Œå› ä¸ºä¸¤æ¬¡æ‰§è¡ŒåŒæ ·çš„æŸ¥è¯¢ï¼Œå¯èƒ½ä¼šå¾—åˆ°ä¸ä¸€æ ·çš„ç»“æœã€‚</p><p><strong>REPEATABLE READï¼ˆå¯é‡å¤è¯»ï¼‰</strong><br>REPEATABLE READ è§£å†³äº†è„è¯»çš„é—®é¢˜ã€‚è¯¥çº§åˆ«ä¿è¯äº†åœ¨åŒä¸€ä¸ªäº‹åŠ¡ä¸­å¤šæ¬¡è¯»å–åŒæ ·è®°å½•çš„ç»“æœæ˜¯ä¸€è‡´çš„ã€‚ä½†æ˜¯ç†è®ºä¸Šï¼Œå¯é‡å¤è¯»éš”ç¦»çº§åˆ«è¿˜æ˜¯æ— æ³•è§£å†³å¦å¤–ä¸€ä¸ªå¹»è¯»çš„é—®é¢˜ã€‚æ‰€è°“å¹»è¯»ï¼ŒæŒ‡çš„æ˜¯å½“æŸä¸ªäº‹åŠ¡ åœ¨è¯»å–æŸä¸ªèŒƒå›´å†…çš„è®°å½•æ—¶ï¼Œå¦å¤–ä¸€ä¸ªäº‹åŠ¡åˆåœ¨è¯¥èŒƒå›´å†…æ’äººäº†æ–°çš„è®°å½•ï¼Œå½“ä¹‹å‰çš„äº‹åŠ¡å†æ¬¡è¯»å–è¯¥èŒƒå›´çš„è®°å½•æ—¶ï¼Œä¼šäº§ç”Ÿå¹»è¡Œã€‚InnoDB å’ŒXtraDB å­˜å‚¨å¼•æ“é€šè¿‡å¤šç‰ˆæœ¬äº•å‘æ§åˆ¶ (MVCC, Multiversion Concurrency Control)è§£å†³äº†å¹»è¯»çš„é—®é¢˜ã€‚<strong>å¯é‡å¤è¯»æ˜¯ MySQL çš„é»˜è®¤äº‹åŠ¡éš”ç¦»çº§åˆ«</strong>ã€‚</p><p><strong>SERIALIZABLEï¼ˆå¯ä¸²è¡ŒåŒ–ï¼‰</strong><br>SERIALIZABLE æ˜¯æœ€é«˜çš„éš”ç¦»çº§åˆ«ã€‚å®ƒé€šè¿‡å¼ºåˆ¶äº‹åŠ¡ä¸²è¡Œæ‰§è¡Œï¼Œé¿å…äº†å‰é¢è¯´çš„å¹»è¯»çš„é—®é¢˜ã€‚ç®€å•æ¥è¯´ï¼ŒSERIALIZABLE ä¼šåœ¨è¯»å–çš„æ¯ä¸€è¡Œæ•°æ®ä¸Šéƒ½åŠ é”ï¼Œæ‰€ä»¥å¯èƒ½å¯¼è‡´å¤§é‡çš„è¶…æ—¶å’Œé”äº‰ç”¨çš„é—®é¢˜ã€‚å®é™…åº”ç”¨ä¸­ä¹Ÿå¾ˆå°‘ç”¨åˆ°è¿™ä¸ªéš”ç¦»çº§åˆ«ï¼Œåªæœ‰åœ¨éå¸¸éœ€è¦ç¡®ä¿æ•°æ®çš„ä¸€è‡´æ€§è€Œä¸”å¯ä»¥æ¥å—æ²¡æœ‰äº•å‘çš„æƒ…å†µä¸‹ï¼Œæ‰è€ƒè™‘é‡‡ç”¨è¯¥çº§åˆ«ã€‚</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs css">è„è¯»ï¼šäº‹åŠ¡<span class="hljs-selector-tag">A</span>åœ¨äº‹åŠ¡<span class="hljs-selector-tag">B</span>ä¿®æ”¹æŸä¸ªå­—æ®µæ•°æ®åï¼Œè¯»å–è¯¥å­—æ®µå€¼ï¼Œéšåäº‹åŠ¡å‘ç”Ÿå›æ»šï¼Œæ­¤æ—¶<span class="hljs-selector-tag">A</span>è¯»åˆ°çš„æ•°æ®å°±æ˜¯&quot;è„çš„&quot;<br>ä¸å¯é‡å¤åº¦ï¼šäº‹åŠ¡<span class="hljs-selector-tag">A</span>è¯»å–æŸä¸ªå­—æ®µå€¼åï¼Œäº‹åŠ¡<span class="hljs-selector-tag">B</span>ä¿®æ”¹è¯¥å­—æ®µå€¼ï¼Œäº‹åŠ¡<span class="hljs-selector-tag">B</span>æäº¤åï¼Œäº‹åŠ¡<span class="hljs-selector-tag">A</span>å†æ¬¡è¯»å–è¯¥å­—æ®µå€¼ï¼Œä¸¤æ¬¡è¯»å–çš„å€¼ä¸ä¸€è‡´<br>å¹»è¯»ï¼šäº‹åŠ¡<span class="hljs-selector-tag">A</span>è¯»å–æŸå­—æ®µå€¼åï¼Œä¼šç»™è¯¥å­—æ®µä¸Šé”(æ³¨æ„æ˜¯è¡Œé”)ï¼Œæ­¤æ—¶äº‹åŠ¡<span class="hljs-selector-tag">A</span>æ‰§è¡Œæ¡ä»¶æŸ¥è¯¢ï¼ŒæŸ¥è¯¢åˆ°ä¸€æ¡è®°å½•ï¼Œéšååˆ é™¤ï¼Œæ­¤æ—¶<span class="hljs-selector-tag">B</span>å¯ä»¥Insertä¸€æ¡ä¸åˆ é™¤è®°å½•ä¸€æ ·çš„è®°å½•ï¼Œæ­¤æ—¶äº‹åŠ¡<span class="hljs-selector-tag">A</span>å†æ¬¡æ‰§è¡ŒæŸ¥è¯¢ï¼Œåˆå‘ç°äº†ä¸€æ¡è®°å½•<br></code></pre></td></tr></table></figure><table><thead><tr><th>éš”ç¦»çº§åˆ«</th><th>è„è¯»å¯èƒ½æ€§</th><th>ä¸å¯é‡å¤è¯»å¯èƒ½æ€§</th><th>å¹»è¯»å¯èƒ½æ€§</th></tr></thead><tbody><tr><td>è¯»æœªæäº¤</td><td>YES</td><td>YES</td><td>YES</td></tr><tr><td>è¯»å·²æäº¤</td><td>NO</td><td>YES</td><td>YES</td></tr><tr><td>å¯é‡å¤è¯»</td><td>NO</td><td>NO</td><td>YES</td></tr><tr><td>ä¸²è¡ŒåŒ–</td><td>NO</td><td>NO</td><td>NO</td></tr></tbody></table><p><strong>æ€»ç»“</strong>ï¼šä¸å¯é‡å¤è¯»çš„å’Œå¹»è¯»å¾ˆå®¹æ˜“æ··æ·†ï¼Œ<strong>ä¸å¯é‡å¤è¯»ä¾§é‡äºä¿®æ”¹ï¼Œå¹»è¯»ä¾§é‡äºæ–°å¢æˆ–åˆ é™¤</strong></p><p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒMysqlæ˜¯è‡ªåŠ¨æäº¤çš„ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬æ¯æ¬¡è¾“å…¥ä¸€æ¡è¯­å¥ç„¶åå›è½¦ï¼Œè¿™ä¹Ÿæ‰§è¡Œäº†ä¸€ä¸ªäº‹åŠ¡ã€‚</p><h2 id="3ã€äº‹åŠ¡æ“ä½œ"><a href="#3ã€äº‹åŠ¡æ“ä½œ" class="headerlink" title="3ã€äº‹åŠ¡æ“ä½œ"></a>3ã€äº‹åŠ¡æ“ä½œ</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs sql">æŸ¥çœ‹è‡ªåŠ¨æäº¤çŠ¶æ€<br><span class="hljs-keyword">SELECT</span> @<span class="hljs-variable">@autocommit</span>; <span class="hljs-comment">--å¸¦@@çš„å˜é‡ä¸ºç³»ç»Ÿå˜é‡</span><br>å…³é—­è‡ªåŠ¨æäº¤<br><span class="hljs-keyword">set</span> @<span class="hljs-variable">@autocommit</span><span class="hljs-operator">=</span><span class="hljs-number">0</span><br>æ­¤æ—¶å¯ä»¥è¾“å…¥æ‰§è¡Œä»»æ„å¤šæ¡è¯­å¥<br>æ‰§è¡Œ<span class="hljs-keyword">ROLLBACK</span>å›æ»šåˆ°ä¸Šæ¬¡ææäº¤åçŠ¶æ€<br>æ‰§è¡Œ<span class="hljs-keyword">COMMIT</span>åˆ™æäº¤æ­¤æ¬¡äº‹åŠ¡<br></code></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs sql">ä¹Ÿå¯ä»¥æ‰‹åŠ¨å¼€å¯ä¸€ä¸ªäº‹åŠ¡<br><span class="hljs-keyword">BEGIN</span>; <span class="hljs-comment">-- æˆ–è€… START TRANSACTION;</span><br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> person <span class="hljs-keyword">VALUES</span> (<span class="hljs-number">4</span>, <span class="hljs-string">&#x27;è€å…­&#x27;</span>, <span class="hljs-number">7</span>);<br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> person <span class="hljs-keyword">VALUES</span> (<span class="hljs-number">5</span>, <span class="hljs-string">&#x27;è€ä¸ƒ&#x27;</span>, <span class="hljs-number">9</span>);<br><span class="hljs-keyword">ROLLBACK</span>; <span class="hljs-comment">-- å›æ»š</span><br><span class="hljs-keyword">COMMIT</span>; <span class="hljs-comment">-- æäº¤</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    
    <tags>
      
      <tag>mysql</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Spring</title>
    <link href="/2021/12/22/spring/"/>
    <url>/2021/12/22/spring/</url>
    
    <content type="html"><![CDATA[<h1 id="ä¸€ã€Springæ¶æ„"><a href="#ä¸€ã€Springæ¶æ„" class="headerlink" title="ä¸€ã€Springæ¶æ„"></a>ä¸€ã€Springæ¶æ„</h1><p><img src="/spring.assets/image-20220313022449214.png" alt="image-20220313022449214"></p><p>ä¸Šå›¾ä¸­åŒ…å«äº† Spring æ¡†æ¶çš„æ‰€æœ‰æ¨¡å—ï¼Œè¿™äº›æ¨¡å—å¯ä»¥æ»¡è¶³ä¸€åˆ‡ä¼ä¸šçº§åº”ç”¨å¼€å‘çš„éœ€æ±‚ï¼Œåœ¨å¼€å‘è¿‡ç¨‹ä¸­å¯ä»¥æ ¹æ®éœ€æ±‚æœ‰é€‰æ‹©æ€§åœ°ä½¿ç”¨æ‰€éœ€è¦çš„æ¨¡å—ã€‚ä¸‹é¢åˆ†åˆ«å¯¹è¿™äº›æ¨¡å—çš„ä½œç”¨è¿›è¡Œç®€å•ä»‹ç»ã€‚</p><h2 id="1-Data-Access-x2F-Integrationï¼ˆæ•°æ®è®¿é—®ï¼é›†æˆï¼‰"><a href="#1-Data-Access-x2F-Integrationï¼ˆæ•°æ®è®¿é—®ï¼é›†æˆï¼‰" class="headerlink" title="1. Data Access&#x2F;Integrationï¼ˆæ•°æ®è®¿é—®ï¼é›†æˆï¼‰"></a>1. Data Access&#x2F;Integrationï¼ˆæ•°æ®è®¿é—®ï¼é›†æˆï¼‰</h2><p>æ•°æ®è®¿é—®ï¼é›†æˆå±‚åŒ…æ‹¬ JDBCã€ORMã€OXMã€JMS å’Œ Transactions æ¨¡å—ï¼Œå…·ä½“ä»‹ç»å¦‚ä¸‹ã€‚</p><ul><li>JDBC æ¨¡å—ï¼šæä¾›äº†ä¸€ä¸ª JBDC çš„æ ·ä¾‹æ¨¡æ¿ï¼Œä½¿ç”¨è¿™äº›æ¨¡æ¿èƒ½æ¶ˆé™¤ä¼ ç»Ÿå†—é•¿çš„ JDBC ç¼–ç è¿˜æœ‰å¿…é¡»çš„äº‹åŠ¡æ§åˆ¶ï¼Œè€Œä¸”èƒ½äº«å—åˆ° Spring ç®¡ç†äº‹åŠ¡çš„å¥½å¤„ã€‚</li><li>ORM æ¨¡å—ï¼šæä¾›ä¸æµè¡Œçš„â€œå¯¹è±¡-å…³ç³»â€æ˜ å°„æ¡†æ¶æ— ç¼é›†æˆçš„ APIï¼ŒåŒ…æ‹¬ JPAã€JDOã€Hibernate å’Œ MyBatis ç­‰ã€‚è€Œä¸”è¿˜å¯ä»¥ä½¿ç”¨ Spring äº‹åŠ¡ç®¡ç†ï¼Œæ— éœ€é¢å¤–æ§åˆ¶äº‹åŠ¡ã€‚</li><li>OXM æ¨¡å—ï¼šæä¾›äº†ä¸€ä¸ªæ”¯æŒ Object &#x2F;XML æ˜ å°„çš„æŠ½è±¡å±‚å®ç°ï¼Œå¦‚ JAXBã€Castorã€XMLBeansã€JiBX å’Œ XStreamã€‚å°† Java å¯¹è±¡æ˜ å°„æˆ XML æ•°æ®ï¼Œæˆ–è€…å°†XML æ•°æ®æ˜ å°„æˆ Java å¯¹è±¡ã€‚</li><li>JMS æ¨¡å—ï¼šæŒ‡ Java æ¶ˆæ¯æœåŠ¡ï¼Œæä¾›ä¸€å¥— â€œæ¶ˆæ¯ç”Ÿäº§è€…ã€æ¶ˆæ¯æ¶ˆè´¹è€…â€æ¨¡æ¿ç”¨äºæ›´åŠ ç®€å•çš„ä½¿ç”¨ JMSï¼ŒJMS ç”¨äºç”¨äºåœ¨ä¸¤ä¸ªåº”ç”¨ç¨‹åºä¹‹é—´ï¼Œæˆ–åˆ†å¸ƒå¼ç³»ç»Ÿä¸­å‘é€æ¶ˆæ¯ï¼Œè¿›è¡Œå¼‚æ­¥é€šä¿¡ã€‚</li><li>Transactions äº‹åŠ¡æ¨¡å—ï¼šæ”¯æŒç¼–ç¨‹å’Œå£°æ˜å¼äº‹åŠ¡ç®¡ç†ã€‚</li></ul><h2 id="2-Web-æ¨¡å—"><a href="#2-Web-æ¨¡å—" class="headerlink" title="2. Web æ¨¡å—"></a>2. Web æ¨¡å—</h2><p>Spring çš„ Web å±‚åŒ…æ‹¬ Webã€Servletã€WebSocket å’Œ Portlet ç»„ä»¶ï¼Œå…·ä½“ä»‹ç»å¦‚ä¸‹ã€‚</p><ul><li>Web æ¨¡å—ï¼šæä¾›äº†åŸºæœ¬çš„ Web å¼€å‘é›†æˆç‰¹æ€§ï¼Œä¾‹å¦‚å¤šæ–‡ä»¶ä¸Šä¼ åŠŸèƒ½ã€ä½¿ç”¨çš„ Servlet ç›‘å¬å™¨çš„ IOC å®¹å™¨åˆå§‹åŒ–ä»¥åŠ Web åº”ç”¨ä¸Šä¸‹æ–‡ã€‚</li><li>Servlet æ¨¡å—ï¼šæä¾›äº†ä¸€ä¸ª Spring MVC Web æ¡†æ¶å®ç°ã€‚Spring MVC æ¡†æ¶æä¾›äº†åŸºäºæ³¨è§£çš„è¯·æ±‚èµ„æºæ³¨å…¥ã€æ›´ç®€å•çš„æ•°æ®ç»‘å®šã€æ•°æ®éªŒè¯ç­‰åŠä¸€å¥—éå¸¸æ˜“ç”¨çš„ JSP æ ‡ç­¾ï¼Œå®Œå…¨æ— ç¼ä¸ Spring å…¶ä»–æŠ€æœ¯åä½œã€‚</li><li>WebSocket æ¨¡å—ï¼šæä¾›äº†ç®€å•çš„æ¥å£ï¼Œç”¨æˆ·åªè¦å®ç°å“åº”çš„æ¥å£å°±å¯ä»¥å¿«é€Ÿçš„æ­å»º WebSocket Serverï¼Œä»è€Œå®ç°åŒå‘é€šè®¯ã€‚</li><li>Portlet æ¨¡å—ï¼šæä¾›äº†åœ¨ Portlet ç¯å¢ƒä¸­ä½¿ç”¨ MVC å®ç°ï¼Œç±»ä¼¼ Web-Servlet æ¨¡å—çš„åŠŸèƒ½ã€‚</li></ul><h2 id="3-AOPã€Aspectsã€Instrumentation-å’Œ-Messaging"><a href="#3-AOPã€Aspectsã€Instrumentation-å’Œ-Messaging" class="headerlink" title="3. AOPã€Aspectsã€Instrumentation å’Œ Messaging"></a>3. AOPã€Aspectsã€Instrumentation å’Œ Messaging</h2><p>åœ¨ Core Container ä¹‹ä¸Šæ˜¯ AOPã€Aspects ç­‰æ¨¡å—ï¼Œå…·ä½“ä»‹ç»å¦‚ä¸‹ï¼š</p><ul><li>AOP æ¨¡å—ï¼šæä¾›äº†é¢å‘åˆ‡é¢ç¼–ç¨‹å®ç°ï¼Œæä¾›æ¯”å¦‚æ—¥å¿—è®°å½•ã€æƒé™æ§åˆ¶ã€æ€§èƒ½ç»Ÿè®¡ç­‰é€šç”¨åŠŸèƒ½å’Œä¸šåŠ¡é€»è¾‘åˆ†ç¦»çš„æŠ€æœ¯ï¼Œå¹¶ä¸”èƒ½åŠ¨æ€çš„æŠŠè¿™äº›åŠŸèƒ½æ·»åŠ åˆ°éœ€è¦çš„ä»£ç ä¸­ï¼Œè¿™æ ·å„å¸å…¶èŒï¼Œé™ä½ä¸šåŠ¡é€»è¾‘å’Œé€šç”¨åŠŸèƒ½çš„è€¦åˆã€‚</li><li>Aspects æ¨¡å—ï¼šæä¾›ä¸ AspectJ çš„é›†æˆï¼Œæ˜¯ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§ä¸”æˆç†Ÿçš„é¢å‘åˆ‡é¢ç¼–ç¨‹ï¼ˆAOPï¼‰æ¡†æ¶ã€‚</li><li>Instrumentation æ¨¡å—ï¼šæä¾›äº†ç±»å·¥å…·çš„æ”¯æŒå’Œç±»åŠ è½½å™¨çš„å®ç°ï¼Œå¯ä»¥åœ¨ç‰¹å®šçš„åº”ç”¨æœåŠ¡å™¨ä¸­ä½¿ç”¨ã€‚</li><li>messaging æ¨¡å—ï¼šSpring 4.0 ä»¥åæ–°å¢äº†æ¶ˆæ¯ï¼ˆSpring-messagingï¼‰æ¨¡å—ï¼Œè¯¥æ¨¡å—æä¾›äº†å¯¹æ¶ˆæ¯ä¼ é€’ä½“ç³»ç»“æ„å’Œåè®®çš„æ”¯æŒã€‚</li></ul><h2 id="4-Core-Containerï¼ˆSpring-çš„æ ¸å¿ƒå®¹å™¨ï¼‰"><a href="#4-Core-Containerï¼ˆSpring-çš„æ ¸å¿ƒå®¹å™¨ï¼‰" class="headerlink" title="4. Core Containerï¼ˆSpring çš„æ ¸å¿ƒå®¹å™¨ï¼‰"></a>4. Core Containerï¼ˆSpring çš„æ ¸å¿ƒå®¹å™¨ï¼‰</h2><p>Spring çš„æ ¸å¿ƒå®¹å™¨æ˜¯å…¶ä»–æ¨¡å—å»ºç«‹çš„åŸºç¡€ï¼Œç”± Beans æ¨¡å—ã€Core æ ¸å¿ƒæ¨¡å—ã€Context ä¸Šä¸‹æ–‡æ¨¡å—å’Œ SpEL è¡¨è¾¾å¼è¯­è¨€æ¨¡å—ç»„æˆï¼Œæ²¡æœ‰è¿™äº›æ ¸å¿ƒå®¹å™¨ï¼Œä¹Ÿä¸å¯èƒ½æœ‰ AOPã€Web ç­‰ä¸Šå±‚çš„åŠŸèƒ½ã€‚å…·ä½“ä»‹ç»å¦‚ä¸‹ã€‚</p><ul><li>Beans æ¨¡å—ï¼šæä¾›äº†æ¡†æ¶çš„åŸºç¡€éƒ¨åˆ†ï¼ŒåŒ…æ‹¬æ§åˆ¶åè½¬å’Œä¾èµ–æ³¨å…¥ã€‚</li><li>Core æ ¸å¿ƒæ¨¡å—ï¼šå°è£…äº† Spring æ¡†æ¶çš„åº•å±‚éƒ¨åˆ†ï¼ŒåŒ…æ‹¬èµ„æºè®¿é—®ã€ç±»å‹è½¬æ¢åŠä¸€äº›å¸¸ç”¨å·¥å…·ç±»ã€‚</li><li>Context ä¸Šä¸‹æ–‡æ¨¡å—ï¼šå»ºç«‹åœ¨ Core å’Œ Beans æ¨¡å—çš„åŸºç¡€ä¹‹ä¸Šï¼Œé›†æˆ Beans æ¨¡å—åŠŸèƒ½å¹¶æ·»åŠ èµ„æºç»‘å®šã€æ•°æ®éªŒè¯ã€å›½é™…åŒ–ã€Java EE æ”¯æŒã€å®¹å™¨ç”Ÿå‘½å‘¨æœŸã€äº‹ä»¶ä¼ æ’­ç­‰ã€‚ApplicationContext æ¥å£æ˜¯ä¸Šä¸‹æ–‡æ¨¡å—çš„ç„¦ç‚¹ã€‚</li><li>SpEL æ¨¡å—ï¼šæä¾›äº†å¼ºå¤§çš„è¡¨è¾¾å¼è¯­è¨€æ”¯æŒï¼Œæ”¯æŒè®¿é—®å’Œä¿®æ”¹å±æ€§å€¼ï¼Œæ–¹æ³•è°ƒç”¨ï¼Œæ”¯æŒè®¿é—®åŠä¿®æ”¹æ•°ç»„ã€å®¹å™¨å’Œç´¢å¼•å™¨ï¼Œå‘½åå˜é‡ï¼Œæ”¯æŒç®—æ•°å’Œé€»è¾‘è¿ç®—ï¼Œæ”¯æŒä» Spring å®¹å™¨è·å– Beanï¼Œå®ƒä¹Ÿæ”¯æŒåˆ—è¡¨æŠ•å½±ã€é€‰æ‹©å’Œä¸€èˆ¬çš„åˆ—è¡¨èšåˆç­‰ã€‚</li></ul><h2 id="5-Test-æ¨¡å—"><a href="#5-Test-æ¨¡å—" class="headerlink" title="5. Test æ¨¡å—"></a>5. Test æ¨¡å—</h2><p>Test æ¨¡å—ï¼šSpring æ”¯æŒ Junit å’Œ TestNG æµ‹è¯•æ¡†æ¶ï¼Œè€Œä¸”è¿˜é¢å¤–æä¾›äº†ä¸€äº›åŸºäº Spring çš„æµ‹è¯•åŠŸèƒ½ï¼Œæ¯”å¦‚åœ¨æµ‹è¯• Web æ¡†æ¶æ—¶ï¼Œæ¨¡æ‹Ÿ Http è¯·æ±‚çš„åŠŸèƒ½ã€‚</p>]]></content>
    
    
    
    <tags>
      
      <tag>java</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
